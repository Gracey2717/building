try{!function(){var e="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof globalThis?globalThis:"undefined"!=typeof self?self:{},t=(new e.Error).stack;t&&(e._sentryDebugIds=e._sentryDebugIds||{},e._sentryDebugIds[t]="9d71e4bc-8dbb-4ad4-adb5-e500d91a89cc",e._sentryDebugIdIdentifier="sentry-dbid-9d71e4bc-8dbb-4ad4-adb5-e500d91a89cc")}()}catch(e){}"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[4958],{4601:(e,t,a)=>{a.d(t,{OJ:()=>j,Pl:()=>N,Pq:()=>y,Q5:()=>M,RK:()=>w,a0:()=>k,ag:()=>_,hm:()=>g,i9:()=>S,qP:()=>b,ue:()=>v});var n=a(80263),r=a(95043),l=a(28881),s=a(75189),i=a(20680),o=a(15601),c=a.n(o),d=a(53239),u=a(55966),m=a(51500),p=a(12644),h=a(93210),x=a(71139),f=a(30435);let g=(0,d.forwardRef)((e,t)=>{let{...a}=e;return(0,n.jsx)(u.Nt,{ref:t,...a,className:(0,m.cn)("w-full px-2 group",a.className)})}),y=(0,d.forwardRef)((e,t)=>{let{...a}=e;return(0,n.jsxs)(u.R6,{ref:t,...a,className:(0,m.cn)("w-full flex gap-1 items-center group px-3 text-sm font-normal font-mono uppercase text-lighter tracking-wide",a.className),children:[(0,n.jsx)(r.A,{className:"transition-all text-foreground-muted group-data-[state=open]:rotate-90",size:16,strokeWidth:1.5}),(0,n.jsx)("span",{className:"group-hover:not-disabled:text-foreground",children:a.title})]})}),b=(0,d.forwardRef)((e,t)=>{let{...a}=e;return(0,n.jsx)(u.Ke,{ref:t,...a,className:(0,m.cn)("w-full flex flex-col gap-0",a.className)})}),j=(0,d.forwardRef)((e,t)=>(0,n.jsx)("div",{ref:t,...e,className:(0,m.cn)("h-px bg-border-muted",e.className)})),v=(0,d.forwardRef)((e,t)=>{let{className:a,isActive:r,forceHoverState:l,...s}=e;return(0,n.jsx)(c(),{ref:t,...s,"aria-current":r,className:(0,m.cn)("text-sm","h-7 pl-3 pr-2","flex items-center justify-between rounded-md group relative",r?"bg-selection":"hover:bg-surface-200",l&&"bg-surface-200",r?"text-foreground":"text-foreground-light hover:text-foreground",a)})}),_=(0,d.forwardRef)((e,t)=>{let{isActive:a=!0,forceHoverState:r,isPreview:l,isOpened:s=!0,...i}=e;return(0,n.jsxs)(c(),{ref:t,...i,"aria-current":a,className:(0,m.cn)((0,p.u2)({isSelected:a&&!l,isOpened:s&&!l,isPreview:l}),"px-4",i.className),children:[!l&&a&&(0,n.jsx)("div",{className:"absolute left-0 h-full w-0.5 bg-foreground"}),i.children]})}),k=(0,d.forwardRef)((e,t)=>(0,n.jsx)("div",{ref:t,...e,className:(0,m.cn)("flex px-2 gap-2 items-center",e.className)})),w=(0,d.forwardRef)((e,t)=>{let{children:a,isLoading:r=!1,...i}=e;return(0,n.jsxs)("label",{htmlFor:i.name,className:"relative w-full",children:[(0,n.jsx)("span",{className:"sr-only",children:i["aria-labelledby"]}),(0,n.jsx)(h.p,{ref:t,type:"text",className:(0,m.cn)("h-[32px] md:h-[28px] w-full","text-base md:text-xs","pl-7","pr-7","w-full","rounded",i.className),...i}),a,r?(0,n.jsx)(l.A,{className:"animate-spin absolute left-2 text-foreground-muted",style:{top:7},size:14,strokeWidth:1.5}):(0,n.jsx)(s.A,{className:"absolute left-2 top-2 text-foreground-muted",size:14,strokeWidth:1.5})]})}),S=(0,d.forwardRef)((e,t)=>{let{value:a,onValueChange:r,contentClassName:l,triggerClassName:s,...o}=e;return(0,n.jsxs)(x.rI,{modal:!1,children:[(0,n.jsxs)(f.m_,{delayDuration:0,children:[(0,n.jsx)(x.ty,{asChild:!0,className:(0,m.cn)("absolute right-1 top-[.4rem] md:top-[.3rem]","text-foreground transition-colors hover:text-foreground data-[state=open]:text-foreground",s),children:(0,n.jsx)(f.k$,{children:(0,n.jsx)(i.A,{size:18,strokeWidth:1})})}),(0,n.jsx)(f.ZI,{side:"bottom",children:"Sort By"})]}),(0,n.jsx)(x.SQ,{side:"bottom",align:"end",className:(0,m.cn)("w-48",l),children:(0,n.jsx)(x.Hr,{value:a,onValueChange:r,children:o.children})})]})}),N=(0,d.forwardRef)((e,t)=>(0,n.jsx)(x.Ht,{ref:t,...e})),M=(0,d.forwardRef)((e,t)=>{let{illustration:a,title:r,description:l,actions:s,...i}=e;return(0,n.jsx)("div",{ref:t,...i,className:(0,m.cn)("border border-muted bg-surface-100 dark:bg-surface-75 flex flex-col gap-y-3 items-center justify-center rounded-md px-5 py-4",i.className),children:(0,n.jsxs)("div",{className:"w-full flex flex-col gap-y-1 items-center",children:[a,r&&(0,n.jsx)("p",{className:"text-xs text-foreground-light",children:r}),l&&(0,n.jsx)("p",{className:"text-xs text-foreground-lighter text-center",children:l}),s&&(0,n.jsx)("div",{className:"mt-2",children:s}),i.children]})})})},4958:(e,t,a)=>{a.d(t,{A:()=>eI});var n=a(80263),r=a(15601),l=a.n(r),s=a(24400),i=a(53239),o=a(75232),c=a(32981),d=a(60045),u=a(52793),m=a.n(u),p=a(11192),h=a(87494),x=a(73969),f=a(19686),g=a(5588),y=a(73934),b=a(88602),j=a(12578),v=a(85278),_=a(32144),k=a(80251),w=a(65172),S=a(33793);async function N(e){let{projectRef:t,id:a,type:n,isPublic:r,file_size_limit:l,allowed_mime_types:s}=e;if(!t)throw Error("projectRef is required");if(!a)throw Error("Bucket name is required");let i={id:a,type:n,public:r};"STANDARD"===n&&(l&&(i.file_size_limit=l),s&&(i.allowed_mime_types=s));let{data:o,error:c}=await (0,w.bE)("/platform/storage/{ref}/buckets",{params:{path:{ref:t}},body:i});return c&&(0,w.H4)(c),o}let M=function(){let{onSuccess:e,onError:t,...a}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=(0,_.jE)();return(0,k.n)(e=>N(e),{async onSuccess(t,a,r){let{projectRef:l}=a;await n.invalidateQueries(S.w.buckets(l)),await (null==e?void 0:e(t,a,r))},async onError(e,a,n){void 0===t?x.oR.error("Failed to create bucket: ".concat(e.message)):t(e,a,n)},...a})};var C=a(47221),A=a(57132),E=a(75019),B=a(23385),z=a(63492),D=a(16838),R=a(47452),I=a(93210),T=a(4870),P=a(86254),F=a(13874),L=a(40990),O=a(19428),q=a(1012),G=a(40022),U=a(47142),Y=a(67258),J=a(37106),H=a(54498);let Q=f.Ay.object({name:f.Ay.string().trim().min(1,"Please provide a name for your bucket").max(100,"Bucket name should be below 100 characters").refine(e=>!e.endsWith(" "),"The name of the bucket cannot end with a whitespace").refine(e=>"public"!==e,'"public" is a reserved name. Please choose another name'),type:f.Ay.enum(["STANDARD","ANALYTICS"]).default("STANDARD"),public:f.Ay.boolean().default(!1),has_file_size_limit:f.Ay.boolean().default(!1),formatted_size_limit:f.Ay.coerce.number().min(0,"File size upload limit has to be at least 0").optional(),allowed_mime_types:f.Ay.string().trim().default("")}).superRefine((e,t)=>{if(!J.Bt.test(e.name)){var a;let[n]=null!=(a=e.name.match(J.$P))?a:[];t.addIssue({path:["name"],code:f.Ay.ZodIssueCode.custom,message:n?'Bucket name cannot contain the "'.concat(n,'" character'):"Bucket name contains an invalid special character"})}}),W="create-storage-bucket-form",V=()=>{var e,t,a;let r=(0,s.useRouter)(),{ref:l}=(0,o.g)(),{data:u}=(0,B.s)(),[f,_]=(0,i.useState)(!1),[k,w]=(0,i.useState)(y.s2.MB),{can:S}=(0,E.hl)(d.aG.STORAGE_WRITE,"*"),{mutate:N}=(0,A.h)(),{mutateAsync:J,isLoading:V}=M({onError:()=>{}}),{mutateAsync:$,isLoading:Z}=(0,C.Z)(),{data:K}=(0,v.I)({projectRef:l},{enabled:z.pe}),{value:X,unit:ee}=(0,H.Jb)(null!=(a=null==K?void 0:K.fileSizeLimit)?a:0),et="".concat(X," ").concat(ee),ea=(0,h.mN)({resolver:(0,c.u)(Q),defaultValues:{name:"",public:!1,type:"STANDARD",has_file_size_limit:!1,formatted_size_limit:void 0,allowed_mime_types:""}}),{formatted_size_limit:en}=ea.formState.errors,er=m()(ea.watch("name")),el=ea.watch("public"),es="STANDARD"===ea.watch("type"),ei=ea.watch("has_file_size_limit"),[eo,ec]=(0,i.useState)(!1),ed=(0,g.P)(),eu=null==K||null==(t=K.features)||null==(e=t.icebergCatalog)?void 0:e.enabled,em=async e=>{var t,a;if(!l)return console.error("Project ref is required");if("ANALYTICS"===e.type&&!eu)return x.oR.error("The Analytics catalog feature is not enabled for your project. Please contact support to enable it.");try{let a=e.has_file_size_limit&&void 0!==e.formatted_size_limit?(0,H.OG)(e.formatted_size_limit,k):void 0,n=eo&&e.allowed_mime_types.length>0?e.allowed_mime_types.split(",").map(e=>e.trim()):void 0;if(a&&(null==K?void 0:K.fileSizeLimit)&&a>K.fileSizeLimit)return ea.setError("formatted_size_limit",{type:"manual",message:"exceed_global_limit"});await J({projectRef:l,id:e.name,type:e.type,isPublic:e.public,file_size_limit:a,allowed_mime_types:n}),N({action:"storage_bucket_created",properties:{bucketType:e.type},groups:{project:null!=l?l:"Unknown",organization:null!=(t=null==u?void 0:u.slug)?t:"Unknown"}}),"ANALYTICS"===e.type&&"installed"===ed&&await $({bucketName:e.name}),x.oR.success("Successfully created bucket ".concat(e.name)),ea.reset(),w(y.s2.MB),_(!1),r.push("/project/".concat(l,"/storage/buckets/").concat(e.name))}catch(t){let e=(null==(a=t.message)?void 0:a.toLowerCase())||"";e.includes("mime type")&&(e.includes("is not supported")||e.includes("not supported"))?ea.setError("allowed_mime_types",{type:"manual",message:"Invalid MIME type format. Please check your input."}):x.oR.error("Failed to create bucket: ".concat(t.message))}},ep=()=>{ea.reset(),w(y.s2.MB),_(!1)};return(0,n.jsxs)(D.lG,{open:f,onOpenChange:e=>{e||ep()},"data-sentry-element":"Dialog","data-sentry-component":"CreateBucketModal","data-sentry-source-file":"CreateBucketModal.tsx",children:[(0,n.jsx)(D.zM,{asChild:!0,"data-sentry-element":"DialogTrigger","data-sentry-source-file":"CreateBucketModal.tsx",children:(0,n.jsx)(b.G,{block:!0,type:"default",icon:(0,n.jsx)(p.A,{}),disabled:!S,style:{justifyContent:"start"},onClick:()=>_(!0),tooltip:{content:{side:"bottom",text:S?void 0:"You need additional permissions to create buckets"}},"data-sentry-element":"ButtonTooltip","data-sentry-source-file":"CreateBucketModal.tsx",children:"New bucket"})}),(0,n.jsxs)(D.Cf,{"data-sentry-element":"DialogContent","data-sentry-source-file":"CreateBucketModal.tsx",children:[(0,n.jsx)(D.c7,{"data-sentry-element":"DialogHeader","data-sentry-source-file":"CreateBucketModal.tsx",children:(0,n.jsx)(D.L3,{"data-sentry-element":"DialogTitle","data-sentry-source-file":"CreateBucketModal.tsx",children:"Create storage bucket"})}),(0,n.jsx)(D.pf,{"data-sentry-element":"DialogSectionSeparator","data-sentry-source-file":"CreateBucketModal.tsx"}),(0,n.jsx)(R.lV,{...ea,"data-sentry-element":"Form_Shadcn_","data-sentry-source-file":"CreateBucketModal.tsx",children:(0,n.jsxs)("form",{id:W,onSubmit:ea.handleSubmit(em),children:[(0,n.jsxs)(D.OO,{className:"flex flex-col gap-y-2","data-sentry-element":"DialogSection","data-sentry-source-file":"CreateBucketModal.tsx",children:[(0,n.jsx)(R.zB,{name:"name",control:ea.control,render:e=>{let{field:t}=e;return(0,n.jsx)(Y.M,{name:"name",label:"Name of bucket",labelOptional:"Buckets cannot be renamed once created.",children:(0,n.jsx)(R.MJ,{children:(0,n.jsx)(I.p,{id:"name",...t,placeholder:"Enter bucket name"})})})},"data-sentry-element":"FormField_Shadcn_","data-sentry-source-file":"CreateBucketModal.tsx"},"name"),(0,n.jsx)(R.zB,{name:"type",control:ea.control,render:e=>{let{field:t}=e;return(0,n.jsx)(Y.M,{label:"Bucket type",children:(0,n.jsx)(R.MJ,{children:(0,n.jsxs)(T.s,{id:"type",value:t.value,onValueChange:e=>t.onChange(e),children:[(0,n.jsx)(T.v,{id:"STANDARD",value:"STANDARD",label:"Standard bucket",description:"Compatible with S3 buckets.",showIndicator:!1}),z.pe&&(0,n.jsx)(T.v,{id:"ANALYTICS",value:"ANALYTICS",label:"Analytics bucket",showIndicator:!1,disabled:!eu,children:(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)("p",{className:"text-foreground-light text-left",children:"Stores Iceberg files and is optimized for analytical workloads."}),eu?null:(0,n.jsxs)("div",{className:"w-full flex gap-x-2 py-2 items-center",children:[(0,n.jsx)(P.id,{}),(0,n.jsxs)("span",{className:"text-xs text-left",children:["This feature is currently in alpha and not yet enabled for your project. Sign up"," ",(0,n.jsx)(j.g,{href:"https://forms.supabase.com/analytics-buckets",children:"here"}),"."]})]})]})})]})})})},"data-sentry-element":"FormField_Shadcn_","data-sentry-source-file":"CreateBucketModal.tsx"},"type")]}),(0,n.jsx)(D.pf,{"data-sentry-element":"DialogSectionSeparator","data-sentry-source-file":"CreateBucketModal.tsx"}),es?(0,n.jsxs)(n.Fragment,{children:[(0,n.jsxs)(D.OO,{className:"space-y-3",children:[(0,n.jsx)(R.zB,{name:"public",control:ea.control,render:e=>{let{field:t}=e;return(0,n.jsx)(Y.M,{hideMessage:!0,name:"public",label:"Public bucket",description:"Allow anyone to read objects without authorization",layout:"flex",children:(0,n.jsx)(R.MJ,{children:(0,n.jsx)(F.d,{id:"public",size:"large",checked:t.value,onCheckedChange:t.onChange})})})}},"public"),el&&(0,n.jsx)(U.Z,{type:"warning",title:"Public buckets are not protected",description:"Users can read objects in public buckets without any authorization. Row level security (RLS) policies are still required for other operations such as object uploads and deletes."})]}),(0,n.jsx)(D.pf,{}),(0,n.jsxs)(D.OO,{className:"space-y-2",children:[(0,n.jsx)(R.zB,{name:"has_file_size_limit",control:ea.control,render:e=>{let{field:t}=e;return(0,n.jsx)(Y.M,{name:"has_file_size_limit",label:"Restrict file size",description:"Prevent uploading of files larger than a specified limit",layout:"flex",children:(0,n.jsx)(R.MJ,{children:(0,n.jsx)(F.d,{id:"has_file_size_limit",size:"large",checked:t.value,onCheckedChange:t.onChange})})})}},"has_file_size_limit"),ei&&(0,n.jsxs)("div",{children:[(0,n.jsx)(R.zB,{name:"formatted_size_limit",control:ea.control,render:e=>{let{field:t}=e;return(0,n.jsx)(Y.M,{hideMessage:!0,name:"formatted_size_limit",label:"File size limit",children:(0,n.jsxs)("div",{className:"grid grid-cols-12 gap-x-2",children:[(0,n.jsx)("div",{className:"col-span-8",children:(0,n.jsx)(R.MJ,{children:(0,n.jsx)(I.p,{id:"formatted_size_limit","aria-label":"File size limit",type:"number",min:0,placeholder:"0",...t})})}),(0,n.jsx)("div",{className:"col-span-4",children:(0,n.jsxs)(L.l6,{value:k,onValueChange:w,children:[(0,n.jsx)(L.bq,{"aria-label":"File size limit unit",size:"small",children:(0,n.jsx)(L.yv,{children:k})}),(0,n.jsx)(L.gC,{children:Object.values(y.s2).map(e=>(0,n.jsx)(L.eb,{value:e,className:"text-xs",children:e},e))})]})})]})})}},"formatted_size_limit"),(null==en?void 0:en.message)==="exceed_global_limit"&&(0,n.jsxs)(R.C5,{className:"mt-2",children:["Exceeds global limit of ",et,". Increase limit in"," ",(0,n.jsx)(j.g,{className:"text-destructive decoration-destructive-500 hover:decoration-destructive",href:"/project/".concat(l,"/storage/settings"),onClick:()=>_(!1),children:"Storage Settings"})," ","first."]}),z.pe&&(0,n.jsxs)("p",{className:"text-sm text-foreground-lighter mt-2",children:["This project has a"," ",(0,n.jsx)(j.g,{className:"text-foreground-light hover:text-foreground",href:"/project/".concat(l,"/storage/settings"),onClick:()=>_(!1),children:"global file size limit"})," ","of ",et,"."]})]})]}),(0,n.jsx)(D.pf,{}),(0,n.jsxs)(D.OO,{className:"space-y-2",children:[(0,n.jsx)(Y.M,{name:"has_allowed_mime_types",label:"Restrict MIME types",description:"Allow only certain types of files to be uploaded",layout:"flex",children:(0,n.jsx)(R.MJ,{children:(0,n.jsx)(F.d,{id:"has_allowed_mime_types",size:"large",checked:eo,onCheckedChange:ec})})}),eo&&(0,n.jsx)(R.zB,{name:"allowed_mime_types",control:ea.control,render:e=>{let{field:t}=e;return(0,n.jsx)(Y.M,{name:"allowed_mime_types",label:"Allowed MIME types",labelOptional:"Comma separated values",description:"Wildcards are allowed, e.g. image/*.",children:(0,n.jsx)(R.MJ,{children:(0,n.jsx)(I.p,{id:"allowed_mime_types",...t,placeholder:"e.g image/jpeg, image/png, audio/mpeg, video/mp4, etc"})})})}},"allowed_mime_types")]})]}):(0,n.jsx)(n.Fragment,{children:"installed"===ed?(0,n.jsxs)(O.J,{className:"text-foreground-lighter leading-1 flex flex-col gap-y-2",children:[(0,n.jsxs)("p",{children:[(0,n.jsx)("span",{children:"Supabase will setup a "}),(0,n.jsxs)("a",{href:"".concat(z.o2,"/project/").concat(l,"/integrations/iceberg_wrapper/overview"),target:"_blank",className:"underline text-foreground-light",children:["foreign data wrapper",er&&(0,n.jsxs)("span",{className:"text-brand",children:[" ","".concat(er,"_fdw")]})]}),(0,n.jsxs)("span",{children:[" ","for easier access to the data. This action will also create"," ",(0,n.jsxs)("a",{href:"".concat(z.o2,"/project/").concat(l,"/storage/access-keys"),target:"_blank",className:"underline text-foreground-light",children:["S3 Access Keys",er&&(0,n.jsxs)(n.Fragment,{children:[" ","named ",(0,n.jsxs)("span",{className:"text-brand",children:[" ","".concat(er,"_keys")]})]})]}),(0,n.jsx)("span",{children:" and "}),(0,n.jsxs)("a",{href:"".concat(z.o2,"/project/").concat(l,"/integrations/vault/secrets"),target:"_blank",className:"underline text-foreground-light",children:["four Vault Secrets",er&&(0,n.jsxs)(n.Fragment,{children:[" ","prefixed with"," ",(0,n.jsxs)("span",{className:"text-brand",children:[" ","".concat(er,"_vault_")]})]})]}),"."]})]}),(0,n.jsxs)("p",{children:["As a final step, you'll need to create an"," ",(0,n.jsx)("span",{className:"text-foreground-light",children:"Iceberg namespace"})," before you connect the Iceberg data to your database."]})]}):(0,n.jsxs)(q.Fc,{variant:"warning",children:[(0,n.jsx)(P.id,{}),(0,n.jsx)(q.XL,{children:"You need to install the Iceberg wrapper extension to connect your Analytic bucket to your database."}),(0,n.jsx)(q.TN,{className:"flex flex-col gap-y-2",children:(0,n.jsxs)("p",{children:["You need to install the ",(0,n.jsx)("span",{className:"text-brand",children:"wrappers"})," ","extension (with the minimum version of ",(0,n.jsx)("span",{children:"0.5.3"}),") if you want to connect your Analytics bucket to your database."]})})]})})]})}),(0,n.jsxs)(D.Es,{"data-sentry-element":"DialogFooter","data-sentry-source-file":"CreateBucketModal.tsx",children:[(0,n.jsx)(G.$,{type:"default",disabled:V||Z,onClick:()=>_(!1),"data-sentry-element":"Button","data-sentry-source-file":"CreateBucketModal.tsx",children:"Cancel"}),(0,n.jsx)(G.$,{form:W,htmlType:"submit",loading:V||Z,disabled:V||Z,"data-sentry-element":"Button","data-sentry-source-file":"CreateBucketModal.tsx",children:"Create"})]})]})]})};var $=a(90437),Z=a(86349),K=a(5483),X=a(34424),ee=a(43242),et=a(4601),ea=a(57624),en=a(26587),er=a(89080),el=a(74680),es=a(17089),ei=a(26089),eo=a.n(ei),ec=a(48388),ed=a.n(ec),eu=a(33647),em=a(17498);async function ep(e){let{projectRef:t,id:a,type:n}=e;if(!t)throw Error("projectRef is required");if(!a)throw Error("Bucket name is requried");if("ANALYTICS"!==n){let{error:e}=await (0,w.bE)("/platform/storage/{ref}/buckets/{id}/empty",{params:{path:{ref:t,id:a}}});e&&(0,w.H4)(e)}let{data:r,error:l}=await (0,w.yH)("/platform/storage/{ref}/buckets/{id}",{params:{path:{ref:t,id:a},query:{type:n}}});return l&&(0,w.H4)(l),r}let eh=function(){let{onSuccess:e,onError:t,...a}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=(0,_.jE)();return(0,k.n)(e=>ep(e),{async onSuccess(t,a,r){let{projectRef:l}=a;await n.invalidateQueries(S.w.buckets(l)),await (null==e?void 0:e(t,a,r))},async onError(e,a,n){void 0===t?x.oR.error("Failed to delete bucket: ".concat(e.message)):t(e,a,n)},...a})};var ex=a(95300);let ef="delete-storage-bucket-form",eg=e=>{let{visible:t,bucket:a,onClose:r}=e,l=(0,s.useRouter)(),{ref:i}=(0,o.g)(),{data:d}=(0,K.YA)(),u=f.Ay.object({confirm:f.Ay.literal(a.name,{errorMap:()=>({message:'Please enter "'.concat(a.name,'" to confirm')})})}),m=(0,h.mN)({resolver:(0,c.u)(u)}),{data:p}=(0,Z.p)({projectRef:i}),{data:g}=(0,eu.j)({projectRef:null==d?void 0:d.ref,connectionString:null==d?void 0:d.connectionString,schema:"storage"}),{mutateAsync:y}=(0,em.f)(),{mutate:b,isLoading:j}=eh({onSuccess:async()=>{if(!d)return console.error("Project is required");let e=(null!=g?g:[]).filter(e=>"objects"===e.table),t=(0,ex._S)(v,e),n=eo()(ed()(t,{name:a.name}),["policies"],[]);try{await Promise.all(n.map(e=>y({projectRef:null==d?void 0:d.ref,connectionString:null==d?void 0:d.connectionString,originalPolicy:e}))),x.oR.success("Successfully deleted bucket ".concat(a.name)),l.push("/project/".concat(i,"/storage/buckets")),r()}catch(e){x.oR.success("Successfully deleted bucket ".concat(a.name,". However, there was a problem deleting the policies tied to the bucket. Please review them in the storage policies section"))}}}),v=null!=p?p:[],_=async()=>i?a?void b({projectRef:i,id:a.id,type:a.type}):console.error("No bucket is selected"):console.error("Project ref is required");return(0,n.jsx)(D.lG,{open:t,onOpenChange:e=>{e||r()},"data-sentry-element":"Dialog","data-sentry-component":"DeleteBucketModal","data-sentry-source-file":"DeleteBucketModal.tsx",children:(0,n.jsxs)(D.Cf,{"data-sentry-element":"DialogContent","data-sentry-source-file":"DeleteBucketModal.tsx",children:[(0,n.jsx)(D.c7,{"data-sentry-element":"DialogHeader","data-sentry-source-file":"DeleteBucketModal.tsx",children:(0,n.jsxs)(D.L3,{"data-sentry-element":"DialogTitle","data-sentry-source-file":"DeleteBucketModal.tsx",children:["Confirm deletion of ",a.name]})}),(0,n.jsx)(D.pf,{"data-sentry-element":"DialogSectionSeparator","data-sentry-source-file":"DeleteBucketModal.tsx"}),(0,n.jsx)(U.Z,{type:"destructive",className:"rounded-none border-x-0 border-t-0 mb-0",title:"You cannot recover this bucket once deleted.",description:"All bucket data will be lost.","data-sentry-element":"Admonition","data-sentry-source-file":"DeleteBucketModal.tsx"}),(0,n.jsx)(D.OO,{"data-sentry-element":"DialogSection","data-sentry-source-file":"DeleteBucketModal.tsx",children:(0,n.jsxs)("p",{className:"text-sm",children:["Your bucket ",(0,n.jsx)("span",{className:"font-bold text-foreground",children:a.name})," and all its contents will be permanently deleted."]})}),(0,n.jsx)(D.pf,{"data-sentry-element":"DialogSectionSeparator","data-sentry-source-file":"DeleteBucketModal.tsx"}),(0,n.jsx)(D.OO,{"data-sentry-element":"DialogSection","data-sentry-source-file":"DeleteBucketModal.tsx",children:(0,n.jsx)(R.lV,{...m,"data-sentry-element":"Form_Shadcn_","data-sentry-source-file":"DeleteBucketModal.tsx",children:(0,n.jsx)("form",{id:ef,onSubmit:m.handleSubmit(_),children:(0,n.jsx)(R.zB,{name:"confirm",control:m.control,render:e=>{let{field:t}=e;return(0,n.jsx)(Y.M,{name:"confirm",label:(0,n.jsxs)(n.Fragment,{children:["Type ",(0,n.jsx)("span",{className:"font-bold text-foreground",children:a.name})," to confirm."]}),children:(0,n.jsx)(R.MJ,{children:(0,n.jsx)(I.p,{id:"confirm",autoComplete:"off",...t,placeholder:"Type in name of bucket"})})})},"data-sentry-element":"FormField_Shadcn_","data-sentry-source-file":"DeleteBucketModal.tsx"},"confirm")})})}),(0,n.jsxs)(D.Es,{"data-sentry-element":"DialogFooter","data-sentry-source-file":"DeleteBucketModal.tsx",children:[(0,n.jsx)(G.$,{type:"default",disabled:j,onClick:r,"data-sentry-element":"Button","data-sentry-source-file":"DeleteBucketModal.tsx",children:"Cancel"}),(0,n.jsx)(G.$,{form:ef,htmlType:"submit",type:"danger",loading:j,"data-sentry-element":"Button","data-sentry-source-file":"DeleteBucketModal.tsx",children:"Delete bucket"})]})]})})};var ey=a(10663);async function eb(e){let{projectRef:t,id:a,isPublic:n,file_size_limit:r,allowed_mime_types:l}=e;if(!t)throw Error("projectRef is required");if(!a)throw Error("Bucket name is requried");let s={public:n};void 0!==r&&(s.file_size_limit=r),void 0!==l&&(s.allowed_mime_types=l);let{data:i,error:o}=await (0,w.F6)("/platform/storage/{ref}/buckets/{id}",{params:{path:{id:a,ref:t}},body:s});return o?{data:null,error:o}:{data:i,error:null}}let ej=function(){let{onSuccess:e,onError:t,...a}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=(0,_.jE)();return(0,k.n)(async e=>{let t=await eb(e);if(t.error)throw t.error;return t.data},{async onSuccess(t,a,r){let{projectRef:l}=a;await n.invalidateQueries(S.w.buckets(l)),await (null==e?void 0:e(t,a,r))},async onError(e,a,n){void 0===t?x.oR.error("Failed to update bucket: ".concat(e.message)):t(e,a,n)},...a})},ev=ey.Ik({name:ey.Yj(),public:ey.zM().default(!1),has_file_size_limit:ey.zM().default(!1),formatted_size_limit:ey.au.number().min(0,"File size upload limit has to be at least 0").optional(),allowed_mime_types:ey.Yj().trim().default("")}),e_="edit-storage-bucket-form",ek=e=>{var t,a,r,l,s;let{visible:d,bucket:u,onClose:m}=e,{ref:p}=(0,o.g)(),{data:f}=(0,v.I)({projectRef:p},{enabled:z.pe}),{value:g,unit:b}=(0,H.Jb)(null!=(a=null==f?void 0:f.fileSizeLimit)?a:0),_="".concat(g," ").concat(b),k=(0,i.useRef)(null),[w,S]=(0,i.useState)(y.s2.MB),{value:N}=(0,H.Jb)(null!=(r=null==u?void 0:u.file_size_limit)?r:0),{mutate:M,isLoading:C}=ej({onSuccess:()=>{x.oR.success('Successfully updated bucket "'.concat(null==u?void 0:u.name,'"')),m()},onError:e=>{var t;let a=(null==(t=e.message)?void 0:t.toLowerCase())||"";a.includes("exceeded the maximum allowed size")||a.includes("maximum allowed size")||a.includes("entity too large")||a.includes("payload too large")?E.setError("formatted_size_limit",{type:"manual",message:"Exceeds global limit of ".concat(_,".")}):a.includes("mime type")&&(a.includes("is not supported")||a.includes("not supported"))?E.setError("allowed_mime_types",{type:"manual",message:"Invalid MIME type format. Please check your input."}):x.oR.error("Failed to update bucket: ".concat(e.message||"Unknown error"))}}),A={name:null!=(l=null==u?void 0:u.name)?l:"",public:null==u?void 0:u.public,has_file_size_limit:!!(null==u?void 0:u.file_size_limit),formatted_size_limit:(null==u?void 0:u.file_size_limit)?null!=N?N:0:void 0,allowed_mime_types:(null!=(s=null==u?void 0:u.allowed_mime_types)?s:[]).join(", ")},E=(0,h.mN)({resolver:(0,c.u)(ev),defaultValues:A,values:A,mode:"onSubmit"}),{formatted_size_limit:B}=E.formState.errors,T=E.watch("public"),P=E.watch("has_file_size_limit"),[O,q]=(0,i.useState)(!!(null==u||null==(t=u.allowed_mime_types)?void 0:t.length)),J=(null==u?void 0:u.public)!==T,Q=(null==u?void 0:u.public)&&!T,W=!(null==u?void 0:u.public)&&T,V=()=>{E.reset(),m()},$=async e=>void 0===u?console.error("Bucket is required"):void 0===p?console.error("Project ref is required"):e.has_file_size_limit&&void 0!==e.formatted_size_limit&&(null==f?void 0:f.fileSizeLimit)&&(0,H.OG)(e.formatted_size_limit,w)>f.fileSizeLimit?E.setError("formatted_size_limit",{type:"manual",message:"exceed_global_limit"}):void M({projectRef:p,id:u.id,isPublic:e.public,file_size_limit:e.has_file_size_limit&&e.formatted_size_limit?(0,H.OG)(e.formatted_size_limit,w):null,allowed_mime_types:O&&e.allowed_mime_types.length>0?e.allowed_mime_types.split(",").map(e=>e.trim()):null});return(0,i.useEffect)(()=>{if(d&&u&&k.current!==u.id&&u.file_size_limit){let{unit:e}=(0,H.Jb)(u.file_size_limit);S(e),k.current=u.id}},[d,u,E]),(0,n.jsx)(D.lG,{open:d,onOpenChange:e=>{e||V()},"data-sentry-element":"Dialog","data-sentry-component":"EditBucketModal","data-sentry-source-file":"EditBucketModal.tsx",children:(0,n.jsxs)(D.Cf,{"data-sentry-element":"DialogContent","data-sentry-source-file":"EditBucketModal.tsx",children:[(0,n.jsx)(D.c7,{"data-sentry-element":"DialogHeader","data-sentry-source-file":"EditBucketModal.tsx",children:(0,n.jsx)(D.L3,{"data-sentry-element":"DialogTitle","data-sentry-source-file":"EditBucketModal.tsx",children:'Edit bucket "'.concat(null==u?void 0:u.name,'"')})}),(0,n.jsx)(D.pf,{"data-sentry-element":"DialogSectionSeparator","data-sentry-source-file":"EditBucketModal.tsx"}),(0,n.jsx)(R.lV,{...E,"data-sentry-element":"Form_Shadcn_","data-sentry-source-file":"EditBucketModal.tsx",children:(0,n.jsxs)("form",{id:e_,onSubmit:E.handleSubmit($),children:[(0,n.jsxs)(D.OO,{className:"space-y-6","data-sentry-element":"DialogSection","data-sentry-source-file":"EditBucketModal.tsx",children:[(0,n.jsx)(R.zB,{name:"name",control:E.control,render:e=>{let{field:t}=e;return(0,n.jsx)(Y.M,{hideMessage:!0,name:"name",label:"Name of bucket",labelOptional:"Buckets cannot be renamed once created.",children:(0,n.jsx)(R.MJ,{children:(0,n.jsx)(I.p,{id:"name",...t,disabled:!0})})})},"data-sentry-element":"FormField_Shadcn_","data-sentry-source-file":"EditBucketModal.tsx"},"name"),(0,n.jsxs)("div",{className:"flex flex-col gap-y-3",children:[(0,n.jsx)(R.zB,{name:"public",control:E.control,render:e=>{let{field:t}=e;return(0,n.jsx)(Y.M,{hideMessage:!0,name:"public",label:"Public bucket",description:"Allow anyone to read objects without authorization",layout:"flex",children:(0,n.jsx)(R.MJ,{children:(0,n.jsx)(F.d,{id:"public",size:"large",checked:t.value,onCheckedChange:t.onChange})})})},"data-sentry-element":"FormField_Shadcn_","data-sentry-source-file":"EditBucketModal.tsx"},"public"),J&&(0,n.jsx)(U.Z,{type:"warning",title:"Warning: Making bucket ".concat(W?"public":"private"),description:(0,n.jsxs)(n.Fragment,{children:[W&&(0,n.jsx)("p",{children:"This will make all objects in your bucket publicly accessible."}),Q&&(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)("p",{className:"mb-2 !leading-normal",children:"All objects in your bucket will only accessible via signed URLs, or downloaded with the right authorization headers."}),(0,n.jsxs)("p",{className:"!leading-normal",children:["Assets cached in the CDN may still be publicly accessible. You can consider"," ",(0,n.jsx)(j.g,{href:"https://supabase.com/docs/guides/storage/cdn/smart-cdn#cache-eviction",children:"purging the cache"})," ","or moving your assets to a new bucket."]})]})]})})]})]}),(0,n.jsx)(D.pf,{"data-sentry-element":"DialogSectionSeparator","data-sentry-source-file":"EditBucketModal.tsx"}),(0,n.jsxs)(D.OO,{className:"space-y-2","data-sentry-element":"DialogSection","data-sentry-source-file":"EditBucketModal.tsx",children:[(0,n.jsx)(R.zB,{name:"has_file_size_limit",control:E.control,render:e=>{let{field:t}=e;return(0,n.jsx)(Y.M,{name:"has_file_size_limit",label:"Restrict file size",description:"Prevent uploading of files larger than a specified limit",layout:"flex",children:(0,n.jsx)(R.MJ,{children:(0,n.jsx)(F.d,{id:"has_file_size_limit",size:"large",checked:t.value,onCheckedChange:t.onChange})})})},"data-sentry-element":"FormField_Shadcn_","data-sentry-source-file":"EditBucketModal.tsx"},"has_file_size_limit"),P&&(0,n.jsxs)("div",{children:[(0,n.jsx)(R.zB,{name:"formatted_size_limit",control:E.control,render:e=>{let{field:t}=e;return(0,n.jsx)(Y.M,{hideMessage:!0,name:"formatted_size_limit",label:"File size limit",children:(0,n.jsxs)("div",{className:"grid grid-cols-12 gap-x-2",children:[(0,n.jsx)("div",{className:"col-span-8",children:(0,n.jsx)(R.MJ,{children:(0,n.jsx)(I.p,{id:"formatted_size_limit","aria-label":"File size limit",type:"number",min:0,placeholder:"0",...t})})}),(0,n.jsx)("div",{className:"col-span-4",children:(0,n.jsxs)(L.l6,{value:w,onValueChange:S,children:[(0,n.jsx)(L.bq,{"aria-label":"File size limit unit",size:"small",children:(0,n.jsx)(L.yv,{children:w})}),(0,n.jsx)(L.gC,{children:Object.values(y.s2).map(e=>(0,n.jsx)(L.eb,{value:e,className:"text-xs",children:e},e))})]})})]})})}},"formatted_size_limit"),(null==B?void 0:B.message)==="exceed_global_limit"&&(0,n.jsxs)(R.C5,{className:"mt-2",children:["Exceeds global limit of ",_,". Increase limit in"," ",(0,n.jsx)(j.g,{className:"text-destructive decoration-destructive-500 hover:decoration-destructive",href:"/project/".concat(p,"/storage/settings"),onClick:m,children:"Storage Settings"})," ","first."]}),z.pe&&(0,n.jsxs)("p",{className:"text-sm text-foreground-lighter mt-2",children:["This project has a"," ",(0,n.jsx)(j.g,{className:"text-foreground-light hover:text-foreground",href:"/project/".concat(p,"/storage/settings"),onClick:m,children:"global file size limit"})," ","of ",_,"."]})]})]}),(0,n.jsx)(D.pf,{"data-sentry-element":"DialogSectionSeparator","data-sentry-source-file":"EditBucketModal.tsx"}),(0,n.jsxs)(D.OO,{className:"space-y-2","data-sentry-element":"DialogSection","data-sentry-source-file":"EditBucketModal.tsx",children:[(0,n.jsx)(Y.M,{name:"has_allowed_mime_types",label:"Restrict MIME types",description:"Allow only certain types of files to be uploaded",layout:"flex","data-sentry-element":"FormItemLayout","data-sentry-source-file":"EditBucketModal.tsx",children:(0,n.jsx)(R.MJ,{"data-sentry-element":"FormControl_Shadcn_","data-sentry-source-file":"EditBucketModal.tsx",children:(0,n.jsx)(F.d,{id:"has_allowed_mime_types",size:"large",checked:O,onCheckedChange:q,"data-sentry-element":"Switch","data-sentry-source-file":"EditBucketModal.tsx"})})}),O&&(0,n.jsx)(R.zB,{name:"allowed_mime_types",control:E.control,render:e=>{let{field:t}=e;return(0,n.jsx)(Y.M,{name:"allowed_mime_types",label:"Allowed MIME types",labelOptional:"Comma separated values",description:"Wildcards are allowed, e.g. image/*.",children:(0,n.jsx)(R.MJ,{children:(0,n.jsx)(I.p,{id:"allowed_mime_types",...t,placeholder:"e.g image/jpeg, image/png, audio/mpeg, video/mp4, etc"})})})}},"allowed_mime_types")]})]})}),(0,n.jsxs)(D.Es,{"data-sentry-element":"DialogFooter","data-sentry-source-file":"EditBucketModal.tsx",children:[(0,n.jsx)(G.$,{type:"default",disabled:C,onClick:V,"data-sentry-element":"Button","data-sentry-source-file":"EditBucketModal.tsx",children:"Cancel"}),(0,n.jsx)(G.$,{form:e_,htmlType:"submit",loading:C,"data-sentry-element":"Button","data-sentry-source-file":"EditBucketModal.tsx",children:"Save"})]})]})})};async function ew(e){let{projectRef:t,id:a}=e;if(!t)throw Error("projectRef is required");if(!a)throw Error("Bucket name is requried");let{data:n,error:r}=await (0,w.bE)("/platform/storage/{ref}/buckets/{id}/empty",{params:{path:{id:a,ref:t}}});return r&&(0,w.H4)(r),n}let eS=function(){let{onSuccess:e,onError:t,...a}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=(0,_.jE)();return(0,k.n)(e=>ew(e),{async onSuccess(t,a,r){let{projectRef:l}=a;await n.invalidateQueries(S.w.buckets(l)),await (null==e?void 0:e(t,a,r))},async onError(e,a,n){void 0===t?x.oR.error("Failed to empty bucket: ".concat(e.message)):t(e,a,n)},...a})},eN=e=>{let{visible:t,bucket:a,onClose:r}=e,{ref:l}=(0,o.g)(),{fetchFolderContents:s}=(0,X.$)(),{mutate:i,isLoading:c}=eS({onSuccess:async()=>{void 0!==a&&(await s({bucketId:a.id,folderId:a.id,folderName:a.name,index:-1}),x.oR.success("Successfully deleted bucket ".concat(a.name)),r())}}),d=async()=>l?a?void i({projectRef:l,id:a.id}):console.error("No bucket is selected"):console.error("Project ref is required");return(0,n.jsx)(D.lG,{open:t,onOpenChange:e=>{e||r()},"data-sentry-element":"Dialog","data-sentry-component":"EmptyBucketModal","data-sentry-source-file":"EmptyBucketModal.tsx",children:(0,n.jsxs)(D.Cf,{"data-sentry-element":"DialogContent","data-sentry-source-file":"EmptyBucketModal.tsx",children:[(0,n.jsx)(D.c7,{"data-sentry-element":"DialogHeader","data-sentry-source-file":"EmptyBucketModal.tsx",children:(0,n.jsx)(D.L3,{"data-sentry-element":"DialogTitle","data-sentry-source-file":"EmptyBucketModal.tsx",children:"Confirm to delete all contents from ".concat(null==a?void 0:a.name)})}),(0,n.jsx)(D.pf,{"data-sentry-element":"DialogSectionSeparator","data-sentry-source-file":"EmptyBucketModal.tsx"}),(0,n.jsx)(U.Z,{type:"destructive",className:"rounded-none border-x-0 border-t-0 mb-0",title:"This action cannot be undone",description:"The contents of your bucket cannot be recovered once deleted.","data-sentry-element":"Admonition","data-sentry-source-file":"EmptyBucketModal.tsx"}),(0,n.jsx)(D.OO,{"data-sentry-element":"DialogSection","data-sentry-source-file":"EmptyBucketModal.tsx",children:(0,n.jsxs)("p",{className:"text-sm",children:['Are you sure you want to empty the bucket "',null==a?void 0:a.name,'"?']})}),(0,n.jsxs)(D.Es,{"data-sentry-element":"DialogFooter","data-sentry-source-file":"EmptyBucketModal.tsx",children:[(0,n.jsx)(G.$,{type:"default",disabled:c,onClick:r,"data-sentry-element":"Button","data-sentry-source-file":"EmptyBucketModal.tsx",children:"Cancel"}),(0,n.jsx)(G.$,{type:"danger",loading:c,onClick:d,"data-sentry-element":"Button","data-sentry-source-file":"EmptyBucketModal.tsx",children:"Empty bucket"})]})]})})};var eM=a(51500),eC=a(2119),eA=a(30435),eE=a(71139);let eB=e=>{let{bucket:t,projectRef:a="",isSelected:r=!1}=e,{can:s}=(0,E.hl)(d.aG.STORAGE_WRITE,"*"),[o,c]=(0,i.useState)(null),u=()=>c(null);return(0,n.jsxs)("div",{className:(0,eM.cn)("group flex items-center justify-between rounded-md",r&&"text-foreground bg-surface-100"),"data-sentry-component":"BucketRow","data-sentry-source-file":"BucketRow.tsx",children:[(0,n.jsx)(l(),{href:"/project/".concat(a,"/storage/buckets/").concat(encodeURIComponent(t.id)),className:"py-1 px-3 grow","data-sentry-element":"Link","data-sentry-source-file":"BucketRow.tsx",children:(0,n.jsxs)("div",{className:"flex items-center justify-between space-x-2 truncate w-full",children:[(0,n.jsx)("p",{className:"text-sm group-hover:text-foreground transition truncate ".concat(r?"text-foreground":"text-foreground-light"),title:t.name,children:t.name}),t.public&&(0,n.jsx)(eC.E,{variant:"warning",children:"Public"}),"ANALYTICS"===t.type&&(0,n.jsxs)(eA.m_,{children:[(0,n.jsx)(eA.k$,{asChild:!0,children:(0,n.jsx)(ea.A,{className:"text-foreground-lighter",size:"20"})}),(0,n.jsx)(eA.ZI,{children:(0,n.jsx)("p",{children:"Analytics bucket"})})]})]})}),s&&r?(0,n.jsxs)(eE.rI,{children:[(0,n.jsx)(eE.ty,{asChild:!0,children:(0,n.jsx)(G.$,{type:"text",icon:(0,n.jsx)(en.A,{}),className:"mr-1 h-6 w-6"})}),(0,n.jsxs)(eE.SQ,{side:"bottom",align:"start",children:["ANALYTICS"!==t.type&&(0,n.jsxs)(n.Fragment,{children:[(0,n.jsxs)(eE._2,{className:"space-x-2",onClick:()=>c("edit"),children:[(0,n.jsx)(er.A,{size:14}),(0,n.jsx)("p",{children:"Edit bucket"})]},"toggle-private"),(0,n.jsx)(eE.mB,{}),(0,n.jsxs)(eE._2,{className:"space-x-2",onClick:()=>c("empty"),children:[(0,n.jsx)(el.A,{size:14}),(0,n.jsx)("p",{children:"Empty bucket"})]},"empty-bucket")]}),(0,n.jsxs)(eE._2,{className:"space-x-2",onClick:()=>c("delete"),children:[(0,n.jsx)(es.A,{size:14}),(0,n.jsx)("p",{children:"Delete bucket"})]},"delete-bucket")]})]}):(0,n.jsx)("div",{className:"w-7 mr-1"}),(0,n.jsx)(ek,{visible:"edit"===o,bucket:t,onClose:u,"data-sentry-element":"EditBucketModal","data-sentry-source-file":"BucketRow.tsx"}),(0,n.jsx)(eN,{visible:"empty"===o,bucket:t,onClose:u,"data-sentry-element":"EmptyBucketModal","data-sentry-source-file":"BucketRow.tsx"}),(0,n.jsx)(eg,{visible:"delete"===o,bucket:t,onClose:u,"data-sentry-element":"DeleteBucketModal","data-sentry-source-file":"BucketRow.tsx"})]},t.id)},ez=()=>{let e=(0,s.useRouter)(),{ref:t,bucketId:a}=(0,o.g)(),{data:r}=(0,K.YA)(),c=(0,X.$)(),d=(null==r?void 0:r.parent_project_ref)!==void 0,[u,m]=(0,i.useState)(""),p=e.pathname.split("/")[4],{data:h=[],error:x,isLoading:f,isError:g,isSuccess:y}=(0,Z.p)({projectRef:t}),b="alphabetical"===c.sortBucket?h.sort((e,t)=>e.name.toLowerCase().trim().localeCompare(t.name.toLowerCase().trim())):h.sort((e,t)=>new Date(t.created_at)>new Date(e.created_at)?-1:1),j=u.length>1?b.filter(e=>e.name.includes(u.trim())):b,v=(null==x?void 0:x.message.includes("Tenant config"))&&d;return(0,n.jsx)(n.Fragment,{children:(0,n.jsxs)(ee.Ay,{type:"pills",className:"mt-6 flex flex-grow flex-col","data-sentry-element":"Menu","data-sentry-source-file":"StorageMenu.tsx",children:[(0,n.jsxs)("div",{className:"mb-6 mx-5 flex flex-col gap-y-1.5",children:[(0,n.jsx)(V,{"data-sentry-element":"CreateBucketModal","data-sentry-source-file":"StorageMenu.tsx"}),(0,n.jsx)(et.a0,{className:"px-0","data-sentry-element":"InnerSideBarFilters","data-sentry-source-file":"StorageMenu.tsx",children:(0,n.jsx)(et.RK,{name:"search-buckets","aria-labelledby":"Search buckets",placeholder:"Search buckets...",value:u,onChange:e=>{m(e.target.value)},"data-sentry-element":"InnerSideBarFilterSearchInput","data-sentry-source-file":"StorageMenu.tsx",children:(0,n.jsxs)(et.i9,{value:c.sortBucket,onValueChange:e=>c.setSortBucket(e),"data-sentry-element":"InnerSideBarFilterSortDropdown","data-sentry-source-file":"StorageMenu.tsx",children:[(0,n.jsx)(et.Pl,{value:"alphabetical",className:"flex gap-2","data-sentry-element":"InnerSideBarFilterSortDropdownItem","data-sentry-source-file":"StorageMenu.tsx",children:"Alphabetical"},"alphabetical"),(0,n.jsx)(et.Pl,{value:"created-at","data-sentry-element":"InnerSideBarFilterSortDropdownItem","data-sentry-source-file":"StorageMenu.tsx",children:"Created at"},"created-at")]})})})]}),(0,n.jsxs)("div",{className:"space-y-6",children:[(0,n.jsxs)("div",{className:"mx-3",children:[(0,n.jsx)(ee.Ay.Group,{title:(0,n.jsx)("span",{className:"uppercase font-mono",children:"All buckets"}),"data-sentry-element":"Menu.Group","data-sentry-source-file":"StorageMenu.tsx"}),f&&(0,n.jsxs)("div",{className:"space-y-2 mx-2",children:[(0,n.jsx)($.A,{className:"!py-2.5"}),(0,n.jsx)($.A,{className:"!py-2.5"}),(0,n.jsx)($.A,{className:"!py-2.5"})]}),g&&(0,n.jsx)("div",{className:"px-2",children:(0,n.jsxs)(q.Fc,{variant:v?"default":"warning",children:[(0,n.jsx)(q.XL,{className:"text-xs tracking-normal",children:v?"Storage is not available on preview branches for now":"Failed to fetch buckets"}),(0,n.jsx)(q.TN,{className:"text-xs",children:v?"We're actively looking into making this available on preview branches":"Please refresh to try again"})]})}),y&&(0,n.jsxs)(n.Fragment,{children:[0===h.length&&(0,n.jsx)(et.Q5,{className:"mx-2",title:"No buckets available",description:"Buckets that you create will appear here"}),u.length>0&&0===j.length&&(0,n.jsx)(et.Q5,{className:"mx-2",title:"No results found",description:'Your search for "'.concat(u,'" did not return any results')}),j.map((e,r)=>{let l=a===e.id;return(0,n.jsx)(eB,{bucket:e,projectRef:t,isSelected:l},"".concat(r,"_").concat(e.id))})]})]}),(0,n.jsxs)("div",{className:"w-full bg-dash-sidebar px-3 py-6 sticky bottom-0 border-t border-border",children:[(0,n.jsx)(ee.Ay.Group,{title:(0,n.jsx)("span",{className:"uppercase font-mono",children:"Configuration"}),"data-sentry-element":"Menu.Group","data-sentry-source-file":"StorageMenu.tsx"}),(0,n.jsx)(l(),{href:"/project/".concat(t,"/storage/policies"),"data-sentry-element":"Link","data-sentry-source-file":"StorageMenu.tsx",children:(0,n.jsx)(ee.Ay.Item,{rounded:!0,active:"policies"===p,"data-sentry-element":"Menu.Item","data-sentry-source-file":"StorageMenu.tsx",children:(0,n.jsx)("p",{className:"truncate",children:"Policies"})})}),(0,n.jsx)(l(),{href:"/project/".concat(t,"/storage/settings"),"data-sentry-element":"Link","data-sentry-source-file":"StorageMenu.tsx",children:(0,n.jsx)(ee.Ay.Item,{rounded:!0,active:"settings"===p,"data-sentry-element":"Menu.Item","data-sentry-source-file":"StorageMenu.tsx",children:(0,n.jsx)("p",{className:"truncate",children:"Settings"})})})]})]})]})})};var eD=a(52361),eR=a(31533);let eI=(0,eD.r)(e=>{let{title:t,children:a}=e;return(0,n.jsx)(eR.A,{stickySidebarBottom:!0,title:t||"Storage",product:"Storage",productMenu:(0,n.jsx)(ez,{}),"data-sentry-element":"ProjectLayout","data-sentry-component":"StorageLayout","data-sentry-source-file":"StorageLayout.tsx",children:a})})},5588:(e,t,a)=>{a.d(t,{P:()=>s});var n=a(77569),r=a(91435),l=a(5483);let s=()=>{var e,t;let{data:a}=(0,l.YA)(),{data:s,isLoading:i}=(0,r.z)({projectRef:null==a?void 0:a.ref,connectionString:null==a?void 0:a.connectionString}),o=n.o.find(e=>"iceberg_wrapper"===e.id);if(!o||"wrapper"!==o.type)return"not-found";let c=o.meta,d=null==s?void 0:s.find(e=>"wrappers"===e.name),u=!!(null==d?void 0:d.installed_version),m=(null!=(e=null==d?void 0:d.installed_version)?e:"")>=(null!=(t=null==c?void 0:c.minimumExtensionVersion)?t:"");return i?"loading":u?m?"installed":"needs-upgrade":"not-installed"}},17498:(e,t,a)=>{a.d(t,{f:()=>d});var n=a(47319),r=a(32144),l=a(80251),s=a(73969),i=a(15629),o=a(30784);async function c(e){let{projectRef:t,connectionString:a,originalPolicy:r}=e,l=new Headers;a&&l.set("x-connection-encrypted",a);let{sql:s}=n.A.policies.remove(r),{result:o}=await (0,i.E)({projectRef:t,connectionString:a,sql:s,queryKey:["policy","delete",r.id]});return o}let d=function(){let{onSuccess:e,onError:t,...a}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=(0,r.jE)();return(0,l.n)(e=>c(e),{async onSuccess(t,a,r){let{projectRef:l}=a;await n.invalidateQueries(o.S.list(l)),await (null==e?void 0:e(t,a,r))},async onError(e,a,n){void 0===t?s.oR.error("Failed to delete database policy: ".concat(e.message)):t(e,a,n)},...a})}},24771:(e,t,a)=>{a.d(t,{A:()=>r});var n=a(80263);a(53239);let r=function(e){let{children:t,target:a="_blank",href:r,className:l,onClick:s,style:i}=e;return(0,n.jsx)("a",{onClick:s,href:r,target:a,rel:"noopener noreferrer",style:i,"data-sentry-component":"Link","data-sentry-source-file":"Link.tsx",children:t})}},33647:(e,t,a)=>{a.d(t,{j:()=>d});var n=a(56947),r=a(89811),l=a(65172),s=a(5483),i=a(63492),o=a(30784);async function c(e,t,a){let{projectRef:n,connectionString:s,schema:i}=e;if(!n)throw Error("projectRef is required");let o=new Headers(a);s&&o.set("x-connection-encrypted",s);let{data:c,error:d}=await (0,l.Jt)("/platform/pg-meta/{ref}/policies",{params:{header:{"x-connection-encrypted":s,"x-pg-application-name":r.r},path:{ref:n},query:{included_schemas:i||"",excluded_schemas:""}},headers:o,signal:t});return d&&(0,l.H4)(d),c}let d=function(e){let{projectRef:t,connectionString:a,schema:r}=e,{enabled:l=!0,...d}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},{data:u}=(0,s.YA)(),m=(null==u?void 0:u.status)===i.BU.ACTIVE_HEALTHY;return(0,n.I)(o.S.list(t,r),e=>{let{signal:n}=e;return c({projectRef:t,connectionString:a,schema:r},n)},{enabled:l&&void 0!==t&&m,...d})}},39719:(e,t,a)=>{a.d(t,{S:()=>c});var n=a(32144),r=a(80251),l=a(73969),s=a(65172),i=a(49009);let o=async e=>{let{description:t,projectRef:a}=e;if(!a)throw Error("projectRef is required");let{data:n,error:r}=await (0,s.bE)("/platform/storage/{ref}/credentials",{params:{path:{ref:a}},body:{description:t}});return r&&(0,s.H4)(r),n};function c(){let{onSuccess:e,onError:t,...a}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},s=(0,n.jE)();return(0,r.n)(e=>o(e),{async onSuccess(t,a,n){let{projectRef:r}=a;await s.invalidateQueries(i.A.credentials(r)),await (null==e?void 0:e(t,a,n))},async onError(e,a,n){void 0===t?l.oR.error("Failed to create S3 access key: ".concat(e.message)):t(e,a,n)},...a})}},43242:(e,t,a)=>{a.d(t,{Ay:()=>p});var n=a(80263),r=a(53239),l=a(70800),s=a(51500),i=a(24771);function o(e){let{children:t,className:a,tag:r="div",style:l}=e;return(0,n.jsx)("".concat(r),{style:l,"data-sentry-element":"CustomTag","data-sentry-component":"Typography","data-sentry-source-file":"Typography.tsx",children:t})}o.Title=function(e){let{className:t,level:a=1,children:r,style:l}=e;return(0,n.jsx)("h".concat(a),{style:l,"data-sentry-element":"CustomTag","data-sentry-component":"Title","data-sentry-source-file":"Title.tsx",children:r})},o.Text=function(e){let{className:t,children:a,style:r,type:l,disabled:s,mark:i,code:o,keyboard:c,underline:d,strikethrough:u,strong:m,small:p}=e;return o?(0,n.jsx)("code",{style:r,children:a}):i?(0,n.jsx)("mark",{style:r,children:a}):c?(0,n.jsx)("kbd",{style:r,children:a}):m?(0,n.jsx)("strong",{style:r,children:a}):(0,n.jsx)("span",{style:r,"data-sentry-component":"Text","data-sentry-source-file":"Text.tsx",children:a})},o.Link=i.A;let c=(0,r.createContext)({type:"text"}),d=e=>{let{type:t}=e;return(0,n.jsx)(c.Provider,{value:{type:t},"data-sentry-element":"MenuContext.Provider","data-sentry-component":"MenuContextProvider","data-sentry-source-file":"MenuContext.tsx",children:e.children})},u=()=>{let e=(0,r.useContext)(c);if(void 0===e)throw Error("MenuContext must be used within a MenuContextProvider.");return e};function m(e){let{children:t,className:a,ulClassName:r,style:l,type:s="text"}=e;return(0,n.jsx)("nav",{role:"menu","aria-label":"Sidebar","aria-orientation":"vertical","aria-labelledby":"options-menu",className:a,style:l,"data-sentry-component":"Menu","data-sentry-source-file":"Menu.tsx",children:(0,n.jsx)(d,{type:s,"data-sentry-element":"MenuContextProvider","data-sentry-source-file":"Menu.tsx",children:(0,n.jsx)("ul",{className:r,children:t})})})}m.Item=function(e){let{children:t,icon:a,active:r,rounded:i,onClick:o,doNotCloseOverlay:c=!1,showActiveBar:d=!1,style:m}=e,p=(0,l.A)("menu"),{type:h}=u(),x=[p.item.base];x.push(p.item.variants[h].base),r?x.push(p.item.variants[h].active):x.push(p.item.variants[h].normal);let f=[p.item.content.base];r?f.push(p.item.content.active):f.push(p.item.content.normal);let g=[p.item.icon.base];return r?g.push(p.item.icon.active):g.push(p.item.icon.normal),(0,n.jsxs)("li",{role:"menuitem",className:(0,s.cn)("outline-none",x),style:m,onClick:o,"aria-current":r?"page":void 0,"data-sentry-component":"Item","data-sentry-source-file":"Menu.tsx",children:[a&&(0,n.jsx)("div",{className:"".concat(g.join(" ")," min-w-fit"),children:a}),(0,n.jsx)("span",{className:f.join(" "),children:t})]})},m.Group=function(e){let{children:t,icon:a,title:r}=e,s=(0,l.A)("menu"),{type:i}=u();return(0,n.jsxs)("div",{className:[s.group.base,s.group.variants[i]].join(" "),"data-sentry-component":"Group","data-sentry-source-file":"Menu.tsx",children:[a&&(0,n.jsx)("span",{className:s.group.icon,children:a}),(0,n.jsx)("span",{className:s.group.content,children:r}),t]})},m.Misc=function(e){let{children:t}=e;return(0,n.jsx)("div",{"data-sentry-component":"Misc","data-sentry-source-file":"Menu.tsx",children:(0,n.jsx)(o.Text,{"data-sentry-element":"Typography.Text","data-sentry-source-file":"Menu.tsx",children:(0,n.jsx)("span",{children:t})})})};let p=m},47221:(e,t,a)=>{a.d(t,{Z:()=>h});var n=a(60045),r=a(52793),l=a.n(r),s=a(23229),i=a(54498),o=a(76291),c=a(67575),d=a(66427),u=a(75019),m=a(5483),p=a(39719);let h=()=>{var e,t,a,r,h,x;let{data:f}=(0,m.YA)(),{data:g}=(0,o.I)({projectRef:null==f?void 0:f.ref,reveal:!0}),{secretKey:y,serviceKey:b}=(0,o.x)(g),{data:j}=(0,c.G)({projectRef:null==f?void 0:f.ref}),v=null!=(r=null==j||null==(e=j.app_config)?void 0:e.protocol)?r:"https",_=(null==j||null==(t=j.app_config)?void 0:t.storage_endpoint)||(null==j||null==(a=j.app_config)?void 0:a.endpoint),k=null!=(x=null!=(h=null==y?void 0:y.api_key)?h:null==b?void 0:b.api_key)?x:"SUPABASE_CLIENT_API_KEY",w=s.V.find(e=>"iceberg_wrapper"===e.name),S=(0,u.SE)(n.aG.STORAGE_ADMIN_WRITE,"*"),{mutateAsync:N,isLoading:M}=(0,p.S)(),{mutateAsync:C,isLoading:A}=(0,d.m_)();return{mutateAsync:async e=>{var t,a;let{bucketName:n}=e,r=await N({projectRef:null==f?void 0:f.ref,description:"".concat(l()(n),"_keys")}),s="".concat(l()(n),"_fdw"),o={projectRef:null==f?void 0:f.ref,connectionString:null==f?void 0:f.connectionString,wrapperMeta:w,formState:{wrapper_name:s,server_name:"".concat(s,"_server"),vault_aws_access_key_id:null==r?void 0:r.access_key,vault_aws_secret_access_key:null==r?void 0:r.secret_key,vault_token:k,warehouse:n,"s3.endpoint":(0,i.yO)(null!=(t=null==f?void 0:f.ref)?t:"",v,_),catalog_uri:(0,i.Uj)(null!=(a=null==f?void 0:f.ref)?a:"",v,_)},mode:"skip",tables:[],sourceSchema:"",targetSchema:""};await C(o)},isLoading:A||M,hasPermission:S}}},49009:(e,t,a)=>{a.d(t,{A:()=>n});let n={credentials:e=>["projects",e,"storage-credentials"]}},77569:(e,t,a)=>{a.d(t,{o:()=>N});var n=a(80263),r=a(24863),l=a(85563),s=a(5010),i=a(36975),o=a(59350),c=a(49434),d=a.n(c),u=a(16426),m=a.n(u),p=a(90437),h=a(63492),x=a(51500),f=a(15601),g=a.n(f),y=a(5483),b=a(40022),j=a(47142);let v=e=>{let{minimumVersion:t="15.6"}=e,{data:a}=(0,y.YA)();return(0,n.jsxs)(j.Z,{type:"warning",className:"mt-4",title:"Database upgrade needed",childProps:{description:{className:"flex flex-col gap-y-2"}},"data-sentry-element":"Admonition","data-sentry-component":"UpgradeDatabaseAlert","data-sentry-source-file":"UpgradeDatabaseAlert.tsx",children:[(0,n.jsx)("div",{className:"prose text-sm max-w-full",children:(0,n.jsxs)("p",{children:["This integration requires the ",(0,n.jsx)("code",{children:"pgmq"})," extension which is not available on this version of Postgres. The extension is available on version ",t," and higher."]})}),(0,n.jsx)(b.$,{color:"primary",className:"w-fit","data-sentry-element":"Button","data-sentry-source-file":"UpgradeDatabaseAlert.tsx",children:(0,n.jsx)(g(),{href:"/project/".concat(null==a?void 0:a.ref,"/settings/infrastructure"),"data-sentry-element":"Link","data-sentry-source-file":"UpgradeDatabaseAlert.tsx",children:"Upgrade database"})})]})};var _=a(23229);let k=()=>(0,n.jsx)("div",{className:"p-10","data-sentry-component":"Loading","data-sentry-source-file":"Integrations.constants.tsx",children:(0,n.jsx)(p.y,{"data-sentry-element":"GenericSkeletonLoader","data-sentry-source-file":"Integrations.constants.tsx"})}),w={name:"Supabase",websiteUrl:"https://supabase.com"},S=[{id:"queues",type:"postgres_extension",requiredExtensions:["pgmq"],missingExtensionsAlert:(0,n.jsx)(v,{minimumVersion:"15.6.1.143"}),name:"Queues",icon:function(){let{className:e,...t}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return(0,n.jsx)(r.A,{className:(0,x.cn)("inset-0 p-2 text-black w-full h-full",e),...t})},description:"Lightweight message queue in Postgres",docsUrl:"https://github.com/tembo-io/pgmq",author:{name:"pgmq",websiteUrl:"https://github.com/tembo-io/pgmq"},navigation:[{route:"overview",label:"Overview"},{route:"queues",label:"Queues",hasChild:!0,childIcon:(0,n.jsx)(r.A,{size:12,strokeWidth:1.5,className:(0,x.cn)("text-foreground w-full h-full")})},{route:"settings",label:"Settings"}],navigate:function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"overview",n=arguments.length>2?arguments[2]:void 0;if(n)return d()(()=>Promise.all([a.e(4986),a.e(89),a.e(9441),a.e(7494),a.e(7598),a.e(4560),a.e(6797),a.e(2360),a.e(7795),a.e(5089),a.e(9897),a.e(6692),a.e(6616),a.e(1444),a.e(2101),a.e(3064),a.e(9107),a.e(5415)]).then(a.bind(a,19069)).then(e=>e.QueuePage),{loadableGenerated:{webpack:()=>[19069]},loading:k});switch(t){case"overview":return d()(()=>Promise.all([a.e(9441),a.e(7598),a.e(6616),a.e(2621),a.e(1793)]).then(a.bind(a,37138)).then(e=>e.QueuesOverviewTab),{loadableGenerated:{webpack:()=>[37138]},loading:k});case"queues":return d()(()=>Promise.all([a.e(7494),a.e(4560),a.e(6616),a.e(3112),a.e(9107),a.e(9631)]).then(a.bind(a,29631)).then(e=>e.QueuesTab),{loadableGenerated:{webpack:()=>[29631]},loading:k});case"settings":return d()(()=>Promise.all([a.e(7494),a.e(6616),a.e(1631),a.e(7119)]).then(a.bind(a,47119)).then(e=>e.QueuesSettings),{loadableGenerated:{webpack:()=>[47119]},loading:k})}return null}},{id:"cron",type:"postgres_extension",requiredExtensions:["pg_cron"],name:"Cron",icon:function(){let{className:e,...t}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return(0,n.jsx)(l.A,{className:(0,x.cn)("inset-0 p-2 text-black w-full h-full",e),...t})},description:"Schedule recurring Jobs in Postgres",docsUrl:"https://github.com/citusdata/pg_cron",author:{name:"Citus Data",websiteUrl:"https://github.com/citusdata/pg_cron"},navigation:[{route:"overview",label:"Overview"},{route:"jobs",label:"Jobs",hasChild:!0,childIcon:(0,n.jsx)(s.A,{size:12,strokeWidth:1.5,className:(0,x.cn)("text-foreground w-full h-full")})}],navigate:function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"overview",n=arguments.length>2?arguments[2]:void 0;if(n)return d()(()=>Promise.all([a.e(4986),a.e(89),a.e(8199),a.e(9441),a.e(7494),a.e(7598),a.e(4560),a.e(6797),a.e(2360),a.e(7795),a.e(9524),a.e(7686),a.e(2621),a.e(2101),a.e(2866),a.e(6587)]).then(a.bind(a,78366)).then(e=>e.CronJobPage),{loadableGenerated:{webpack:()=>[78366]},loading:k});switch(t){case"overview":return d()(()=>Promise.all([a.e(9441),a.e(7598),a.e(2621),a.e(6631)]).then(a.bind(a,68316)).then(e=>e.IntegrationOverviewTab),{loadableGenerated:{webpack:()=>[68316]},loading:k});case"jobs":return d()(()=>Promise.all([a.e(4986),a.e(89),a.e(8199),a.e(9441),a.e(7494),a.e(7598),a.e(4560),a.e(6797),a.e(2360),a.e(7795),a.e(9524),a.e(7686),a.e(2621),a.e(2866),a.e(9564)]).then(a.bind(a,54802)).then(e=>e.CronjobsTab),{loadableGenerated:{webpack:()=>[54802]},loading:k})}return null}},{id:"vault",type:"postgres_extension",requiredExtensions:["supabase_vault"],missingExtensionsAlert:(0,n.jsx)(v,{}),name:"Vault",status:"alpha",icon:function(){let{className:e,...t}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return(0,n.jsx)(i.A,{className:(0,x.cn)("inset-0 p-2 text-black w-full h-full",e),...t})},description:"Application level encryption for your project",docsUrl:"https://supabase.com/docs",author:w,navigation:[{route:"overview",label:"Overview"},{route:"secrets",label:"Secrets"}],navigate:function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"overview";switch(arguments.length>2&&arguments[2],t){case"overview":return d()(()=>Promise.all([a.e(9441),a.e(7598),a.e(2621),a.e(6631)]).then(a.bind(a,68316)).then(e=>e.IntegrationOverviewTab),{loadableGenerated:{webpack:()=>[68316]},loading:k});case"secrets":return d()(()=>Promise.all([a.e(9441),a.e(7494),a.e(7598),a.e(4560),a.e(6797),a.e(849),a.e(3402)]).then(a.bind(a,3402)).then(e=>e.SecretsManagement),{loadableGenerated:{webpack:()=>[3402]},loading:k})}return null}},{id:"webhooks",type:"postgres_extension",name:"Database Webhooks",icon:function(){let{className:e,...t}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return(0,n.jsx)(o.A,{className:(0,x.cn)("inset-0 p-2 text-black w-full h-full",e),...t})},description:"Send real-time data from your database to another system when a table event occurs",docsUrl:"https://supabase.com/docs",author:w,requiredExtensions:[],navigation:[{route:"overview",label:"Overview"},{route:"webhooks",label:"Webhooks"}],navigate:function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"overview";switch(arguments.length>2&&arguments[2],t){case"overview":return d()(()=>Promise.all([a.e(9441),a.e(7598),a.e(2621),a.e(4039)]).then(a.bind(a,940)).then(e=>e.WebhooksOverviewTab),{loadableGenerated:{webpack:()=>[940]},loading:k});case"webhooks":return d()(()=>Promise.all([a.e(9441),a.e(7494),a.e(4280),a.e(7598),a.e(6616),a.e(849),a.e(9434)]).then(a.bind(a,59434)).then(e=>e.WebhooksListTab),{loadableGenerated:{webpack:()=>[59434]},loading:k})}return null}},{id:"graphiql",type:"postgres_extension",requiredExtensions:["pg_graphql"],name:"GraphQL",icon:function(){let{className:e,...t}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return(0,n.jsx)(m(),{fill:!0,src:"".concat(h.o2,"/img/graphql.svg"),alt:"GraphiQL",className:(0,x.cn)("p-2",e),...t})},description:"Run GraphQL queries through our interactive in-browser IDE",docsUrl:"https://supabase.com/docs",author:w,navigation:[{route:"overview",label:"Overview"},{route:"graphiql",label:"GraphiQL"}],navigate:function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"overview";switch(arguments.length>2&&arguments[2],t){case"overview":return d()(()=>Promise.all([a.e(9441),a.e(7598),a.e(2621),a.e(6631)]).then(a.bind(a,68316)).then(e=>e.IntegrationOverviewTab),{loadableGenerated:{webpack:()=>[68316]},loading:k});case"graphiql":return d()(()=>Promise.all([a.e(5708),a.e(4986),a.e(9441),a.e(7598),a.e(4560),a.e(2360),a.e(6692),a.e(4149),a.e(1444),a.e(5957),a.e(6540)]).then(a.bind(a,51044)).then(e=>e.GraphiQLTab),{loadableGenerated:{webpack:()=>[51044]},loading:k})}return null}}],N=[..._.V.map(e=>({id:e.name,type:"wrapper",name:"".concat(e.label," Wrapper"),icon:function(){let{className:t,...a}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return(0,n.jsx)(m(),{fill:!0,src:e.icon,alt:e.name,className:(0,x.cn)("p-2",t),...a})},requiredExtensions:["wrappers","supabase_vault"],description:e.description,docsUrl:e.docsUrl,meta:e,author:w,navigation:[{route:"overview",label:"Overview"},{route:"wrappers",label:"Wrappers"}],navigate:function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"overview";switch(arguments.length>2&&arguments[2],t){case"overview":return d()(()=>Promise.all([a.e(4986),a.e(9441),a.e(7598),a.e(9515),a.e(2621),a.e(6915),a.e(8989)]).then(a.bind(a,79142)).then(e=>e.WrapperOverviewTab),{loadableGenerated:{webpack:()=>[79142]},loading:k});case"wrappers":return d()(()=>Promise.all([a.e(4986),a.e(9441),a.e(7598),a.e(9515),a.e(6915),a.e(5794)]).then(a.bind(a,57357)).then(e=>e.WrappersTab),{loadableGenerated:{webpack:()=>[57357]},loading:k})}return null}})),...S]},85278:(e,t,a)=>{a.d(t,{I:()=>o});var n=a(56947),r=a(65172),l=a(47114),s=a(63492);async function i(e,t){let{projectRef:a}=e;if(!a)throw Error("projectRef is required");let{data:n,error:l}=await (0,r.Jt)("/platform/projects/{ref}/config/storage",{params:{path:{ref:a}},signal:t});return l&&(0,r.H4)(l),n}let o=function(e){let{projectRef:t}=e,{enabled:a=!0,...r}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return(0,n.I)(l.n.storage(t),e=>{let{signal:a}=e;return i({projectRef:t},a)},{enabled:a&&s.pe&&void 0!==t,...r})}},91435:(e,t,a)=>{a.d(t,{z:()=>d});var n=a(89811),r=a(56947),l=a(65172),s=a(5483),i=a(63492),o=a(28140);async function c(e,t,a){let{projectRef:r,connectionString:s}=e;if(!r)throw Error("projectRef is required");let i=new Headers(a);s&&i.set("x-connection-encrypted",s);let{data:o,error:c}=await (0,l.Jt)("/platform/pg-meta/{ref}/extensions",{params:{header:{"x-connection-encrypted":s,"x-pg-application-name":n.r},path:{ref:r}},headers:i,signal:t});return c&&(0,l.H4)(c),o}let d=function(e){let{projectRef:t,connectionString:a}=e,{enabled:n=!0,...l}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},{data:d}=(0,s.YA)(),u=(null==d?void 0:d.status)===i.BU.ACTIVE_HEALTHY;return(0,r.I)(o.I.list(t),e=>{let{signal:n}=e;return c({projectRef:t,connectionString:a},n)},{enabled:n&&void 0!==t&&u,...l})}},95300:(e,t,a)=>{a.d(t,{EQ:()=>y,Xn:()=>g,_S:()=>c,kg:()=>p,wS:()=>x});var n=a(107),r=a.n(n),l=a(42092),s=a.n(l),i=a(52308);let o=e=>{let t=0;for(let a=0;a<e.length;a++)t=(t<<5)-t+e.charCodeAt(a),t&=t;return new Uint32Array([t])[0].toString(36)},c=(e,t)=>0===t.length?t:m(d(e,t)),d=(e,t)=>{let a=e.map(e=>e.name);return t.map(e=>{let{definition:t,check:n}=e,r=null!==t?u(t):u(n);return r&&a.includes(r)?{...e,bucket:r}:{...e,bucket:"Ungrouped"}})},u=e=>{var t;let[a]=(null!=(t=null==e?void 0:e.split(" AND "))?t:[]).filter(e=>e.includes("bucket_id"));return a?a.split("'")[1]:null},m=e=>{let t=r()(e,"bucket");return Object.keys(t).map(e=>({name:e,policies:t[e]}))},p=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",t=arguments.length>1?arguments[1]:void 0,a=!(arguments.length>2)||void 0===arguments[2]||arguments[2],{name:n,definition:r,allowedOperations:l,roles:s}=t,i=r?r.replace(/\s+/g," ").trim():"";return l.map((t,r)=>h(r,e,n,i,t,s,a))},h=(e,t,a,n,r,l,s)=>{let i=o(t);return{name:s?"".concat(a," ").concat(i,"_").concat(e):a,definition:"INSERT"===r?void 0:"(".concat(n,")"),action:"PERMISSIVE",check:"INSERT"===r?"(".concat(n,")"):void 0,command:r,schema:"storage",table:"objects",roles:l.length>0?l:void 0}},x=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];return Object.keys(i.Uw).filter(t=>{let a=i.Uw[t];if(0===s()(a,e).length)return t})},f=(e,t,a,n,r,l,s)=>{let i=o(t),c=s?"".concat(a," ").concat(i,"_").concat(e):a,d="Add policy for the ".concat(r,' operation under the policy "').concat(a,'"'),u=0===l.length?["public"]:l;return{description:d,statement:'\n    CREATE POLICY "'.concat(c,'"\n    ON storage.objects\n    FOR ').concat(r,"\n    TO ").concat(u.join(", "),"\n    ").concat("INSERT"===r?"WITH CHECK":"USING"," (").concat(n,");\n").replace(/\s+/g," ").trim()}},g=function(e,t){let a=!(arguments.length>2)||void 0===arguments[2]||arguments[2],{name:n,definition:r,allowedOperations:l,roles:s}=t;return l.map((t,l)=>f(l,e,n,r||"",t,s,a))},y=(e,t)=>e.replace("{bucket_id}","'".concat(t,"'"))}}]);