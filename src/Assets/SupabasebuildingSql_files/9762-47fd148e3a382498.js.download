try{!function(){var e="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof globalThis?globalThis:"undefined"!=typeof self?self:{},t=(new e.Error).stack;t&&(e._sentryDebugIds=e._sentryDebugIds||{},e._sentryDebugIds[t]="2e625895-5d6a-4d73-8256-59c5182aed6a",e._sentryDebugIdIdentifier="sentry-dbid-2e625895-5d6a-4d73-8256-59c5182aed6a")}()}catch(e){}(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[9762],{9759:(e,t,s)=>{"use strict";s.d(t,{H:()=>a,y:()=>r});let a=s(10663).Yj().transform(e=>""===e?null:e).nullable().refine(e=>null===e||!isNaN(Number(e)),{message:"Invalid number"}).transform(e=>null===e?null:Number(e)),r=e=>""===e||null===e?null:parseInt(e)},11203:(e,t,s)=>{var a=s(40293);e.exports=function(e){return(null==e?0:e.length)?a(e,1):[]}},26860:(e,t,s)=>{"use strict";s.d(t,{A:()=>S});var a=s(80263),r=s(77598),n=s(11203),i=s.n(n),l=s(53239),o=s(1848),d=s(59676),c=s(92777),u=s(70800),h=s(51500),m=s(60115);let x=(0,l.createContext)({onChange:e=>{},selected:void 0});var p=s(80903);function f(e){let{children:t,className:s,buttonClassName:n,descriptionText:p,error:f,icon:S,id:g="",name:y="",label:j,labelOptional:A,layout:_,value:E,onChange:v,onFocus:b,onBlur:N,style:T,size:C="medium",defaultValue:M,validation:R,disabled:I,optionsWidth:w}=e,[L,P]=(0,l.useState)(void 0),[D,O]=(0,l.useState)({}),F=(0,u.A)("listbox"),U=(0,l.useRef)(null),{formContextOnChange:k,values:B,errors:H,handleBlur:W,touched:z,fieldLevelValidation:Y}=(0,m.x)();B&&!E&&(E=B[g||y],M=B[g||y]),f||(H&&!f&&(f=H[g||y]),f=z&&z[g||y]?f:void 0),(0,l.useEffect)(()=>{void 0!==E&&P(E)},[E]),(0,l.useEffect)(()=>{function e(){var e;document.documentElement.style.setProperty("--width-listbox","".concat(w||(null==(e=U.current)?void 0:e.offsetWidth),"px"))}return window.addEventListener("resize",e),e(),()=>window.removeEventListener("resize",e)},[]),(0,l.useEffect)(()=>{var e;let s=i()(t);function a(e){return s.find(t=>t.props.value===e)}if(E){P(E);let e=a(E);O((null==e?void 0:e.props)?e.props:void 0);return}if(L){let e=a(L);O((null==e?void 0:e.props)?e.props:void 0);return}if(M){P(M);let e=a(L);O((null==e?void 0:e.props)?e.props:void 0);return}O(null==(e=s[0])?void 0:e.props)},[L]);let V=[F.container,F.base,n],X=[F.addOnBefore];return f&&V.push(F.variants.error),f||V.push(F.variants.standard),S&&X.push(F.with_icon),C&&V.push(F.size[C]),I&&V.push(F.disabled),(0,a.jsx)(o.H,{label:j,labelOptional:A,layout:_,id:g,error:f,descriptionText:p,className:s,style:T,size:C,"data-sentry-element":"FormLayout","data-sentry-component":"Listbox","data-sentry-source-file":"Listbox2.tsx",children:(0,a.jsxs)(r.bL,{"data-sentry-element":"DropdownMenuPrimitive.Root","data-sentry-source-file":"Listbox2.tsx",children:[(0,a.jsx)(r.l9,{asChild:!0,disabled:I,"data-sentry-element":"DropdownMenuPrimitive.Trigger","data-sentry-source-file":"Listbox2.tsx",children:(0,a.jsxs)("button",{"data-size":C,ref:U,className:(0,h.cn)(V),onBlur:function(e){W&&W(e),N&&N(e)},onFocus:b,name:y,id:g,children:[(0,a.jsxs)("span",{className:(0,h.cn)(X),children:[S&&(0,a.jsx)(c.A,{size:C,icon:S}),(null==D?void 0:D.addOnBefore)&&(0,a.jsx)(D.addOnBefore,{}),(0,a.jsx)("span",{className:F.label,children:null==D?void 0:D.label})]}),(0,a.jsx)("span",{className:F.chevron_container,children:(0,a.jsx)("svg",{className:F.chevron,xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor","aria-hidden":"true","data-sentry-element":"svg","data-sentry-source-file":"Listbox2.tsx",children:(0,a.jsx)("path",{fillRule:"evenodd",d:"M10 3a1 1 0 01.707.293l3 3a1 1 0 01-1.414 1.414L10 5.414 7.707 7.707a1 1 0 01-1.414-1.414l3-3A1 1 0 0110 3zm-3.707 9.293a1 1 0 011.414 0L10 14.586l2.293-2.293a1 1 0 011.414 1.414l-3 3a1 1 0 01-1.414 0l-3-3a1 1 0 010-1.414z",clipRule:"evenodd","data-sentry-element":"path","data-sentry-source-file":"Listbox2.tsx"})})}),f&&(0,a.jsx)("div",{className:F.actions_container,children:f&&(0,a.jsx)(d.A,{size:C})})]})}),(0,a.jsx)(r.UC,{sideOffset:6,loop:!0,side:"bottom",align:"center",className:F.options_container,"data-sentry-element":"DropdownMenuPrimitive.Content","data-sentry-source-file":"Listbox2.tsx",children:(0,a.jsx)("div",{children:(0,a.jsx)(x.Provider,{value:{onChange:function(e){v&&v(e),P(e);let t={};t.target={type:"select",name:y,id:g,value:e,checked:void 0},k&&k(t),R&&Y(g,R(e))},selected:L},"data-sentry-element":"SelectContext.Provider","data-sentry-source-file":"Listbox2.tsx",children:t})})})]})})}f.Option=function(e){let{id:t,value:s,label:n,disabled:i=!1,children:l,className:o="",addOnBefore:d}=e,c=(0,u.A)("listbox");return(0,a.jsx)(x.Consumer,{"data-sentry-element":"SelectContext.Consumer","data-sentry-component":"SelectOption","data-sentry-source-file":"Listbox2.tsx",children:e=>{let{onChange:n,selected:u}=e,m=u===s;return(0,a.jsxs)(r.q7,{className:(0,h.cn)(c.option,m?c.option_active:" ",i?c.option_disabled:" ",o),onSelect:()=>i?{}:n(s),children:[(0,a.jsxs)("div",{className:c.option_inner,children:[d&&d({active:m,selected:u}),(0,a.jsx)("span",{children:"function"==typeof l?l({active:m,selected:u}):l})]}),m?(0,a.jsx)("span",{className:(0,h.cn)(c.option_check,m?c.option_check_active:""),children:(0,a.jsx)(p.A,{className:c.option_check_icon,"aria-hidden":"true"})}):null]},t)}})};let S=f},27642:(e,t,s)=>{"use strict";s.d(t,{A:()=>o});var a=s(80263),r=s(53239),n=s(40279),i=s(60115);function l(e,t){if(!t.error)return delete e[t.key],e;if(t)return{...e,[t.key]:t.error};throw Error()}function o(e){let{validate:t,...s}=e,[o,d]=(0,r.useReducer)(l,null),c=(0,n.Wx)({validateOnBlur:!0,...s,validationSchema:s.validationSchema,initialValues:s.initialValues,onSubmit:s.onSubmit,validate:t||function(){return o}});return(0,a.jsx)("form",{id:s.id,name:s.name,onSubmit:c.handleSubmit,className:s.className,style:s.style,method:"POST","data-sentry-component":"Form","data-sentry-source-file":"Form.tsx",children:(0,a.jsx)(i.h,{values:c.values,errors:c.errors,formContextOnChange:c.handleChange,handleBlur:c.handleBlur,touched:c.touched,fieldLevelValidation:function(e,t){d({key:e,error:t})},"data-sentry-element":"FormContextProvider","data-sentry-source-file":"Form.tsx",children:s.children({errors:c.errors,touched:c.touched,isSubmitting:c.isSubmitting,isValidating:c.isValidating,submitCount:c.submitCount,initialValues:c.initialValues,values:c.values,handleReset:c.handleReset,resetForm:c.resetForm,setFieldValue:c.setFieldValue})})})}},27939:(e,t,s)=>{"use strict";s.d(t,{A:()=>m});var a=s(80263),r=s(24400),n=s(75232),i=s(90226),l=s(5816),o=s(97600),d=s(52361),c=s(31533),u=s(32267);let h=()=>{let e=(0,r.useRouter)(),{ref:t="default"}=(0,n.g)(),{authenticationSignInProviders:s,authenticationRateLimits:d,authenticationEmails:c,authenticationMultiFactor:h,authenticationAttackProtection:m,authenticationAdvanced:x}=(0,o.x)(["authentication:sign_in_providers","authentication:rate_limits","authentication:emails","authentication:multi_factor","authentication:attack_protection","authentication:advanced"]);(0,l.$E)({projectRef:t});let p=e.pathname.split("/")[4];return(0,a.jsx)(i.l,{page:p,menu:(0,u.B)(t,{authenticationSignInProviders:s,authenticationRateLimits:d,authenticationEmails:c,authenticationMultiFactor:h,authenticationAttackProtection:m,authenticationAdvanced:x}),"data-sentry-element":"ProductMenu","data-sentry-component":"AuthProductMenu","data-sentry-source-file":"AuthLayout.tsx"})},m=(0,d.r)(e=>{let{children:t}=e;return(0,a.jsx)(c.A,{title:"Authentication",product:"Authentication",productMenu:(0,a.jsx)(h,{}),isBlocking:!1,"data-sentry-element":"ProjectLayout","data-sentry-component":"AuthLayout","data-sentry-source-file":"AuthLayout.tsx",children:t})})},31031:(e,t,s)=>{"use strict";s.d(t,{U:()=>d});var a=s(32144),r=s(80251),n=s(73969),i=s(65172),l=s(58982);async function o(e){let{projectRef:t,config:s}=e,{data:a,error:r}=await (0,i.F6)("/platform/auth/{ref}/config",{params:{path:{ref:t}},body:{...s}});return r&&(0,i.H4)(r),a}let d=function(){let{onSuccess:e,onError:t,...s}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},i=(0,a.jE)();return(0,r.n)(e=>o(e),{async onSuccess(t,s,a){let{projectRef:r}=s;await i.invalidateQueries(l.Z.authConfig(r)),await (null==e?void 0:e(t,s,a))},async onError(e,s,a){void 0===t?n.oR.error("Failed to update auth configuration: ".concat(e.message)):t(e,s,a)},...s})}},35358:(e,t,s)=>{"use strict";s.d(t,{j:()=>i});var a=s(80263),r=s(53239),n=s(51500);let i=(0,r.forwardRef)((e,t)=>{let{preTab:s,postTab:r,children:i,className:l,...o}=e;return(0,a.jsxs)("div",{ref:t,...o,className:(0,n.cn)("flex -space-x-px",l),children:[s&&(0,a.jsx)("div",{className:"border border-strong bg-surface-300 rounded-l-md px-3 flex items-center justify-center",children:(0,a.jsx)("span",{className:"text-foreground-lighter text-xs font-mono",children:s})}),(0,a.jsx)("div",{className:(0,n.cn)("flex-1",{"[&_input]:rounded-l-none [&_select]:rounded-l-none [&_textarea]:rounded-l-none":!!s,"[&_input]:rounded-r-none [&_select]:rounded-r-none [&_textarea]:rounded-r-none":!!r}),children:i}),r&&(0,a.jsx)("div",{className:"border border-strong bg-surface-300 rounded-r-md px-3 flex items-center justify-center",children:(0,a.jsx)("span",{className:"text-foreground-lighter text-xs font-mono",children:r})})]})})},43736:(e,t,s)=>{"use strict";s.d(t,{J:()=>r});var a=s(80263);let r=()=>(0,a.jsxs)("div",{className:"flex w-full flex-row items-center justify-between gap-2","data-sentry-component":"HorizontalShimmerWithIcon","data-sentry-source-file":"Shimmers.tsx",children:[(0,a.jsxs)("div",{className:"flex flex-row items-center gap-3",children:[(0,a.jsx)("div",{className:"shimmering-loader h-6 w-6 rounded-full"}),(0,a.jsx)("div",{className:"shimmering-loader h-2 w-32 rounded"})]}),(0,a.jsx)("div",{className:"shimmering-loader h-6 w-20 rounded"})]})},44815:(e,t,s)=>{"use strict";s.d(t,{A:()=>r,M:()=>a});let a=e=>{var t;return!!((null==e?void 0:e.SMTP_ADMIN_EMAIL)&&(null==e?void 0:e.SMTP_SENDER_NAME)&&(null==e?void 0:e.SMTP_USER)&&(null==e?void 0:e.SMTP_HOST)&&(null==e?void 0:e.SMTP_PORT)&&(null!=(t=null==e?void 0:e.SMTP_MAX_FREQUENCY)?t:0)>=0)},r=e=>{var t,s,r,n,i,l,o;return{ENABLE_SMTP:a(e),SMTP_ADMIN_EMAIL:null!=(t=null==e?void 0:e.SMTP_ADMIN_EMAIL)?t:"",SMTP_SENDER_NAME:null!=(s=null==e?void 0:e.SMTP_SENDER_NAME)?s:"",SMTP_USER:null!=(r=null==e?void 0:e.SMTP_USER)?r:"",SMTP_HOST:null!=(n=null==e?void 0:e.SMTP_HOST)?n:"",SMTP_PASS:"",SMTP_PORT:null!=(i=null==e?void 0:e.SMTP_PORT)?i:"465",SMTP_MAX_FREQUENCY:null!=(l=null==e?void 0:e.SMTP_MAX_FREQUENCY)?l:60,RATE_LIMIT_EMAIL_SENT:null!=(o=null==e?void 0:e.RATE_LIMIT_EMAIL_SENT)?o:30}}},50556:(e,t,s)=>{"use strict";s.d(t,{A:()=>c});var a=s(80263),r=s(53239),n=s(1848),i=s(59676),l=s(92777),o=s(70800),d=s(60115);let c=function(e){let{defaultValue:t,descriptionText:s,error:c,icon:u,inputRef:h,label:m,afterLabel:x,beforeLabel:p,labelOptional:f,layout:S,value:g,actions:y,size:j="medium",validation:A,id:_="",name:E="",...v}=e,b=(0,o.A)("inputNumber"),{formContextOnChange:N,values:T,errors:C,handleBlur:M,touched:R,fieldLevelValidation:I}=(0,d.x)();T&&!g&&(g=T[_||E]),c||(C&&!c&&(c=C[_||E]),c=R&&R[_||E]?c:void 0),(0,r.useEffect)(()=>{A&&I(_,A(g))},[]);let w=[b.base];return c&&w.push(b.variants.error),c||w.push(b.variants.standard),u&&w.push(b.with_icon),j&&w.push(b.size[j]),v.disabled&&w.push(b.disabled),(0,a.jsx)("div",{className:v.className,"data-sentry-component":"InputNumber","data-sentry-source-file":"InputNumber.tsx",children:(0,a.jsx)(n.H,{label:m,afterLabel:x,beforeLabel:p,labelOptional:f,layout:S,id:_,error:c,descriptionText:s,style:v.style,size:j,"data-sentry-element":"FormLayout","data-sentry-source-file":"InputNumber.tsx",children:(0,a.jsxs)("div",{className:b.container,children:[(0,a.jsx)("input",{"data-size":j,id:_,name:E,onChange:function(e){v.onChange&&v.onChange(e),N&&N(e),A&&I(_,A(e.target.value))},onBlur:function(e){M&&M(e),v.onBlur&&v.onBlur(e)},type:"number",ref:h,value:g,className:w.join(" "),...v}),u&&(0,a.jsx)(l.A,{size:j,icon:u}),c||y?(0,a.jsxs)("div",{className:b.actions_container,children:[c&&(0,a.jsx)(i.A,{size:j}),y&&y]}):null]})})})}},64511:(e,t,s)=>{"use strict";s.d(t,{t:()=>n});var a=s(17085),r=s(87494);function n(e,t,s){return void 0===t&&(t={}),void 0===s&&(s={}),function(n,i,l){try{return Promise.resolve(function(r,o){try{var d=(t.context,Promise.resolve(e["sync"===s.mode?"validateSync":"validate"](n,Object.assign({abortEarly:!1},t,{context:i}))).then(function(e){return l.shouldUseNativeValidation&&(0,a.w)({},l),{values:s.raw?n:e,errors:{}}}))}catch(e){return o(e)}return d&&d.then?d.then(void 0,o):d}(0,function(e){var t;if(!e.inner)throw e;return{values:{},errors:(0,a.H)((t=!l.shouldUseNativeValidation&&"all"===l.criteriaMode,(e.inner||[]).reduce(function(e,s){if(e[s.path]||(e[s.path]={message:s.message,type:s.type}),t){var a=e[s.path].types,n=a&&a[s.type];e[s.path]=(0,r.Gb)(s.path,t,e,s.type,n?[].concat(n,s.message):s.message)}return e},{})),l)}}))}catch(e){return Promise.reject(e)}}}},71413:(e,t,s)=>{"use strict";s.d(t,{Q:()=>M});var a=s(80263),r=s(32981),n=s(60045),i=s(53239),l=s(87494),o=s(73969),d=s(10663),c=s(75232),u=s(92882),h=s(9759),m=s(98969),x=s(61957),p=s(5816),f=s(31031),S=s(75019),g=s(23385),y=s(63492),j=s(1012),A=s(86254),_=s(47452),E=s(82228),v=s(35358),b=s(93210),N=s(40022),T=s(67258);let C=d.Ik({API_MAX_REQUEST_DURATION:d.au.number().min(5,"Must be 5 or larger").max(30,"Must be a value no greater than 30"),DB_MAX_POOL_SIZE:h.H}),M=()=>{let{ref:e}=(0,c.g)(),{data:t}=(0,g.s)(),{can:s}=(0,S.hl)(n.aG.READ,"custom_config_gotrue"),{can:h}=(0,S.hl)(n.aG.UPDATE,"custom_config_gotrue"),[M,R]=(0,i.useState)(!1),[I,w]=(0,i.useState)(!1),{data:L,error:P,isError:D}=(0,p.op)({projectRef:e}),{mutate:O}=(0,f.U)(),F=(null==t?void 0:t.plan.id)!=="free"&&(null==t?void 0:t.plan.id)!=="pro",U=y.pe&&!F,k=(0,l.mN)({resolver:(0,r.u)(d.Ik({API_MAX_REQUEST_DURATION:C.shape.API_MAX_REQUEST_DURATION})),defaultValues:{API_MAX_REQUEST_DURATION:10}}),B=(0,l.mN)({resolver:(0,r.u)(d.Ik({DB_MAX_POOL_SIZE:C.shape.DB_MAX_POOL_SIZE})),defaultValues:{DB_MAX_POOL_SIZE:""}});return((0,i.useEffect)(()=>{if(L){if(!M){var e;k.reset({API_MAX_REQUEST_DURATION:null!=(e=null==L?void 0:L.API_MAX_REQUEST_DURATION)?e:10})}I||B.reset({DB_MAX_POOL_SIZE:(null==L?void 0:L.DB_MAX_POOL_SIZE)!==null?String(null==L?void 0:L.DB_MAX_POOL_SIZE):""})}},[L,M,I]),D)?(0,a.jsxs)(j.Fc,{variant:"destructive",children:[(0,a.jsx)(A.id,{}),(0,a.jsx)(j.XL,{children:"Failed to retrieve auth configuration"}),(0,a.jsx)(j.TN,{children:P.message})]}):s?(0,a.jsxs)(a.Fragment,{children:[U&&(0,a.jsx)("div",{className:"my-4",children:(0,a.jsx)(x.A,{primaryText:"Upgrade to Team or Enterprise",secondaryText:"Advanced Auth server settings are only available on the Team Plan and up.",buttonText:"Upgrade to Team"})}),(0,a.jsxs)(u.gu,{isFullWidth:!0,"data-sentry-element":"ScaffoldSection","data-sentry-source-file":"AdvancedAuthSettingsForm.tsx",children:[(0,a.jsx)(u.sZ,{className:"mb-4","data-sentry-element":"ScaffoldSectionTitle","data-sentry-source-file":"AdvancedAuthSettingsForm.tsx",children:"Request Duration"}),(0,a.jsx)(_.lV,{...k,"data-sentry-element":"Form_Shadcn_","data-sentry-source-file":"AdvancedAuthSettingsForm.tsx",children:(0,a.jsx)("form",{onSubmit:k.handleSubmit(t=>{if(!e)return console.error("Project ref is required");F&&(R(!0),O({projectRef:e,config:t},{onError:e=>{o.oR.error("Failed to update request duration settings: ".concat(null==e?void 0:e.message)),R(!1)},onSuccess:()=>{o.oR.success("Successfully updated request duration settings"),R(!1)}}))}),className:"space-y-4",children:(0,a.jsxs)(E.Zp,{"data-sentry-element":"Card","data-sentry-source-file":"AdvancedAuthSettingsForm.tsx",children:[(0,a.jsx)(E.Wu,{className:"pt-6","data-sentry-element":"CardContent","data-sentry-source-file":"AdvancedAuthSettingsForm.tsx",children:(0,a.jsx)(_.zB,{control:k.control,name:"API_MAX_REQUEST_DURATION",render:e=>{let{field:t}=e;return(0,a.jsx)(T.M,{layout:"flex-row-reverse",label:"Maximum time allowed for an Auth request to last",description:"Number of seconds to wait for an Auth request to complete before canceling it. In certain high-load situations setting a larger or smaller value can be used to control load-shedding. Recommended: 10 seconds.",children:(0,a.jsx)(_.MJ,{children:(0,a.jsx)("div",{className:"relative",children:(0,a.jsx)(v.j,{postTab:"seconds",children:(0,a.jsx)(b.p,{type:"number",min:5,max:30,...t,disabled:!h||U})})})})})},"data-sentry-element":"FormField_Shadcn_","data-sentry-source-file":"AdvancedAuthSettingsForm.tsx"})}),(0,a.jsxs)(E.wL,{className:"justify-end space-x-2","data-sentry-element":"CardFooter","data-sentry-source-file":"AdvancedAuthSettingsForm.tsx",children:[k.formState.isDirty&&(0,a.jsx)(N.$,{type:"default",onClick:()=>k.reset(),children:"Cancel"}),(0,a.jsx)(N.$,{type:"primary",htmlType:"submit",disabled:!h||M||!k.formState.isDirty||U,loading:M,"data-sentry-element":"Button","data-sentry-source-file":"AdvancedAuthSettingsForm.tsx",children:"Save changes"})]})]})})})]}),(0,a.jsxs)(u.gu,{isFullWidth:!0,"data-sentry-element":"ScaffoldSection","data-sentry-source-file":"AdvancedAuthSettingsForm.tsx",children:[(0,a.jsx)(u.sZ,{className:"mb-4","data-sentry-element":"ScaffoldSectionTitle","data-sentry-source-file":"AdvancedAuthSettingsForm.tsx",children:"Auth Database Connections"}),(0,a.jsx)(_.lV,{...B,"data-sentry-element":"Form_Shadcn_","data-sentry-source-file":"AdvancedAuthSettingsForm.tsx",children:(0,a.jsx)("form",{onSubmit:B.handleSubmit(t=>{if(!e)return console.error("Project ref is required");w(!0),O({projectRef:e,config:{DB_MAX_POOL_SIZE:t.DB_MAX_POOL_SIZE}},{onError:e=>{o.oR.error("Failed to update database connection settings: ".concat(null==e?void 0:e.message)),w(!1)},onSuccess:()=>{o.oR.success("Successfully updated database connection settings"),w(!1)}})}),className:"space-y-4",children:(0,a.jsxs)(E.Zp,{"data-sentry-element":"Card","data-sentry-source-file":"AdvancedAuthSettingsForm.tsx",children:[(0,a.jsx)(E.Wu,{className:"pt-6","data-sentry-element":"CardContent","data-sentry-source-file":"AdvancedAuthSettingsForm.tsx",children:(0,a.jsx)(_.zB,{control:B.control,name:"DB_MAX_POOL_SIZE",render:e=>{let{field:t}=e;return(0,a.jsx)(T.M,{layout:"flex-row-reverse",label:"Max Direct Auth Connections",description:"Auth will take up no more than this number of connections from the total number of available connections to serve requests. These connections are not reserved, so when unused they are released. Defaults to 10 connections.",children:(0,a.jsx)(_.MJ,{children:(0,a.jsx)(b.p,{type:"number",placeholder:"10",...t,disabled:!h||U})})})},"data-sentry-element":"FormField_Shadcn_","data-sentry-source-file":"AdvancedAuthSettingsForm.tsx"})}),(0,a.jsxs)(E.wL,{className:"justify-end space-x-2","data-sentry-element":"CardFooter","data-sentry-source-file":"AdvancedAuthSettingsForm.tsx",children:[B.formState.isDirty&&(0,a.jsx)(N.$,{type:"default",onClick:()=>B.reset(),children:"Cancel"}),(0,a.jsx)(N.$,{type:"primary",htmlType:"submit",disabled:!h||I||!B.formState.isDirty,loading:I,"data-sentry-element":"Button","data-sentry-source-file":"AdvancedAuthSettingsForm.tsx",children:"Save changes"})]})]})})})]})]}):(0,a.jsx)(m.A,{resourceText:"view auth configuration settings"})}},76434:(e,t,s)=>{"use strict";s.d(t,{TV:()=>q,Ur:()=>eo,My:()=>eP,Ut:()=>eX,ni:()=>eq,V:()=>e1,no:()=>e4,C5:()=>tz}),s(71413);var a=s(80263),r=s(23445),n=s(15601),i=s.n(n),l=s(75232),o=s(92882),d=s(53280),c=s(43736),u=s(5816),h=s(1012),m=s(86254),x=s(40022),p=s(73875),f=s(60045),S=s(80903),g=s(32466),y=s(53239),j=s(86953),A=s(73969),_=s(58696),E=s(88602),v=s(62136),b=s(59889),N=s(31031),T=s(67575),C=s(82587),M=s(75019),R=s(63492),I=s(9919),w=s(27642),L=s(95708),P=s(47142),D=s(63490);let O=e=>{let{title:t,isHookSendSMSEnabled:s}=e,{ref:n}=(0,l.g)();switch(t){case"Slack (Deprecated)":return(0,a.jsxs)(h.Fc,{variant:"warning",children:[(0,a.jsx)(m.id,{}),(0,a.jsx)(h.XL,{children:"Slack (Deprecated) Provider"}),(0,a.jsxs)(h.TN,{children:["Recently, Slack has updated their OAuth API. Please use the new Slack (OIDC) provider below. Developers using this provider should move over to the new provider. Please refer to our"," ",(0,a.jsx)("a",{href:"https://supabase.com/docs/guides/auth/social-login/auth-slack",className:"underline",target:"_blank",children:"documentation"})," ","for more details."]})]});case"Phone":return s&&(0,a.jsxs)(h.Fc,{children:[(0,a.jsx)(m.id,{}),(0,a.jsx)(h.XL,{children:"SMS provider settings are disabled while the SMS hook is enabled."}),(0,a.jsxs)(h.TN,{className:"flex flex-col gap-y-3",children:[(0,a.jsx)("p",{children:"The SMS hook will be used in place of the SMS provider configured"}),(0,a.jsx)(x.$,{asChild:!0,type:"default",className:"w-min",icon:(0,a.jsx)(r.A,{}),children:(0,a.jsx)(i(),{href:"/project/".concat(n,"/auth/hooks"),children:"View auth hooks"})})]})]});default:return null}};var F=s(53434),U=s.n(F),k=s(81774),B=s(68690),H=s(36126),W=s(50556),z=s(37394),Y=s(26860);function V(e){return U()(e).format("dddd, MMMM D, YYYY HH:mm:ss Z")}let X=e=>{let{name:t,properties:s,formValues:r,disabled:n=!1,setFieldValue:i}=e,[l,o]=(0,y.useState)(!!s.isSecret),[d,c]=(0,y.useState)(r[t]?V(new Date(r[t])):"");if((0,y.useEffect)(()=>{s.show&&s.show.key&&!r[s.show.key]&&(i(t,""),c(""))},[s.show&&s.show.key&&!r[s.show.key]]),s.show){if(s.show.matches){if(!s.show.matches.includes(r[s.show.key]))return null}else if(!r[s.show.key])return null}switch(s.type){case"datetime":return(0,a.jsx)(L.A,{size:"small",layout:"vertical",id:t,name:t,type:"text",value:d,readOnly:!0,label:s.title,labelOptional:s.descriptionOptional?(0,a.jsx)(j.$,{unwrapDisallowed:!0,disallowedElements:["p"],children:s.descriptionOptional}):null,descriptionText:s.description?(0,a.jsx)(j.$,{unwrapDisallowed:!0,disallowedElements:["p"],children:s.description}):null,actions:(0,a.jsx)(H.l,{selectsRange:!1,minDate:new Date,from:r[t],to:r[t],onChange:e=>{e&&e.to?(i(t,e.to),c(V(new Date(e.to)))):(c(""),i(t,""))},children:(0,a.jsx)("span",{children:"Pick"})})});case"string":return(0,a.jsx)(L.A,{size:"small",layout:"vertical",id:t,name:t,disabled:n,type:l?"password":"text",label:s.title,labelOptional:s.descriptionOptional?(0,a.jsx)(_.o,{content:s.descriptionOptional,className:"text-foreground-lighter"}):null,descriptionText:s.description?(0,a.jsx)(_.o,{content:s.description,className:"text-foreground-lighter"}):null,actions:s.isSecret?(0,a.jsx)(x.$,{icon:l?(0,a.jsx)(k.A,{}):(0,a.jsx)(B.A,{}),type:"default",onClick:()=>o(!l)}):(0,a.jsx)("span",{className:"mr-3 text-foreground-lighter",children:s.units?(0,a.jsx)(j.$,{unwrapDisallowed:!0,disallowedElements:["p"],children:s.units}):null})});case"multiline-string":return(0,a.jsx)(L.A.TextArea,{size:"small",layout:"vertical",id:t,name:t,disabled:n,type:l?"password":"text",label:s.title,labelOptional:s.descriptionOptional?(0,a.jsx)(j.$,{unwrapDisallowed:!0,disallowedElements:["p"],children:s.descriptionOptional}):void 0,descriptionText:s.description?(0,a.jsx)(_.o,{content:s.description,className:"text-foreground-lighter"}):null,actions:s.isSecret?(0,a.jsx)(x.$,{icon:l?(0,a.jsx)(k.A,{}):(0,a.jsx)(B.A,{}),type:"default",onClick:()=>o(!l)}):(0,a.jsx)("span",{className:"mr-3 text-scale-900",children:s.units?(0,a.jsx)(j.$,{unwrapDisallowed:!0,disallowedElements:["p"],children:s.units}):null})});case"number":return(0,a.jsx)(W.A,{size:"small",layout:"vertical",id:t,name:t,disabled:n,label:s.title,labelOptional:s.descriptionOptional?(0,a.jsx)(j.$,{unwrapDisallowed:!0,disallowedElements:["p"],children:s.descriptionOptional}):null,descriptionText:s.description?(0,a.jsx)(_.o,{content:s.description,className:"text-foreground-lighter"}):null,actions:(0,a.jsx)("span",{className:"mr-3 text-foreground-lighter",children:s.units?(0,a.jsx)(j.$,{unwrapDisallowed:!0,disallowedElements:["p"],children:s.units}):null})});case"boolean":return(0,a.jsx)(z.A,{size:"small",id:t,name:t,disabled:n,label:s.title,descriptionText:s.description?(0,a.jsx)(j.$,{unwrapDisallowed:!0,disallowedElements:["p"],className:"form-field-markdown",children:s.description}):null});case"select":return(0,a.jsx)(Y.A,{size:"small",name:t,disabled:n,label:s.title,descriptionText:s.description?(0,a.jsx)(j.$,{unwrapDisallowed:!0,disallowedElements:["p"],className:"form-field-markdown",children:s.description}):null,defaultValue:s.enum[0],children:s.enum.map(e=>(0,a.jsx)(Y.A.Option,{id:e.value,label:e.label,value:e.value,addOnBefore:()=>e.icon?(0,a.jsx)("img",{className:"h-6 w-6",src:"".concat(R.o2,"/img/icons/").concat(e.icon)}):null,children:e.label},e.value))})}return(0,a.jsx)(a.Fragment,{})},G=["SMS_AUTOCONFIRM"],$=e=>{var t,s,r;let{config:n,provider:i,isActive:o}=e,{ref:d}=(0,l.g)(),[c,u]=(0,g.ZA)("provider",{defaultValue:""}),[h,m]=(0,y.useState)(!1),{mutate:p,isLoading:F}=(0,N.U)(),{can:U}=(0,M.hl)(f.aG.UPDATE,"custom_config_gotrue"),k=e=>{let t=n.HOOK_SEND_SMS_ENABLED&&e.startsWith("SMS_")&&!["SMS_AUTOCONFIRM","SMS_OTP_EXP","SMS_OTP_LENGTH","SMS_OTP_LENGTH","SMS_TEMPLATE","SMS_TEST_OTP","SMS_TEST_OTP_VALID_UNTIL"].includes(e);return["EXTERNAL_SLACK_CLIENT_ID","EXTERNAL_SLACK_SECRET"].includes(e)||t},{data:B}=(0,T.G)({projectRef:d}),H=null!=(r=null==B||null==(t=B.app_config)?void 0:t.protocol)?r:"https",W=null==B||null==(s=B.app_config)?void 0:s.endpoint,z="".concat(H,"://").concat(W),{data:Y}=(0,C.A)({projectRef:d}),V=(()=>{let e={};return Object.keys(i.properties).forEach(t=>{let s=G.includes(t);if("SAML 2.0"===i.title){let s=n[t];e[t]=s||"boolean"!==i.properties[t].type&&""}else if(s)e[t]=!n[t];else{let s=n[t];e[t]=s||"boolean"!==i.properties[t].type&&""}}),e})();return(0,y.useEffect)(()=>{m(c.toLowerCase()===i.title.toLowerCase())},[c,i.title]),(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(b.K,{onClick:()=>u(i.title),media:(0,a.jsx)("img",{src:"".concat(R.o2,"/img/icons/").concat(i.misc.iconKey,".svg"),width:18,height:18,alt:"".concat(i.title," auth icon")}),meta:o?(0,a.jsxs)("div",{className:"flex items-center gap-1 rounded-full border border-brand-400 bg-brand-200 py-1 px-1 text-xs text-brand",children:[(0,a.jsx)("span",{className:"rounded-full bg-brand p-0.5 text-xs text-brand-200",children:(0,a.jsx)(S.A,{strokeWidth:2,size:12})}),(0,a.jsx)("span",{className:"px-1",children:"Enabled"})]}):(0,a.jsx)("div",{className:"rounded-md border border-strong bg-surface-100 py-1 px-3 text-xs text-foreground-lighter",children:"Disabled"}),"data-sentry-element":"ResourceItem","data-sentry-source-file":"ProviderForm.tsx",children:i.title}),(0,a.jsx)(I.cj,{open:h,onOpenChange:e=>{e||u(null)},"data-sentry-element":"Sheet","data-sentry-source-file":"ProviderForm.tsx",children:(0,a.jsxs)(I.h,{className:"flex flex-col gap-0","data-sentry-element":"SheetContent","data-sentry-source-file":"ProviderForm.tsx",children:[(0,a.jsxs)(I.Fm,{className:"shrink-0 flex items-center gap-4","data-sentry-element":"SheetHeader","data-sentry-source-file":"ProviderForm.tsx",children:[(0,a.jsx)("img",{src:"".concat(R.o2,"/img/icons/").concat(i.misc.iconKey,".svg"),width:18,height:18,alt:"".concat(i.title," auth icon")}),(0,a.jsx)(I.qp,{"data-sentry-element":"SheetTitle","data-sentry-source-file":"ProviderForm.tsx",children:i.title})]}),(0,a.jsx)(w.A,{id:"provider-".concat(i.title,"-form"),name:"provider-".concat(i.title,"-form"),initialValues:V,validationSchema:i.validationSchema,onSubmit:(e,t)=>{let{resetForm:s}=t,a={...e};Object.keys(e).map(t=>{G.includes(t)&&(a[t]=!e[t]),""===a[t]&&(a[t]=null)}),a.PASSWORD_REQUIRED_CHARACTERS===D.F&&(a.PASSWORD_REQUIRED_CHARACTERS=""),p({projectRef:d,config:a},{onSuccess:()=>{s({values:{...e},initialValues:{...e}}),m(!1),u(null),A.oR.success("Successfully updated settings")}})},className:"flex-1 overflow-hidden flex flex-col","data-sentry-element":"Form","data-sentry-source-file":"ProviderForm.tsx",children:e=>{var t,s,r;let{handleReset:l,initialValues:o,values:d,setFieldValue:c}=e,h=JSON.stringify(o)===JSON.stringify(d);return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)("div",{className:"flex-1 overflow-y-auto group py-6 px-4 md:px-6 text-foreground",children:(0,a.jsxs)("div",{className:"mx-auto max-w-lg space-y-6",children:[(0,a.jsx)(O,{title:i.title,isHookSendSMSEnabled:n.HOOK_SEND_SMS_ENABLED}),Object.keys(i.properties).map(e=>(0,a.jsx)(X,{name:e,setFieldValue:c,properties:i.properties[e],formValues:d,disabled:k(e)||!U},e)),(null==i||null==(t=i.misc)?void 0:t.alert)&&(0,a.jsx)(P.Z,{type:"warning",title:i.misc.alert.title,description:(0,a.jsx)(a.Fragment,{children:(0,a.jsx)(j.$,{children:i.misc.alert.description})})}),i.misc.requiresRedirect&&(0,a.jsx)(L.A,{copy:!0,readOnly:!0,disabled:!0,label:"Callback URL (for OAuth)",value:(null==Y||null==(s=Y.customDomain)?void 0:s.status)==="active"?"https://".concat(null==(r=Y.customDomain)?void 0:r.hostname,"/auth/v1/callback"):"".concat(z,"/auth/v1/callback"),descriptionText:(0,a.jsx)(_.o,{content:i.misc.helper,className:"text-foreground-lighter"})})]})}),(0,a.jsx)(I.XW,{className:"shrink-0",children:(0,a.jsxs)("div",{className:"flex items-center justify-between w-full",children:[(0,a.jsx)(v.A,{href:i.link}),(0,a.jsxs)("div",{className:"flex items-center gap-x-3",children:[(0,a.jsx)(x.$,{type:"default",htmlType:"reset",onClick:()=>{l(),m(!1),u(null)},disabled:F,children:"Cancel"}),(0,a.jsx)(E.G,{htmlType:"submit",loading:F,disabled:F||!U||h,tooltip:{content:{side:"bottom",text:U?void 0:"You need additional permissions to update provider settings"}},children:"Save"})]})]})})]})}})]})})]})},q=()=>{let{ref:e}=(0,l.g)(),{data:t,error:s,isLoading:n,isError:f,isSuccess:S}=(0,u.op)({projectRef:e});return(0,a.jsxs)(o.gu,{isFullWidth:!0,"data-sentry-element":"ScaffoldSection","data-sentry-component":"AuthProvidersForm","data-sentry-source-file":"AuthProvidersForm.tsx",children:[(0,a.jsx)(o.sZ,{"data-sentry-element":"ScaffoldSectionTitle","data-sentry-source-file":"AuthProvidersForm.tsx",children:"Auth Providers"}),(0,a.jsx)(o.aw,{className:"mb-4","data-sentry-element":"ScaffoldSectionDescription","data-sentry-source-file":"AuthProvidersForm.tsx",children:"Authenticate your users through a suite of providers and login methods"}),(0,a.jsxs)("div",{className:"-space-y-px",children:[(null==t?void 0:t.EXTERNAL_EMAIL_ENABLED)&&(null==t?void 0:t.MAILER_OTP_EXP)>3600&&(0,a.jsxs)(h.Fc,{className:"flex w-full items-center justify-between my-3",variant:"warning",children:[(0,a.jsx)(m.id,{}),(0,a.jsxs)("div",{children:[(0,a.jsx)(h.XL,{children:"OTP expiry exceeds recommended threshold"}),(0,a.jsxs)(h.TN,{className:"flex flex-col gap-y-3",children:[(0,a.jsx)("p",{children:"We have detected that you have enabled the email provider with the OTP expiry set to more than an hour. It is recommended to set this value to less than an hour."}),(0,a.jsx)(x.$,{asChild:!0,type:"default",className:"w-min",icon:(0,a.jsx)(r.A,{}),children:(0,a.jsx)(i(),{href:"https://supabase.com/docs/guides/platform/going-into-prod#security",children:"View security recommendations"})})]})]})]}),(0,a.jsxs)(d.j,{"data-sentry-element":"ResourceList","data-sentry-source-file":"AuthProvidersForm.tsx",children:[n&&p.S5.map(e=>(0,a.jsx)("div",{className:"py-4 px-6 border-b last:border-b-none",children:(0,a.jsx)(c.J,{})},"provider_".concat(e.title))),S&&p.S5.map(e=>{let s="Phone"===e.title?{...e,validationSchema:(0,p.y0)(t)}:e,r=!1;return r="SAML 2.0"===s.title?t&&t.SAML_ENABLED:"LinkedIn (OIDC)"===s.title?t&&t.EXTERNAL_LINKEDIN_OIDC_ENABLED:"Slack (OIDC)"===s.title?t&&t.EXTERNAL_SLACK_OIDC_ENABLED:s.title.includes("Web3")?t&&t.EXTERNAL_WEB3_SOLANA_ENABLED:t&&t["EXTERNAL_".concat(s.title.toUpperCase(),"_ENABLED")],(0,a.jsx)($,{config:t,provider:s,isActive:r},"provider_".concat(s.title))}),f&&(0,a.jsxs)(h.Fc,{variant:"destructive",children:[(0,a.jsx)(m.id,{}),(0,a.jsx)(h.XL,{children:"Failed to retrieve auth configuration"}),(0,a.jsx)(h.TN,{children:null==s?void 0:s.message})]})]})]})]})};var J=s(64511),Z=s(87494),K=s(86692),Q=s(12578),ee=s(98969),et=s(97600),es=s(82228),ea=s(47452),er=s(13874),en=s(67258),ei=s(27799);let el=(0,K.Ik)({DISABLE_SIGNUP:(0,K.zM)().required(),EXTERNAL_ANONYMOUS_USERS_ENABLED:(0,K.zM)().required(),SECURITY_MANUAL_LINKING_ENABLED:(0,K.zM)().required(),MAILER_AUTOCONFIRM:(0,K.zM)().required(),SITE_URL:(0,K.Yj)().required("Must have a Site URL")}),eo=()=>{let{ref:e}=(0,l.g)(),t=(0,et.x)("authentication:show_manual_linking"),{data:s,error:n,isError:d,isSuccess:c,isLoading:p}=(0,u.op)({projectRef:e}),{mutate:S,isLoading:g}=(0,N.U)(),{can:j,isSuccess:_}=(0,M.hl)(f.aG.READ,"custom_config_gotrue"),{can:E}=(0,M.hl)(f.aG.UPDATE,"custom_config_gotrue"),v=(0,Z.mN)({resolver:(0,J.t)(el),defaultValues:{DISABLE_SIGNUP:!0,EXTERNAL_ANONYMOUS_USERS_ENABLED:!1,SECURITY_MANUAL_LINKING_ENABLED:!1,MAILER_AUTOCONFIRM:!0,SITE_URL:""}});return(0,y.useEffect)(()=>{s&&v.reset({DISABLE_SIGNUP:!s.DISABLE_SIGNUP,EXTERNAL_ANONYMOUS_USERS_ENABLED:s.EXTERNAL_ANONYMOUS_USERS_ENABLED,SECURITY_MANUAL_LINKING_ENABLED:s.SECURITY_MANUAL_LINKING_ENABLED,MAILER_AUTOCONFIRM:!s.MAILER_AUTOCONFIRM,SITE_URL:s.SITE_URL})},[s]),(0,a.jsxs)(o.gu,{isFullWidth:!0,"data-sentry-element":"ScaffoldSection","data-sentry-component":"BasicAuthSettingsForm","data-sentry-source-file":"BasicAuthSettingsForm.tsx",children:[(0,a.jsx)(o.sZ,{className:"mb-4","data-sentry-element":"ScaffoldSectionTitle","data-sentry-source-file":"BasicAuthSettingsForm.tsx",children:"User Signups"}),d&&(0,a.jsxs)(h.Fc,{variant:"destructive",children:[(0,a.jsx)(m.id,{}),(0,a.jsx)(h.XL,{children:"Failed to retrieve auth configuration"}),(0,a.jsx)(h.TN,{children:n.message})]}),_&&!j&&(0,a.jsx)("div",{className:"mt-8",children:(0,a.jsx)(ee.A,{resourceText:"view auth configuration settings"})}),p&&(0,a.jsxs)(es.Zp,{children:[(0,a.jsx)(es.Wu,{className:"py-6",children:(0,a.jsx)(ei.A,{})}),(0,a.jsx)(es.Wu,{className:"py-6",children:(0,a.jsx)(ei.A,{})}),(0,a.jsx)(es.Wu,{className:"py-6",children:(0,a.jsx)(ei.A,{})}),(0,a.jsx)(es.Wu,{className:"py-7",children:(0,a.jsx)(ei.A,{})}),(0,a.jsx)(es.Wu,{className:"py-7"})]}),c&&(0,a.jsx)(ea.lV,{...v,children:(0,a.jsx)("form",{onSubmit:v.handleSubmit(t=>{let s={...t};s.DISABLE_SIGNUP=!t.DISABLE_SIGNUP,s.PASSWORD_REQUIRED_CHARACTERS===D.F&&(s.PASSWORD_REQUIRED_CHARACTERS=""),s.MAILER_AUTOCONFIRM=!t.MAILER_AUTOCONFIRM,S({projectRef:e,config:s},{onError:e=>{A.oR.error("Failed to update settings: ".concat(null==e?void 0:e.message))},onSuccess:()=>{A.oR.success("Successfully updated settings")}})}),className:"space-y-4",children:(0,a.jsxs)(es.Zp,{children:[(0,a.jsx)(es.Wu,{children:(0,a.jsx)(ea.zB,{control:v.control,name:"DISABLE_SIGNUP",render:e=>{let{field:t}=e;return(0,a.jsx)(en.M,{layout:"flex-row-reverse",label:"Allow new users to sign up",description:"If this is disabled, new users will not be able to sign up to your application",children:(0,a.jsx)(ea.MJ,{children:(0,a.jsx)(er.d,{checked:t.value,onCheckedChange:t.onChange,disabled:!E})})})}})}),t&&(0,a.jsx)(es.Wu,{children:(0,a.jsx)(ea.zB,{control:v.control,name:"SECURITY_MANUAL_LINKING_ENABLED",render:e=>{let{field:t}=e;return(0,a.jsx)(en.M,{layout:"flex-row-reverse",label:"Allow manual linking",description:(0,a.jsxs)(a.Fragment,{children:["Enable"," ",(0,a.jsx)(Q.g,{className:"text-foreground-light hover:text-foreground",href:"https://supabase.com/docs/guides/auth/auth-identity-linking#manual-linking-beta",children:"manual linking APIs"})," ","for your project"]}),children:(0,a.jsx)(ea.MJ,{children:(0,a.jsx)(er.d,{checked:t.value,onCheckedChange:t.onChange,disabled:!E})})})}})}),(0,a.jsxs)(es.Wu,{children:[(0,a.jsx)(ea.zB,{control:v.control,name:"EXTERNAL_ANONYMOUS_USERS_ENABLED",render:e=>{let{field:t}=e;return(0,a.jsx)(en.M,{layout:"flex-row-reverse",label:"Allow anonymous sign-ins",description:(0,a.jsxs)(a.Fragment,{children:["Enable"," ",(0,a.jsx)(Q.g,{className:"text-foreground-light hover:text-foreground",href:"https://supabase.com/docs/guides/auth/auth-anonymous",children:"anonymous sign-ins"})," ","for your project"]}),children:(0,a.jsx)(ea.MJ,{children:(0,a.jsx)(er.d,{checked:t.value,onCheckedChange:t.onChange,disabled:!E})})})}}),v.watch("EXTERNAL_ANONYMOUS_USERS_ENABLED")&&(0,a.jsxs)(h.Fc,{className:"flex w-full items-center justify-between mt-4",variant:"warning",children:[(0,a.jsx)(m.id,{}),(0,a.jsxs)("div",{children:[(0,a.jsxs)(h.XL,{children:["Anonymous users will use the ",(0,a.jsx)("code",{className:"text-xs",children:"authenticated"})," ","role when signing in"]}),(0,a.jsxs)(h.TN,{className:"flex flex-col gap-y-3",children:[(0,a.jsxs)("p",{children:["As a result, anonymous users will be subjected to RLS policies that apply to the ",(0,a.jsx)("code",{className:"text-xs",children:"public"})," and"," ",(0,a.jsx)("code",{className:"text-xs",children:"authenticated"})," roles. We strongly advise"," ",(0,a.jsx)(i(),{href:"/project/".concat(e,"/auth/policies"),className:"text-foreground underline",children:"reviewing your RLS policies"})," ","to ensure that access to your data is restricted where required."]}),(0,a.jsx)(x.$,{asChild:!0,type:"default",className:"w-min",icon:(0,a.jsx)(r.A,{}),children:(0,a.jsx)(i(),{href:"https://supabase.com/docs/guides/auth/auth-anonymous#access-control",children:"View access control docs"})})]})]})]}),!(null==s?void 0:s.SECURITY_CAPTCHA_ENABLED)&&v.watch("EXTERNAL_ANONYMOUS_USERS_ENABLED")&&(0,a.jsxs)(h.Fc,{className:"mt-4",children:[(0,a.jsx)(m.id,{}),(0,a.jsxs)(h.XL,{children:["We highly recommend"," ",(0,a.jsx)(Q.g,{href:"/project/".concat(e,"/auth/protection"),children:"enabling captcha"})," ","for anonymous sign-ins"]}),(0,a.jsx)(h.TN,{children:"This will prevent potential abuse on sign-ins which may bloat your database and incur costs for monthly active users (MAU)"})]})]}),(0,a.jsx)(es.Wu,{children:(0,a.jsx)(ea.zB,{control:v.control,name:"MAILER_AUTOCONFIRM",render:e=>{let{field:t}=e;return(0,a.jsx)(en.M,{layout:"flex-row-reverse",label:"Confirm email",description:"Users will need to confirm their email address before signing in for the first time",children:(0,a.jsx)(ea.MJ,{children:(0,a.jsx)(er.d,{checked:t.value,onCheckedChange:t.onChange,disabled:!E})})})}})}),(0,a.jsxs)(es.wL,{className:"justify-end space-x-2",children:[v.formState.isDirty&&(0,a.jsx)(x.$,{type:"default",onClick:()=>v.reset(),children:"Cancel"}),(0,a.jsx)(x.$,{type:"primary",htmlType:"submit",disabled:!E||g||!v.formState.isDirty,loading:g,children:"Save changes"})]})]})})})]})};var ed=s(20313),ec=s(90437),eu=s(80586);let eh="http://json-schema.org/draft-07/schema#",em={$schema:eh,id:"CONFIRMATION",type:"object",title:"Confirm signup",properties:{MAILER_SUBJECTS_CONFIRMATION:{title:"Subject heading",type:"string"},MAILER_TEMPLATES_CONFIRMATION_CONTENT:{title:"Message body",descriptionOptional:"HTML body of your email",type:"code",description:" \n- `{{ .ConfirmationURL }}` : URL to confirm the e-mail address for the new account\n- `{{ .Token }}` : The 6-digit numeric email OTP \n- `{{ .TokenHash }}` : The hashed token used in the URL\n- `{{ .SiteURL }}` : The URL of the site\n- `{{ .Email }}` : The user's email address\n- `{{ .Data }}` : The user's `user_metadata`\n- `{{ .RedirectTo }}` : The URL of `emailRedirectTo` passed in options\n"}},validationSchema:(0,K.Ik)().shape({MAILER_SUBJECTS_CONFIRMATION:(0,K.Yj)().required('"Subject heading is required.')}),misc:{iconKey:"email-icon2",helper:"To complete setup, add this authorisation callback URL to your app's configuration in the Apple Developer Console.\n            [Learn more](https://supabase.com/docs/guides/auth/social-login/auth-apple#configure-your-services-id)"}},ex={$schema:eh,id:"INVITE",type:"object",title:"Invite user",properties:{MAILER_SUBJECTS_INVITE:{title:"Subject heading",type:"string"},MAILER_TEMPLATES_INVITE_CONTENT:{title:"Message body",descriptionOptional:"HTML body of your email",type:"code",description:" \n- `{{ .ConfirmationURL }}` : URL to accept the invitation to create an account\n- `{{ .Token }}` : The 6-digit numeric email OTP \n- `{{ .TokenHash }}` : The hashed token used in the URL\n- `{{ .SiteURL }}` : The URL of the site\n- `{{ .Email }}` : The user's email address\n- `{{ .Data }}` : The user's `user_metadata`\n- `{{ .RedirectTo }}` : The URL of `redirectTo` passed in options\n"}},validationSchema:(0,K.Ik)().shape({MAILER_SUBJECTS_INVITE:(0,K.Yj)().required('"Subject heading is required.')}),misc:{iconKey:"email-icon2",helper:"To complete setup, add this authorisation callback URL to your app's configuration in the Apple Developer Console.\n            [Learn more](https://supabase.com/docs/guides/auth/social-login/auth-apple#configure-your-services-id)"}},ep={$schema:eh,id:"MAGIC_LINK",type:"object",title:"Magic Link",properties:{MAILER_SUBJECTS_MAGIC_LINK:{title:"Subject heading",type:"string"},MAILER_TEMPLATES_MAGIC_LINK_CONTENT:{title:"Message body",descriptionOptional:"HTML body of your email",type:"code",description:" \n- `{{ .ConfirmationURL }}` : URL for a one-time login to the user's account\n- `{{ .Token }}` : The 6-digit numeric email OTP \n- `{{ .TokenHash }}` : The hashed token used in the URL\n- `{{ .SiteURL }}` : The URL of the site\n- `{{ .Email }}` : The user's email address\n- `{{ .Data }}` : The user's `user_metadata`\n- `{{ .RedirectTo }}` : The URL of `emailRedirectTo` passed in options\n"}},validationSchema:(0,K.Ik)().shape({MAILER_SUBJECTS_MAGIC_LINK:(0,K.Yj)().required('"Subject heading is required.')}),misc:{iconKey:"email-icon2",helper:"To complete setup, add this authorisation callback URL to your app's configuration in the Apple Developer Console.\n            [Learn more](https://supabase.com/docs/guides/auth/social-login/auth-apple#configure-your-services-id)"}},ef={$schema:eh,id:"EMAIL_CHANGE",type:"object",title:"Change Email Address",properties:{MAILER_SUBJECTS_EMAIL_CHANGE:{title:"Subject heading",type:"string"},MAILER_TEMPLATES_EMAIL_CHANGE_CONTENT:{title:"Message body",descriptionOptional:"HTML body of your email",type:"code",description:" \n- `{{ .ConfirmationURL }}` : URL to confirm the email change\n- `{{ .Token }}` : The 6-digit numeric email OTP \n- `{{ .TokenHash }}` : The hashed token used in the URL\n- `{{ .SiteURL }}` : The URL of the site\n- `{{ .Email }}` : The original user's email address\n- `{{ .NewEmail }}` : The user's new email address\n- `{{ .Data }}` : The user's `user_metadata`\n- `{{ .RedirectTo }}` : The URL of `emailRedirectTo` passed in options\n"}},validationSchema:(0,K.Ik)().shape({MAILER_SUBJECTS_EMAIL_CHANGE:(0,K.Yj)().required('"Subject heading is required.')}),misc:{iconKey:"email-icon2",helper:"To complete setup, add this authorisation callback URL to your app's configuration in the Apple Developer Console.\n            [Learn more](https://supabase.com/docs/guides/auth/social-login/auth-apple#configure-your-services-id)"}},eS=[em,ex,ep,ef,{$schema:eh,id:"RECOVERY",type:"object",title:"Reset Password",properties:{MAILER_SUBJECTS_RECOVERY:{title:"Subject heading",type:"string"},MAILER_TEMPLATES_RECOVERY_CONTENT:{title:"Message body",descriptionOptional:"HTML body of your email",type:"code",description:" \n- `{{ .ConfirmationURL }}` : URL to confirm the password reset\n- `{{ .Token }}` : The 6-digit numeric email OTP \n- `{{ .TokenHash }}` : The hashed token used in the URL\n- `{{ .SiteURL }}` : The URL of the site\n- `{{ .Email }}` : The user's email address\n- `{{ .Data }}` : The user's `user_metadata`\n- `{{ .RedirectTo }}` : The URL of `redirectTo` passed in options\n"}},validationSchema:(0,K.Ik)().shape({MAILER_SUBJECTS_RECOVERY:(0,K.Yj)().required('"Subject heading is required.')}),misc:{iconKey:"email-icon2",helper:"To complete setup, add this authorisation callback URL to your app's configuration in the Apple Developer Console.\n            [Learn more](https://supabase.com/docs/guides/auth/social-login/auth-apple#configure-your-services-id)"}},{$schema:eh,id:"REAUTHENTICATION",type:"object",title:"Reauthentication",properties:{MAILER_SUBJECTS_REAUTHENTICATION:{title:"Subject heading",type:"string"},MAILER_TEMPLATES_REAUTHENTICATION_CONTENT:{title:"Message body",descriptionOptional:"HTML body of your email",type:"code",description:"\n- `{{ .Token }}` : The 6-digit numeric email OTP\n- `{{ .SiteURL }}` : The URL of the site\n- `{{ .Email }}` : The user's email address\n- `{{ .Data }}` : The user's `user_metadata`\n"}},validationSchema:(0,K.Ik)().shape({MAILER_SUBJECTS_REAUTHENTICATION:(0,K.Yj)().required('"Subject heading is required.')}),misc:{iconKey:"email-icon2",helper:"To complete setup, add this authorisation callback URL to your app's configuration in the Apple Developer Console.\n            [Learn more](https://supabase.com/docs/guides/auth/social-login/auth-apple#configure-your-services-id)"}}],eg=function(){let{ref:e}=(0,l.g)();return(0,a.jsxs)(h.Fc,{variant:"warning","data-sentry-element":"Alert_Shadcn_","data-sentry-component":"EmailRateLimitsAlert","data-sentry-source-file":"EmailRateLimitsAlert.tsx",children:[(0,a.jsx)(m.id,{"data-sentry-element":"WarningIcon","data-sentry-source-file":"EmailRateLimitsAlert.tsx"}),(0,a.jsx)(h.XL,{"data-sentry-element":"AlertTitle_Shadcn_","data-sentry-source-file":"EmailRateLimitsAlert.tsx",children:"Email rate-limits and restrictions"}),(0,a.jsxs)(h.TN,{"data-sentry-element":"AlertDescription_Shadcn_","data-sentry-source-file":"EmailRateLimitsAlert.tsx",children:["You're using the built-in email service. The service has rate limits and it's not meant to be used for production apps. Check the"," ",(0,a.jsx)(Q.g,{href:"https://supabase.com/docs/guides/platform/going-into-prod#auth-rate-limits","data-sentry-element":"InlineLink","data-sentry-source-file":"EmailRateLimitsAlert.tsx",children:"documentation"})," ","for an up-to-date information on the current rate limits."]}),(0,a.jsx)(h.TN,{className:"mt-2","data-sentry-element":"AlertDescription_Shadcn_","data-sentry-source-file":"EmailRateLimitsAlert.tsx",children:(0,a.jsx)(x.$,{asChild:!0,type:"default","data-sentry-element":"Button","data-sentry-source-file":"EmailRateLimitsAlert.tsx",children:(0,a.jsx)(i(),{href:"/project/".concat(e,"/auth/smtp"),"data-sentry-element":"Link","data-sentry-source-file":"EmailRateLimitsAlert.tsx",children:"Set up custom SMTP server"})})})]})};var ey=s(72852),ej=s(96821),eA=s(82143),e_=s(80251),eE=s(65172);async function ev(e){let{projectRef:t,template:s}=e,{data:a,error:r}=await (0,eE.bE)("/platform/auth/{ref}/validate/spam",{params:{path:{ref:t}},body:s});return r&&(0,eE.H4)(r),a}let eb=function(){let{onSuccess:e,onError:t,...s}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return(0,e_.n)(e=>ev(e),{async onSuccess(t,s,a){await (null==e?void 0:e(t,s,a))},async onError(e,s,a){void 0===t?A.oR.error("Failed to validate template: ".concat(e.message)):t(e,s,a)},...s})};var eN=s(93210),eT=s(19428),eC=s(30435);let eM=(0,s(15740).A)("MailWarning",[["path",{d:"M22 10.5V6a2 2 0 0 0-2-2H4a2 2 0 0 0-2 2v12c0 1.1.9 2 2 2h12.5",key:"e61zoh"}],["path",{d:"m22 7-8.97 5.7a1.94 1.94 0 0 1-2.06 0L2 7",key:"1ocrg3"}],["path",{d:"M20 14v4",key:"1hm744"}],["path",{d:"M20 22v.01",key:"12bgn6"}]]);var eR=s(3434),eI=s(77635);let ew=e=>{var t;let{validationResult:s}=e,r=(null!=(t=null==s?void 0:s.rules)?t:[]).filter(e=>e.score>=0),n=r.length>0;return(0,a.jsxs)("div",{className:"flex items-start gap-2","data-sentry-component":"SpamValidation","data-sentry-source-file":"SpamValidation.tsx",children:[(0,a.jsx)("div",{className:"mt-0.5",children:n?(0,a.jsx)(eM,{size:16,strokeWidth:1.5,className:"text-warning"}):(0,a.jsx)(S.A,{size:16,strokeWidth:1.5,className:"text-brand"})}),(0,a.jsxs)("div",{className:"flex flex-col gap-2",children:[(0,a.jsx)("h5",{children:n?"Email has a high probability of being marked as spam - review issues below to improve deliverability.":"Email content is unlikely to be marked as spam"}),n&&(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)("div",{className:"flex flex-col gap-y-3",children:(0,a.jsxs)(eR.XI,{children:[(0,a.jsx)(eR.A0,{className:"font-mono uppercase text-xs [&_th]:h-auto [&_th]:py-2",children:(0,a.jsxs)(eR.Hj,{className:"hover:bg-transparent",children:[(0,a.jsx)(eR.nd,{className:"pl-0",children:"Warning"}),(0,a.jsx)(eR.nd,{className:"pr-0",children:"Description"})]})}),(0,a.jsx)(eR.BF,{children:r.map(e=>(0,a.jsxs)(eR.Hj,{className:"hover:bg-transparent",children:[(0,a.jsx)(eR.nA,{className:"pl-0 font-mono text-xs text-foreground",children:e.name}),(0,a.jsx)(eR.nA,{className:"pr-0",children:e.desc})]},e.name))})]})}),(0,a.jsx)(eI.w,{}),(0,a.jsx)(_.o,{className:"!max-w-none text-foreground-muted text-xs [&_a]:text-foreground-lighter mt-2",content:"Spam validation is powered by [SpamAssassin](https://spamassassin.apache.org/doc.html). Full list of all available warnings can be found [here](https://gist.github.com/ychaouche/a2faff159c2a1fea16019156972c7f8b)."})]})]})]})},eL=e=>{var t,s,r;let{template:n}=e,{ref:i}=(0,l.g)(),{can:o}=(0,M.hl)(f.aG.UPDATE,"custom_config_gotrue"),d=(0,y.useRef)(),{data:c,isSuccess:h}=(0,u.op)({projectRef:i}),{mutate:m}=eb({onSuccess:e=>T(e)}),{mutate:p}=(0,N.U)({onError:e=>{D(!1),A.oR.error("Failed to update email templates: ".concat(e.message))}}),{id:S,properties:g}=n,_="MAILER_TEMPLATES_".concat(S,"_CONTENT"),E=g[_],v=h&&c&&(!c.SMTP_HOST||!c.SMTP_USER||!c.SMTP_PASS),[b,T]=(0,y.useState)(),[C,R]=(0,y.useState)(null!=(t=c&&c[_])?t:""),[I,w]=(0,y.useState)(!1),[L,D]=(0,y.useState)(!1),O=(null!=(s=null==b?void 0:b.rules)?s:[]).filter(e=>e.score>0),F=v&&O.length>0,U=(0,y.useMemo)(()=>{let e={};return Object.keys(g).forEach(t=>{var s;e[t]=null!=(s=c&&c[t])?s:""}),e},[c,g]),k=(0,Z.mN)({defaultValues:U});(0,y.useEffect)(()=>{if(c){var e;let t={};Object.keys(g).forEach(e=>{var s;t[e]=null!=(s=c&&c[e])?s:""}),k.reset(t),R(null!=(e=c&&c[_])?e:"")}},[c,g,_,k]),(0,y.useEffect)(()=>{let e=e=>{I&&(e.preventDefault(),e.returnValue="")};return window.addEventListener("beforeunload",e),()=>{window.removeEventListener("beforeunload",e)}},[I]),(0,y.useEffect)(()=>{if(i&&S&&c){let[e]=Object.keys(g);m({projectRef:i,template:{subject:c[e],content:c[_]}})}},[S]);let B=(0,y.useMemo)(()=>{if(!(null==E?void 0:E.description))return[];let e=E.description.split("\n"),t=[];for(let s of e){let e=s.match(/-\s*`?({{\s*\.\w+\s*}})`?\s*(?::|-)?\s*(.+)/);e&&e[1]&&e[2]&&t.push({variable:e[1].replace(/`/g,"").trim(),description:e[2].trim()})}return t},[null==E?void 0:E.description]),H=JSON.stringify(k.watch())!==JSON.stringify(U)||(null!=(r=c&&c[_])?r:"")!==C,W=e=>{if(!d.current)return;let t=d.current,s=t.getSelection();if(s){let a={startLineNumber:s.startLineNumber,startColumn:s.startColumn,endLineNumber:s.endLineNumber,endColumn:s.endColumn};t.executeEdits("insert-variable",[{range:a,text:e,forceMoveMarkers:!0}]),t.focus()}};return(0,a.jsx)(ea.lV,{...k,"data-sentry-element":"Form_Shadcn_","data-sentry-component":"TemplateEditor","data-sentry-source-file":"TemplateEditor.tsx",children:(0,a.jsxs)("form",{onSubmit:k.handleSubmit(e=>{if(!i)return console.error("Project ref is required");D(!0);let t={...e};delete t[_],E&&(t[_]=C);let[s]=Object.keys(g);m({projectRef:i,template:{subject:t[s],content:t[_]}},{onSuccess:e=>{var s;let a=(null!=(s=null==e?void 0:e.rules)?s:[]).filter(e=>e.score>0);v&&a.length>0?(D(!1),A.oR.error("Please rectify all spam warnings before saving while using the built-in email service")):p({projectRef:i,config:t},{onSuccess:()=>{D(!1),A.oR.success("Successfully updated settings"),w(!1)}})},onError:()=>D(!1)})}),children:[(0,a.jsx)(es.Wu,{"data-sentry-element":"CardContent","data-sentry-source-file":"TemplateEditor.tsx",children:Object.keys(g).map(e=>{let t=g[e];return"string"===t.type&&e!==_?(0,a.jsx)(ea.zB,{control:k.control,name:e,render:s=>{let{field:r}=s;return(0,a.jsx)(en.M,{label:t.title,description:t.description?(0,a.jsx)(j.$,{unwrapDisallowed:!0,disallowedElements:["p"],children:t.description}):null,labelOptional:t.descriptionOptional?(0,a.jsx)(j.$,{unwrapDisallowed:!0,disallowedElements:["p"],children:t.descriptionOptional}):null,children:(0,a.jsx)(ea.MJ,{children:(0,a.jsx)(eN.p,{id:e,...r,disabled:!o})})})}},e):null})}),E&&(0,a.jsxs)(a.Fragment,{children:[(0,a.jsxs)(es.Wu,{className:"p-0",children:[(0,a.jsx)(eT.J,{className:"p-6 pb-4 block",children:"Message body"}),(0,a.jsxs)(eu.tU,{defaultValue:"source",children:[(0,a.jsxs)(eu.j7,{className:"gap-3 px-6",children:[(0,a.jsxs)(eu.Xi,{value:"source",className:"gap-2",children:[(0,a.jsx)(ey.A,{size:14}),"Source"]}),(0,a.jsxs)(eu.Xi,{value:"preview",className:"gap-2",children:[(0,a.jsx)(ej.A,{size:14}),"Preview"]})]}),(0,a.jsxs)(eu.av,{value:"source",className:"p-0 mt-0",children:[(0,a.jsx)(eA.A,{id:"code-id",language:"html",isReadOnly:!o,className:"!mb-0 relative h-96 overflow-hidden p-0",onInputChange:e=>{R(null!=e?e:""),C!==e&&w(!0)},options:{wordWrap:"on",contextmenu:!1,padding:{top:16}},value:C,editorRef:d}),B.length>0&&(0,a.jsx)("div",{className:"px-6 py-3 border-t bg-surface-200",children:(0,a.jsx)("div",{className:"flex flex-wrap gap-1",children:B.map(e=>{let{variable:t,description:s}=e;return(0,a.jsxs)(eC.m_,{children:[(0,a.jsx)(eC.k$,{asChild:!0,children:(0,a.jsx)(x.$,{type:"outline",size:"tiny",className:"rounded-full",onClick:()=>W(t),children:t})}),(0,a.jsx)(eC.ZI,{side:"top",children:(0,a.jsx)("p",{children:s||"Variable description not available"})})]},t)})})})]}),(0,a.jsxs)(eu.av,{value:"preview",className:"pt-0 mt-0",children:[(0,a.jsx)("iframe",{className:"!mb-0 mt-0 overflow-hidden h-96 w-full",title:S,srcDoc:C,sandbox:"allow-scripts allow-forms"}),(0,a.jsx)(P.Z,{type:"default",title:"The preview may differ slightly from the actual rendering in the email client",className:"rounded-none border-0 mb-0"})]})]})]}),(0,a.jsx)(es.Wu,{children:(0,a.jsx)(ew,{validationResult:b})}),(0,a.jsxs)(es.wL,{className:"justify-end space-x-2",children:[H&&(0,a.jsx)(x.$,{type:"default",onClick:()=>{var e;k.reset(U),R(null!=(e=c&&c[_])?e:""),w(!1)},children:"Cancel"}),(0,a.jsx)(x.$,{type:"primary",htmlType:"submit",disabled:!o||L||!H||F,loading:L,children:"Save changes"})]})]})]})})},eP=()=>{let{ref:e}=(0,l.g)(),{data:t,error:s,isLoading:r,isError:n,isSuccess:i}=(0,u.op)({projectRef:e}),o=i&&t&&(!t.SMTP_HOST||!t.SMTP_USER||!t.SMTP_PASS);return(0,a.jsxs)("div",{className:"w-full","data-sentry-component":"EmailTemplates","data-sentry-source-file":"EmailTemplates.tsx",children:[n&&(0,a.jsx)(ed.A,{error:s,subject:"Failed to retrieve auth configuration"}),r&&(0,a.jsx)("div",{className:"w-[854px] mt-12",children:(0,a.jsx)(ec.y,{})}),i&&(0,a.jsxs)("div",{className:"my-12",children:[o?(0,a.jsx)("div",{className:"mb-4",children:(0,a.jsx)(eg,{})}):null,(0,a.jsx)(es.Zp,{children:(0,a.jsxs)(eu.tU,{defaultValue:eS[0].title.trim().replace(/\s+/g,"-"),children:[(0,a.jsx)(eu.j7,{className:"pt-2 px-6 gap-5 mb-0 overflow-x-scroll no-scrollbar mb-4",children:eS.map(e=>(0,a.jsx)(eu.Xi,{value:e.title.trim().replace(/\s+/g,"-"),children:e.title},"".concat(e.id)))}),eS.map(e=>{let t=e.title.trim().replace(/\s+/g,"-");return(0,a.jsx)(eu.av,{value:t,className:"mt-0",children:(0,a.jsx)(eL,{template:e},e.title)},t)})]})})]})]})};var eD=s(61957),eO=s(23385),eF=s(40990),eU=s(35358),ek=s(50204);function eB(e,t){return e?t?"Enabled":"Verify Enabled":"Disabled"}let eH=[{label:"Enabled",value:"Enabled"},{label:"Verify Enabled",value:"Verify Enabled"},{label:"Disabled",value:"Disabled"}],eW=e=>"Enabled"===e?{verifyEnabled:!0,enrollEnabled:!0}:"Verify Enabled"===e?{verifyEnabled:!0,enrollEnabled:!1}:{verifyEnabled:!1,enrollEnabled:!1},ez=(0,K.Ik)({MFA_TOTP:(0,K.Yj)().required(),MFA_MAX_ENROLLED_FACTORS:(0,K.ai)().min(0,"Must be a value 0 or larger").max(30,"Must be a value no greater than 30")}),eY=(0,K.Ik)({MFA_PHONE:(0,K.Yj)().required(),MFA_PHONE_OTP_LENGTH:(0,K.ai)().min(6,"Must be a value 6 or larger").max(30,"must be a value no greater than 30"),MFA_PHONE_TEMPLATE:(0,K.Yj)().required("SMS template is required.")}),eV=(0,K.Ik)({MFA_ALLOW_LOW_AAL:(0,K.zM)().required()}),eX=()=>{var e;let{ref:t}=(0,l.g)(),{data:s,error:r,isError:n}=(0,u.op)({projectRef:t}),{mutate:i}=(0,N.U)(),[d,c]=(0,y.useState)(!1),[p,S]=(0,y.useState)(!1),[g,j]=(0,y.useState)(!1),[_,E]=(0,y.useState)(!1),{can:v}=(0,M.hl)(f.aG.READ,"custom_config_gotrue"),{can:b}=(0,M.hl)(f.aG.UPDATE,"custom_config_gotrue"),{data:T}=(0,eO.s)(),C=(null==T||null==(e=T.plan)?void 0:e.id)!=="free",I=R.pe&&!C,w=(null==s?void 0:s.HOOK_SEND_SMS_URI)!==null&&(null==s?void 0:s.HOOK_SEND_SMS_ENABLED)===!0,L=(null==s?void 0:s.EXTERNAL_PHONE_ENABLED)===!0,P=(0,Z.mN)({resolver:(0,J.t)(ez),defaultValues:{MFA_TOTP:"Enabled",MFA_MAX_ENROLLED_FACTORS:10}}),D=(0,Z.mN)({resolver:(0,J.t)(eY),defaultValues:{MFA_PHONE:"Disabled",MFA_PHONE_OTP_LENGTH:6,MFA_PHONE_TEMPLATE:"Your code is {{ .Code }}"}}),O=(0,Z.mN)({resolver:(0,J.t)(eV),defaultValues:{MFA_ALLOW_LOW_AAL:!1}});(0,y.useEffect)(()=>{if(s){var e,t,a,r;d||P.reset({MFA_TOTP:eB(null==(e=null==s?void 0:s.MFA_TOTP_VERIFY_ENABLED)||e,null==(t=null==s?void 0:s.MFA_TOTP_ENROLL_ENABLED)||t)||"Enabled",MFA_MAX_ENROLLED_FACTORS:null!=(a=null==s?void 0:s.MFA_MAX_ENROLLED_FACTORS)?a:10}),p||D.reset({MFA_PHONE:eB((null==s?void 0:s.MFA_PHONE_VERIFY_ENABLED)||!1,(null==s?void 0:s.MFA_PHONE_ENROLL_ENABLED)||!1)||"Disabled",MFA_PHONE_OTP_LENGTH:(null==s?void 0:s.MFA_PHONE_OTP_LENGTH)||6,MFA_PHONE_TEMPLATE:(null==s?void 0:s.MFA_PHONE_TEMPLATE)||"Your code is {{ .Code }}"}),g||O.reset({MFA_ALLOW_LOW_AAL:null==(r=null==s?void 0:s.MFA_ALLOW_LOW_AAL)||r})}},[s,d,p,g]);let F=e=>{let s={...e};if(C){let{verifyEnabled:t,enrollEnabled:a}=eW(e.MFA_PHONE);s={...s,MFA_PHONE_ENROLL_ENABLED:a,MFA_PHONE_VERIFY_ENABLED:t}}delete s.MFA_PHONE,S(!0),i({projectRef:t,config:s},{onError:e=>{A.oR.error("Failed to update phone MFA settings: ".concat(null==e?void 0:e.message)),S(!1)},onSuccess:()=>{A.oR.success("Successfully updated phone MFA settings"),S(!1)}})};if(n)return(0,a.jsxs)(h.Fc,{variant:"destructive",children:[(0,a.jsx)(m.id,{}),(0,a.jsx)(h.XL,{children:"Failed to retrieve auth configuration"}),(0,a.jsx)(h.TN,{children:r.message})]});if(!v)return(0,a.jsx)(ee.A,{resourceText:"view auth configuration settings"});let U="Enabled"===D.watch("MFA_PHONE")||"Verify Enabled"===D.watch("MFA_PHONE"),k=s&&!s.MFA_PHONE_VERIFY_ENABLED&&U,B=()=>{k?E(!0):D.handleSubmit(F)()};return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsxs)(o.gu,{isFullWidth:!0,"data-sentry-element":"ScaffoldSection","data-sentry-source-file":"MfaAuthSettingsForm.tsx",children:[(0,a.jsx)(o.sZ,{className:"mb-4","data-sentry-element":"ScaffoldSectionTitle","data-sentry-source-file":"MfaAuthSettingsForm.tsx",children:"Multi-Factor Authentication (MFA)"}),(0,a.jsx)(ea.lV,{...P,"data-sentry-element":"Form_Shadcn_","data-sentry-source-file":"MfaAuthSettingsForm.tsx",children:(0,a.jsx)("form",{onSubmit:P.handleSubmit(e=>{let{verifyEnabled:s,enrollEnabled:a}=eW(e.MFA_TOTP),r={...e,MFA_TOTP_ENROLL_ENABLED:a,MFA_TOTP_VERIFY_ENABLED:s};delete r.MFA_TOTP,c(!0),i({projectRef:t,config:r},{onError:e=>{A.oR.error("Failed to update TOTP settings: ".concat(null==e?void 0:e.message)),c(!1)},onSuccess:()=>{A.oR.success("Successfully updated TOTP settings"),c(!1)}})}),className:"space-y-4",children:(0,a.jsxs)(es.Zp,{"data-sentry-element":"Card","data-sentry-source-file":"MfaAuthSettingsForm.tsx",children:[(0,a.jsx)(es.Wu,{className:"pt-6","data-sentry-element":"CardContent","data-sentry-source-file":"MfaAuthSettingsForm.tsx",children:(0,a.jsx)(ea.zB,{control:P.control,name:"MFA_TOTP",render:e=>{let{field:t}=e;return(0,a.jsx)(en.M,{layout:"flex-row-reverse",label:"TOTP (App Authenticator)",description:"Control use of TOTP (App Authenticator) factors",children:(0,a.jsx)(ea.MJ,{children:(0,a.jsxs)(eF.l6,{value:t.value,onValueChange:t.onChange,disabled:!b,children:[(0,a.jsx)(eF.bq,{children:(0,a.jsx)(eF.yv,{placeholder:"Select status"})}),(0,a.jsx)(eF.gC,{children:eH.map(e=>(0,a.jsx)(eF.eb,{value:e.value,children:e.label},e.value))})]})})})},"data-sentry-element":"FormField_Shadcn_","data-sentry-source-file":"MfaAuthSettingsForm.tsx"})}),(0,a.jsx)(es.Wu,{"data-sentry-element":"CardContent","data-sentry-source-file":"MfaAuthSettingsForm.tsx",children:(0,a.jsx)(ea.zB,{control:P.control,name:"MFA_MAX_ENROLLED_FACTORS",render:e=>{let{field:t}=e;return(0,a.jsx)(en.M,{layout:"flex-row-reverse",label:"Maximum number of per-user MFA factors",description:"How many MFA factors can be enrolled at once per user.",children:(0,a.jsx)(ea.MJ,{children:(0,a.jsx)(eU.j,{postTab:"factors",children:(0,a.jsx)(eN.p,{type:"number",min:0,max:30,...t,disabled:!b})})})})},"data-sentry-element":"FormField_Shadcn_","data-sentry-source-file":"MfaAuthSettingsForm.tsx"})}),(0,a.jsxs)(es.wL,{className:"justify-end space-x-2","data-sentry-element":"CardFooter","data-sentry-source-file":"MfaAuthSettingsForm.tsx",children:[P.formState.isDirty&&(0,a.jsx)(x.$,{type:"default",onClick:()=>P.reset(),children:"Cancel"}),(0,a.jsx)(x.$,{type:"primary",htmlType:"submit",disabled:!b||d||!P.formState.isDirty,loading:d,"data-sentry-element":"Button","data-sentry-source-file":"MfaAuthSettingsForm.tsx",children:"Save changes"})]})]})})})]}),(0,a.jsxs)(o.gu,{isFullWidth:!0,"data-sentry-element":"ScaffoldSection","data-sentry-source-file":"MfaAuthSettingsForm.tsx",children:[(0,a.jsx)(o.sZ,{className:"mb-4","data-sentry-element":"ScaffoldSectionTitle","data-sentry-source-file":"MfaAuthSettingsForm.tsx",children:"SMS MFA"}),(0,a.jsx)(ea.lV,{...D,"data-sentry-element":"Form_Shadcn_","data-sentry-source-file":"MfaAuthSettingsForm.tsx",children:(0,a.jsx)("form",{onSubmit:e=>{e.preventDefault(),B()},className:"space-y-4",children:(0,a.jsxs)(es.Zp,{"data-sentry-element":"Card","data-sentry-source-file":"MfaAuthSettingsForm.tsx",children:[(0,a.jsxs)(es.Wu,{className:"pt-6","data-sentry-element":"CardContent","data-sentry-source-file":"MfaAuthSettingsForm.tsx",children:[I&&(0,a.jsx)("div",{className:"mb-4",children:(0,a.jsx)(eD.A,{primaryText:"Upgrade to Pro",secondaryText:"Advanced MFA requires the Pro Plan"})}),(0,a.jsx)(ea.zB,{control:D.control,name:"MFA_PHONE",render:e=>{let{field:t}=e;return(0,a.jsx)(en.M,{layout:"flex-row-reverse",label:"Phone",description:"Control use of phone factors",children:(0,a.jsx)(ea.MJ,{children:(0,a.jsxs)(eF.l6,{value:t.value,onValueChange:t.onChange,disabled:!b||!C,children:[(0,a.jsx)(eF.bq,{children:(0,a.jsx)(eF.yv,{placeholder:"Select status"})}),(0,a.jsx)(eF.gC,{children:eH.map(e=>(0,a.jsx)(eF.eb,{value:e.value,children:e.label},e.value))})]})})})},"data-sentry-element":"FormField_Shadcn_","data-sentry-source-file":"MfaAuthSettingsForm.tsx"}),!(L||w)&&U&&(0,a.jsxs)(h.Fc,{variant:"warning",className:"mt-3",children:[(0,a.jsx)(m.id,{}),(0,a.jsx)(h.XL,{children:"To use MFA with Phone you should set up a Phone provider or Send SMS Hook."})]})]}),(0,a.jsx)(es.Wu,{"data-sentry-element":"CardContent","data-sentry-source-file":"MfaAuthSettingsForm.tsx",children:(0,a.jsx)(ea.zB,{control:D.control,name:"MFA_PHONE_OTP_LENGTH",render:e=>{let{field:t}=e;return(0,a.jsx)(en.M,{layout:"flex-row-reverse",label:"Phone OTP Length",description:"Number of digits in OTP",children:(0,a.jsx)(ea.MJ,{children:(0,a.jsx)(eN.p,{type:"number",min:6,max:30,...t,disabled:!b||!C})})})},"data-sentry-element":"FormField_Shadcn_","data-sentry-source-file":"MfaAuthSettingsForm.tsx"})}),(0,a.jsx)(es.Wu,{"data-sentry-element":"CardContent","data-sentry-source-file":"MfaAuthSettingsForm.tsx",children:(0,a.jsx)(ea.zB,{control:D.control,name:"MFA_PHONE_TEMPLATE",render:e=>{let{field:t}=e;return(0,a.jsx)(en.M,{layout:"flex-row-reverse",label:"Phone verification message",description:"To format the OTP code use `{{ .Code }}`",children:(0,a.jsx)(ea.MJ,{children:(0,a.jsx)(eN.p,{type:"text",...t,disabled:!b||!C})})})},"data-sentry-element":"FormField_Shadcn_","data-sentry-source-file":"MfaAuthSettingsForm.tsx"})}),(0,a.jsxs)(es.wL,{className:"justify-end space-x-2","data-sentry-element":"CardFooter","data-sentry-source-file":"MfaAuthSettingsForm.tsx",children:[D.formState.isDirty&&(0,a.jsx)(x.$,{type:"default",onClick:()=>D.reset(),children:"Cancel"}),(0,a.jsx)(x.$,{type:"primary",htmlType:"submit",disabled:!b||p||!D.formState.isDirty||!C,loading:p,"data-sentry-element":"Button","data-sentry-source-file":"MfaAuthSettingsForm.tsx",children:"Save changes"})]})]})})})]}),(0,a.jsxs)(ek.A,{visible:_,title:"Confirm SMS MFA",confirmLabel:"Confirm and save",onCancel:()=>E(!1),onConfirm:()=>{E(!1),D.handleSubmit(F)()},variant:"warning","data-sentry-element":"ConfirmationModal","data-sentry-source-file":"MfaAuthSettingsForm.tsx",children:["Enabling SMS MFA will result in an additional charge of ",(0,a.jsx)("span",{translate:"no",children:"$75"})," per month for the first project in the organization and an additional"," ",(0,a.jsx)("span",{translate:"no",children:"$10"})," per month for additional projects.",(0,a.jsx)("p",{className:"mt-2",children:"Billing will start immediately upon enabling this add-on, regardless of whether your customers are using SMS MFA."})]}),(0,a.jsxs)(o.gu,{isFullWidth:!0,"data-sentry-element":"ScaffoldSection","data-sentry-source-file":"MfaAuthSettingsForm.tsx",children:[(0,a.jsx)(o.sZ,{className:"mb-4","data-sentry-element":"ScaffoldSectionTitle","data-sentry-source-file":"MfaAuthSettingsForm.tsx",children:"Enhanced MFA Security"}),(0,a.jsx)(ea.lV,{...O,"data-sentry-element":"Form_Shadcn_","data-sentry-source-file":"MfaAuthSettingsForm.tsx",children:(0,a.jsx)("form",{onSubmit:O.handleSubmit(e=>{let s={...e};j(!0),i({projectRef:t,config:s},{onError:e=>{A.oR.error("Failed to update phone MFA settings: ".concat(null==e?void 0:e.message)),j(!1)},onSuccess:()=>{A.oR.success("Successfully updated phone MFA settings"),j(!1)}})}),className:"space-y-4",children:(0,a.jsxs)(es.Zp,{"data-sentry-element":"Card","data-sentry-source-file":"MfaAuthSettingsForm.tsx",children:[(0,a.jsx)(es.Wu,{className:"pt-6","data-sentry-element":"CardContent","data-sentry-source-file":"MfaAuthSettingsForm.tsx",children:(0,a.jsx)(ea.zB,{control:O.control,name:"MFA_ALLOW_LOW_AAL",render:e=>{let{field:t}=e;return(0,a.jsx)(en.M,{layout:"flex-row-reverse",label:"Limit duration of AAL1 sessions",description:"A user's session will be terminated unless they verify one of their factors within 15 minutes of initial sign in. Recommendation: ON",children:(0,a.jsx)(ea.MJ,{children:(0,a.jsx)(er.d,{checked:!t.value,onCheckedChange:e=>t.onChange(!e),disabled:!b})})})},"data-sentry-element":"FormField_Shadcn_","data-sentry-source-file":"MfaAuthSettingsForm.tsx"})}),(0,a.jsxs)(es.wL,{className:"justify-end space-x-2","data-sentry-element":"CardFooter","data-sentry-source-file":"MfaAuthSettingsForm.tsx",children:[O.formState.isDirty&&(0,a.jsx)(x.$,{type:"default",onClick:()=>O.reset(),children:"Cancel"}),(0,a.jsx)(x.$,{type:"primary",htmlType:"submit",disabled:!b||g||!O.formState.isDirty,loading:p,"data-sentry-element":"Button","data-sentry-source-file":"MfaAuthSettingsForm.tsx",children:"Save changes"})]})]})})})]})]})},eG=[{key:"hcaptcha",label:"hCaptcha"},{key:"turnstile",label:"Turnstile by Cloudflare"}],e$=(0,K.Ik)({DISABLE_SIGNUP:(0,K.zM)().required(),EXTERNAL_ANONYMOUS_USERS_ENABLED:(0,K.zM)().required(),SECURITY_MANUAL_LINKING_ENABLED:(0,K.zM)().required(),SITE_URL:(0,K.Yj)().required("Must have a Site URL"),SECURITY_CAPTCHA_ENABLED:(0,K.zM)().required(),SECURITY_CAPTCHA_SECRET:(0,K.Yj)().when("SECURITY_CAPTCHA_ENABLED",{is:!0,then:e=>e.required("Must have a Captcha secret")}),SECURITY_CAPTCHA_PROVIDER:(0,K.Yj)().when("SECURITY_CAPTCHA_ENABLED",{is:!0,then:e=>e.oneOf(["hcaptcha","turnstile"]).required("Captcha provider must be either hcaptcha or turnstile")}),SESSIONS_TIMEBOX:(0,K.ai)().min(0,"Must be a positive number"),SESSIONS_INACTIVITY_TIMEOUT:(0,K.ai)().min(0,"Must be a positive number"),SESSIONS_SINGLE_PER_USER:(0,K.zM)(),PASSWORD_MIN_LENGTH:(0,K.ai)().min(6,"Must be greater or equal to 6."),PASSWORD_REQUIRED_CHARACTERS:(0,K.Yj)(),PASSWORD_HIBP_ENABLED:(0,K.zM)()}),eq=()=>{let{ref:e}=(0,l.g)(),{data:t,error:s,isError:r}=(0,u.op)({projectRef:e}),{mutate:n,isLoading:i}=(0,N.U)({onError:e=>{A.oR.error("Failed to update settings: ".concat(null==e?void 0:e.message))},onSuccess:()=>{A.oR.success("Successfully updated settings")}}),[d,c]=(0,y.useState)(!0),{can:p}=(0,M.hl)(f.aG.READ,"custom_config_gotrue"),{can:S}=(0,M.hl)(f.aG.UPDATE,"custom_config_gotrue"),g=(0,Z.mN)({resolver:(0,J.t)(e$),defaultValues:{DISABLE_SIGNUP:!0,EXTERNAL_ANONYMOUS_USERS_ENABLED:!1,SECURITY_MANUAL_LINKING_ENABLED:!1,SITE_URL:"",SECURITY_CAPTCHA_ENABLED:!1,SECURITY_CAPTCHA_SECRET:"",SECURITY_CAPTCHA_PROVIDER:"hcaptcha",SESSIONS_TIMEBOX:0,SESSIONS_INACTIVITY_TIMEOUT:0,SESSIONS_SINGLE_PER_USER:!1,PASSWORD_MIN_LENGTH:6,PASSWORD_REQUIRED_CHARACTERS:D.F,PASSWORD_HIBP_ENABLED:!1}});return((0,y.useEffect)(()=>{t&&!i&&g.reset({DISABLE_SIGNUP:!t.DISABLE_SIGNUP,EXTERNAL_ANONYMOUS_USERS_ENABLED:t.EXTERNAL_ANONYMOUS_USERS_ENABLED||!1,SECURITY_MANUAL_LINKING_ENABLED:t.SECURITY_MANUAL_LINKING_ENABLED||!1,SITE_URL:t.SITE_URL||"",SECURITY_CAPTCHA_ENABLED:t.SECURITY_CAPTCHA_ENABLED||!1,SECURITY_CAPTCHA_SECRET:t.SECURITY_CAPTCHA_SECRET||"",SECURITY_CAPTCHA_PROVIDER:t.SECURITY_CAPTCHA_PROVIDER||"hcaptcha",SESSIONS_TIMEBOX:t.SESSIONS_TIMEBOX||0,SESSIONS_INACTIVITY_TIMEOUT:t.SESSIONS_INACTIVITY_TIMEOUT||0,SESSIONS_SINGLE_PER_USER:t.SESSIONS_SINGLE_PER_USER||!1,PASSWORD_MIN_LENGTH:t.PASSWORD_MIN_LENGTH||6,PASSWORD_REQUIRED_CHARACTERS:t.PASSWORD_REQUIRED_CHARACTERS||D.F,PASSWORD_HIBP_ENABLED:t.PASSWORD_HIBP_ENABLED||!1})},[t,i]),r)?(0,a.jsxs)(h.Fc,{variant:"destructive",children:[(0,a.jsx)(m.id,{}),(0,a.jsx)(h.XL,{children:"Failed to retrieve auth configuration"}),(0,a.jsx)(h.TN,{children:s.message})]}):p?(0,a.jsxs)(o.gu,{isFullWidth:!0,"data-sentry-element":"ScaffoldSection","data-sentry-component":"ProtectionAuthSettingsForm","data-sentry-source-file":"ProtectionAuthSettingsForm.tsx",children:[(0,a.jsx)(o.sZ,{className:"mb-4","data-sentry-element":"ScaffoldSectionTitle","data-sentry-source-file":"ProtectionAuthSettingsForm.tsx",children:"Bot and Abuse Protection"}),(0,a.jsx)(ea.lV,{...g,"data-sentry-element":"Form_Shadcn_","data-sentry-source-file":"ProtectionAuthSettingsForm.tsx",children:(0,a.jsx)("form",{onSubmit:g.handleSubmit(t=>{let s={...t};s.DISABLE_SIGNUP=!t.DISABLE_SIGNUP,s.PASSWORD_REQUIRED_CHARACTERS===D.F&&(s.PASSWORD_REQUIRED_CHARACTERS=""),n({projectRef:e,config:s})}),className:"space-y-4",children:(0,a.jsxs)(es.Zp,{"data-sentry-element":"Card","data-sentry-source-file":"ProtectionAuthSettingsForm.tsx",children:[(0,a.jsx)(es.Wu,{"data-sentry-element":"CardContent","data-sentry-source-file":"ProtectionAuthSettingsForm.tsx",children:(0,a.jsx)(ea.zB,{control:g.control,name:"SECURITY_CAPTCHA_ENABLED",render:e=>{let{field:t}=e;return(0,a.jsx)(en.M,{layout:"flex-row-reverse",label:"Enable Captcha protection",description:"Protect authentication endpoints from bots and abuse.",children:(0,a.jsx)(ea.MJ,{children:(0,a.jsx)(er.d,{checked:t.value,onCheckedChange:t.onChange,disabled:!S})})})},"data-sentry-element":"FormField_Shadcn_","data-sentry-source-file":"ProtectionAuthSettingsForm.tsx"})}),g.watch("SECURITY_CAPTCHA_ENABLED")&&(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(es.Wu,{children:(0,a.jsx)(ea.zB,{control:g.control,name:"SECURITY_CAPTCHA_PROVIDER",render:e=>{let{field:t}=e,s=eG.find(e=>e.key===t.value);return(0,a.jsxs)(en.M,{layout:"flex-row-reverse",label:"Choose Captcha Provider",children:[(0,a.jsx)(ea.MJ,{children:(0,a.jsxs)(eF.l6,{value:t.value,onValueChange:t.onChange,disabled:!S,children:[(0,a.jsx)(eF.bq,{children:(0,a.jsx)(eF.yv,{placeholder:"Select provider"})}),(0,a.jsx)(eF.gC,{align:"end",children:eG.map(e=>(0,a.jsx)(eF.eb,{value:e.key,children:e.label},e.key))})]})}),(0,a.jsxs)(Q.g,{href:"hcaptcha"===t.value?"https://supabase.com/docs/guides/auth/auth-captcha?queryGroups=captcha-method&captcha-method=hcaptcha-1":"turnstile"===t.value?"https://supabase.com/docs/guides/auth/auth-captcha?queryGroups=captcha-method&captcha-method=turnstile-1":"/",className:"mt-2 text-xs text-foreground-light hover:text-foreground no-underline",children:["How to set up ",null==s?void 0:s.label,"?"]})]})}})}),(0,a.jsx)(es.Wu,{children:(0,a.jsx)(ea.zB,{control:g.control,name:"SECURITY_CAPTCHA_SECRET",render:e=>{let{field:t}=e;return(0,a.jsx)(en.M,{layout:"flex-row-reverse",label:"Captcha secret",description:"Obtain this secret from the provider.",children:(0,a.jsx)(ea.MJ,{children:(0,a.jsx)("div",{className:"flex items-center gap-2",children:(0,a.jsx)(eU.j,{postTab:(0,a.jsx)(x.$,{type:"text",className:"p-0",onClick:()=>c(!d),icon:d?(0,a.jsx)(k.A,{}):(0,a.jsx)(B.A,{})}),children:(0,a.jsx)(eN.p,{...t,type:d?"password":"text",disabled:!S})})})})})}})})]}),(0,a.jsxs)(es.wL,{className:"justify-end space-x-2","data-sentry-element":"CardFooter","data-sentry-source-file":"ProtectionAuthSettingsForm.tsx",children:[g.formState.isDirty&&(0,a.jsx)(x.$,{type:"default",onClick:()=>g.reset(),children:"Cancel"}),(0,a.jsx)(x.$,{type:"primary",htmlType:"submit",disabled:!S||i||!g.formState.isDirty,loading:i,"data-sentry-element":"Button","data-sentry-source-file":"ProtectionAuthSettingsForm.tsx",children:"Save changes"})]})]})})})]}):(0,a.jsx)(ee.A,{resourceText:"view auth configuration settings"})};var eJ=s(32981),eZ=s(10663);function eK(e){let{value:t}=e;return 0===t?"never":1===t?"hour":"hours"}let eQ=eZ.Ik({REFRESH_TOKEN_ROTATION_ENABLED:eZ.zM(),SECURITY_REFRESH_TOKEN_REUSE_INTERVAL:eZ.au.number().positive().min(0,"Must be a value more than 0")}),e0=eZ.Ik({SESSIONS_TIMEBOX:eZ.au.number().min(0,"Must be a positive number"),SESSIONS_INACTIVITY_TIMEOUT:eZ.au.number().multipleOf(.1).min(0,"Must be a positive number"),SESSIONS_SINGLE_PER_USER:eZ.zM()}),e1=()=>{var e;let{ref:t}=(0,l.g)(),{data:s,error:r,isError:n}=(0,u.op)({projectRef:t}),{mutate:i}=(0,N.U)(),[d,c]=(0,y.useState)(!1),[p,S]=(0,y.useState)(!1),{can:g}=(0,M.hl)(f.aG.READ,"custom_config_gotrue"),{can:j}=(0,M.hl)(f.aG.UPDATE,"custom_config_gotrue"),{data:_}=(0,eO.s)(),E=(null==_||null==(e=_.plan)?void 0:e.id)!=="free",v=R.pe&&!E,b=(0,Z.mN)({resolver:(0,eJ.u)(eQ),defaultValues:{REFRESH_TOKEN_ROTATION_ENABLED:!1,SECURITY_REFRESH_TOKEN_REUSE_INTERVAL:0}}),T=(0,Z.mN)({resolver:(0,eJ.u)(e0),defaultValues:{SESSIONS_TIMEBOX:0,SESSIONS_INACTIVITY_TIMEOUT:0,SESSIONS_SINGLE_PER_USER:!1}});return((0,y.useEffect)(()=>{s&&(d||b.reset({REFRESH_TOKEN_ROTATION_ENABLED:s.REFRESH_TOKEN_ROTATION_ENABLED||!1,SECURITY_REFRESH_TOKEN_REUSE_INTERVAL:s.SECURITY_REFRESH_TOKEN_REUSE_INTERVAL}),p||T.reset({SESSIONS_TIMEBOX:s.SESSIONS_TIMEBOX||0,SESSIONS_INACTIVITY_TIMEOUT:s.SESSIONS_INACTIVITY_TIMEOUT||0,SESSIONS_SINGLE_PER_USER:s.SESSIONS_SINGLE_PER_USER||!1}))},[s,d,p]),n)?(0,a.jsxs)(h.Fc,{variant:"destructive",children:[(0,a.jsx)(m.id,{}),(0,a.jsx)(h.XL,{children:"Failed to retrieve auth configuration"}),(0,a.jsx)(h.TN,{children:r.message})]}):g?(0,a.jsxs)(a.Fragment,{children:[(0,a.jsxs)(o.gu,{isFullWidth:!0,"data-sentry-element":"ScaffoldSection","data-sentry-source-file":"SessionsAuthSettingsForm.tsx",children:[(0,a.jsx)(o.sZ,{className:"mb-4","data-sentry-element":"ScaffoldSectionTitle","data-sentry-source-file":"SessionsAuthSettingsForm.tsx",children:"Refresh Tokens"}),(0,a.jsx)(ea.lV,{...b,"data-sentry-element":"Form_Shadcn_","data-sentry-source-file":"SessionsAuthSettingsForm.tsx",children:(0,a.jsx)("form",{onSubmit:b.handleSubmit(e=>{let s={...e};c(!0),i({projectRef:t,config:s},{onError:e=>{A.oR.error("Failed to update refresh token settings: ".concat(null==e?void 0:e.message)),c(!1)},onSuccess:()=>{A.oR.success("Successfully updated refresh token settings"),c(!1)}})}),className:"space-y-4",children:(0,a.jsxs)(es.Zp,{"data-sentry-element":"Card","data-sentry-source-file":"SessionsAuthSettingsForm.tsx",children:[(0,a.jsx)(es.Wu,{className:"pt-6","data-sentry-element":"CardContent","data-sentry-source-file":"SessionsAuthSettingsForm.tsx",children:(0,a.jsx)(ea.zB,{control:b.control,name:"REFRESH_TOKEN_ROTATION_ENABLED",render:e=>{let{field:t}=e;return(0,a.jsx)(en.M,{layout:"flex-row-reverse",label:"Detect and revoke potentially compromised refresh tokens",description:"Prevent replay attacks from potentially compromised refresh tokens.",children:(0,a.jsx)(ea.MJ,{children:(0,a.jsx)(er.d,{checked:t.value,onCheckedChange:t.onChange,disabled:!j})})})},"data-sentry-element":"FormField_Shadcn_","data-sentry-source-file":"SessionsAuthSettingsForm.tsx"})}),b.watch("REFRESH_TOKEN_ROTATION_ENABLED")&&(0,a.jsx)(es.Wu,{children:(0,a.jsx)(ea.zB,{control:b.control,name:"SECURITY_REFRESH_TOKEN_REUSE_INTERVAL",render:e=>{let{field:t}=e;return(0,a.jsx)(en.M,{layout:"flex-row-reverse",label:"Refresh token reuse interval",description:"Time interval where the same refresh token can be used multiple times to request for an access token. Recommendation: 10 seconds.",children:(0,a.jsx)(ea.MJ,{children:(0,a.jsx)(eU.j,{postTab:"seconds",children:(0,a.jsx)(eN.p,{type:"number",min:0,...t,disabled:!j})})})})}})}),(0,a.jsxs)(es.wL,{className:"justify-end space-x-2","data-sentry-element":"CardFooter","data-sentry-source-file":"SessionsAuthSettingsForm.tsx",children:[b.formState.isDirty&&(0,a.jsx)(x.$,{type:"default",onClick:()=>b.reset(),children:"Cancel"}),(0,a.jsx)(x.$,{type:"primary",htmlType:"submit",disabled:!j||d||!b.formState.isDirty,loading:d,"data-sentry-element":"Button","data-sentry-source-file":"SessionsAuthSettingsForm.tsx",children:"Save changes"})]})]})})})]}),(0,a.jsxs)(o.gu,{isFullWidth:!0,"data-sentry-element":"ScaffoldSection","data-sentry-source-file":"SessionsAuthSettingsForm.tsx",children:[(0,a.jsx)(o.sZ,{className:"mb-4","data-sentry-element":"ScaffoldSectionTitle","data-sentry-source-file":"SessionsAuthSettingsForm.tsx",children:"User Sessions"}),(0,a.jsx)(ea.lV,{...T,"data-sentry-element":"Form_Shadcn_","data-sentry-source-file":"SessionsAuthSettingsForm.tsx",children:(0,a.jsx)("form",{onSubmit:T.handleSubmit(e=>{let s={...e};S(!0),i({projectRef:t,config:s},{onError:e=>{A.oR.error("Failed to update user session settings: ".concat(null==e?void 0:e.message)),S(!1)},onSuccess:()=>{A.oR.success("Successfully updated user session settings"),S(!1)}})}),className:"space-y-4",children:(0,a.jsxs)(es.Zp,{"data-sentry-element":"Card","data-sentry-source-file":"SessionsAuthSettingsForm.tsx",children:[(0,a.jsxs)(es.Wu,{"data-sentry-element":"CardContent","data-sentry-source-file":"SessionsAuthSettingsForm.tsx",children:[v&&(0,a.jsx)("div",{className:"mb-4",children:(0,a.jsx)(eD.A,{primaryText:"Upgrade to Pro",secondaryText:"Configuring user sessions requires the Pro Plan."})}),(0,a.jsx)(ea.zB,{control:T.control,name:"SESSIONS_SINGLE_PER_USER",render:e=>{let{field:t}=e;return(0,a.jsx)(en.M,{layout:"flex-row-reverse",label:"Enforce single session per user",description:"If enabled, all but a user's most recently active session will be terminated.",children:(0,a.jsx)(ea.MJ,{children:(0,a.jsx)(er.d,{checked:t.value,onCheckedChange:t.onChange,disabled:!j||!E})})})},"data-sentry-element":"FormField_Shadcn_","data-sentry-source-file":"SessionsAuthSettingsForm.tsx"})]}),(0,a.jsx)(es.Wu,{"data-sentry-element":"CardContent","data-sentry-source-file":"SessionsAuthSettingsForm.tsx",children:(0,a.jsx)(ea.zB,{control:T.control,name:"SESSIONS_TIMEBOX",render:e=>{let{field:t}=e;return(0,a.jsx)(en.M,{layout:"flex-row-reverse",label:"Time-box user sessions",description:"The amount of time before a user is forced to sign in again. Use 0 for never.",children:(0,a.jsx)("div",{className:"flex items-center",children:(0,a.jsx)(ea.MJ,{children:(0,a.jsx)(eU.j,{postTab:(0,a.jsx)(eK,{value:t.value||0}),children:(0,a.jsx)(eN.p,{type:"number",min:0,...t,disabled:!j||!E})})})})})},"data-sentry-element":"FormField_Shadcn_","data-sentry-source-file":"SessionsAuthSettingsForm.tsx"})}),(0,a.jsx)(es.Wu,{"data-sentry-element":"CardContent","data-sentry-source-file":"SessionsAuthSettingsForm.tsx",children:(0,a.jsx)(ea.zB,{control:T.control,name:"SESSIONS_INACTIVITY_TIMEOUT",render:e=>{let{field:t}=e;return(0,a.jsx)(en.M,{layout:"flex-row-reverse",label:"Inactivity timeout",description:"The amount of time a user needs to be inactive to be forced to sign in again. Use 0 for never.",children:(0,a.jsx)("div",{className:"flex items-center",children:(0,a.jsx)(ea.MJ,{children:(0,a.jsx)(eU.j,{postTab:(0,a.jsx)(eK,{value:t.value||0}),children:(0,a.jsx)(eN.p,{type:"number",...t,disabled:!j||!E})})})})})},"data-sentry-element":"FormField_Shadcn_","data-sentry-source-file":"SessionsAuthSettingsForm.tsx"})}),(0,a.jsxs)(es.wL,{className:"justify-end space-x-2","data-sentry-element":"CardFooter","data-sentry-source-file":"SessionsAuthSettingsForm.tsx",children:[T.formState.isDirty&&(0,a.jsx)(x.$,{type:"default",onClick:()=>T.reset(),children:"Cancel"}),(0,a.jsx)(x.$,{type:"primary",htmlType:"submit",disabled:!j||p||!T.formState.isDirty,loading:p,"data-sentry-element":"Button","data-sentry-source-file":"SessionsAuthSettingsForm.tsx",children:"Save changes"})]})]})})})]})]}):(0,a.jsx)(ee.A,{resourceText:"view auth configuration settings"})};var e2=s(70758);let e6={SMTP_ADMIN_EMAIL:null,SMTP_SENDER_NAME:null,SMTP_USER:null,SMTP_HOST:null,SMTP_PASS:null,SMTP_PORT:null,SMTP_MAX_FREQUENCY:60};var e3=s(44815);let e4=()=>{var e;let{ref:t}=(0,l.g)(),{data:s,error:r,isError:n}=(0,u.op)({projectRef:t}),{mutate:d,isLoading:c}=(0,N.U)(),[p,S]=(0,y.useState)(!1),[g,j]=(0,y.useState)(!0),{can:_}=(0,M.hl)(f.aG.READ,"custom_config_gotrue"),{can:E}=(0,M.hl)(f.aG.UPDATE,"custom_config_gotrue"),v=K.Ik({SMTP_ADMIN_EMAIL:K.Yj().when("ENABLE_SMTP",{is:!0,then:e=>e.email("Must be a valid email").required("Sender email is required"),otherwise:e=>e}),SMTP_SENDER_NAME:K.Yj().when("ENABLE_SMTP",{is:!0,then:e=>e.required("Sender name is required"),otherwise:e=>e}),SMTP_HOST:K.Yj().when("ENABLE_SMTP",{is:!0,then:e=>e.matches((0,D.r)({excludeSimpleDomains:!1}),"Must be a valid URL or IP address").required("Host URL is required."),otherwise:e=>e}),SMTP_PORT:K.ai().when("ENABLE_SMTP",{is:!0,then:e=>e.required("Port number is required.").min(1,"Must be a valid port number more than 0").max(65535,"Must be a valid port number no more than 65535"),otherwise:e=>e}),SMTP_MAX_FREQUENCY:K.ai().when("ENABLE_SMTP",{is:!0,then:e=>e.required("Rate limit is required.").min(1,"Must be more than 0").max(32767,"Must not be more than 32,767 an hour"),otherwise:e=>e}),SMTP_USER:K.Yj().when("ENABLE_SMTP",{is:!0,then:e=>e.required("SMTP Username is required"),otherwise:e=>e}),SMTP_PASS:K.Yj(),ENABLE_SMTP:K.zM().required()}),b=(0,Z.mN)({resolver:(0,J.t)(v),defaultValues:{SMTP_ADMIN_EMAIL:"",SMTP_SENDER_NAME:"",SMTP_HOST:"",SMTP_PORT:void 0,SMTP_MAX_FREQUENCY:void 0,SMTP_USER:"",SMTP_PASS:"",ENABLE_SMTP:!1}});return((0,y.useEffect)(()=>{if(s){let e=(0,e3.A)(s);e.SMTP_PORT&&(e.SMTP_PORT=Number(e.SMTP_PORT)),b.reset({...e,ENABLE_SMTP:(0,e3.M)(s)}),S((0,e3.M)(s))}},[s,b]),(0,y.useEffect)(()=>{let e=b.watch((e,t)=>{let{name:s}=t;"ENABLE_SMTP"===s&&S(e.ENABLE_SMTP)});return()=>e.unsubscribe()},[b]),n)?(0,a.jsxs)(h.Fc,{variant:"destructive",children:[(0,a.jsx)(m.id,{}),(0,a.jsx)(h.XL,{children:"Failed to retrieve auth configuration"}),(0,a.jsx)(h.TN,{children:r.message})]}):_?(0,a.jsx)(o.eh,{"data-sentry-element":"ScaffoldContainer","data-sentry-component":"SmtpForm","data-sentry-source-file":"SmtpForm.tsx",children:(0,a.jsx)(o.gu,{isFullWidth:!0,"data-sentry-element":"ScaffoldSection","data-sentry-source-file":"SmtpForm.tsx",children:(0,a.jsx)(ea.lV,{...b,"data-sentry-element":"Form_Shadcn_","data-sentry-source-file":"SmtpForm.tsx",children:(0,a.jsx)("form",{onSubmit:b.handleSubmit(e=>{let{ENABLE_SMTP:s,...a}=e,r=s?a:e6;r.SMTP_PORT&&(r.SMTP_PORT=r.SMTP_PORT.toString()),""===r.SMTP_PASS&&delete r.SMTP_PASS,d({projectRef:t,config:r},{onError:e=>{A.oR.error("Failed to update settings: ".concat(e.message))},onSuccess:()=>{j(!0),A.oR.success("Successfully updated settings")}})}),children:(0,a.jsxs)(es.Zp,{"data-sentry-element":"Card","data-sentry-source-file":"SmtpForm.tsx",children:[(0,a.jsxs)(es.Wu,{"data-sentry-element":"CardContent","data-sentry-source-file":"SmtpForm.tsx",children:[(0,a.jsx)(ea.zB,{control:b.control,name:"ENABLE_SMTP",render:e=>{let{field:s}=e;return(0,a.jsx)(en.M,{layout:"flex-row-reverse",label:"Enable Custom SMTP",description:(0,a.jsxs)("p",{className:"max-w-full prose text-sm text-foreground-lighter",children:["Emails will be sent using your custom SMTP provider. Email rate limits can be adjusted"," ",(0,a.jsx)(i(),{className:"underline",href:"/project/".concat(t,"/auth/rate-limits"),children:"here"}),"."]}),children:(0,a.jsx)(ea.MJ,{children:(0,a.jsx)(er.d,{checked:s.value,onCheckedChange:s.onChange,disabled:!E})})})},"data-sentry-element":"FormField_Shadcn_","data-sentry-source-file":"SmtpForm.tsx"}),p&&!(0,e3.M)(b.getValues())&&(0,a.jsx)("div",{className:"mt-4",children:(0,a.jsxs)(h.Fc,{variant:"warning",children:[(0,a.jsx)(e2.A,{strokeWidth:2}),(0,a.jsx)(h.XL,{children:"All fields below must be filled"}),(0,a.jsx)(h.TN,{children:"The following fields must be filled before custom SMTP can be properly enabled"})]})})]}),p&&(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(es.Wu,{className:"py-6",children:(0,a.jsxs)("div",{className:"grid grid-cols-12 gap-6",children:[(0,a.jsxs)("div",{className:"col-span-4",children:[(0,a.jsx)("h3",{className:"text-sm mb-1",children:"Sender details"}),(0,a.jsx)("p",{className:"text-sm text-foreground-lighter",children:"Configure the sender information for your emails."})]}),(0,a.jsxs)("div",{className:"col-span-8 space-y-4",children:[(0,a.jsx)(ea.zB,{control:b.control,name:"SMTP_ADMIN_EMAIL",render:e=>{let{field:t}=e;return(0,a.jsx)(en.M,{label:"Sender email",description:"This is the email address the emails are sent from",children:(0,a.jsx)(ea.MJ,{children:(0,a.jsx)(eN.p,{...t,placeholder:"noreply@yourdomain.com",disabled:!E})})})}}),(0,a.jsx)(ea.zB,{control:b.control,name:"SMTP_SENDER_NAME",render:e=>{let{field:t}=e;return(0,a.jsx)(en.M,{label:"Sender name",description:"Name displayed in the recipient's inbox",children:(0,a.jsx)(ea.MJ,{children:(0,a.jsx)(eN.p,{...t,placeholder:"The name shown on the email",disabled:!E})})})}})]})]})}),(0,a.jsx)(es.Wu,{className:"py-6",children:(0,a.jsxs)("div",{className:"grid grid-cols-12 gap-6",children:[(0,a.jsxs)("div",{className:"col-span-4",children:[(0,a.jsx)("h3",{className:"text-sm mb-1",children:"SMTP Provider Settings"}),(0,a.jsx)("p",{className:"text-sm text-foreground-lighter",children:"Your SMTP Credentials will always be encrypted in our database."})]}),(0,a.jsxs)("div",{className:"col-span-8 space-y-4",children:[(null==(e=b.watch("SMTP_HOST"))?void 0:e.endsWith(".gmail.com"))&&(0,a.jsxs)(h.Fc,{variant:"warning",className:"mb-4",children:[(0,a.jsx)(e2.A,{strokeWidth:2}),(0,a.jsx)(h.XL,{children:"Check your SMTP provider"}),(0,a.jsx)(h.TN,{children:"Not all SMTP providers are designed for the email sending required by Supabase Auth. It looks like the SMTP provider you entered is designed for sending personal email messages and not for sending transactional messages. Although you can ignore this warning, email deliverability may be impacted."})]}),(0,a.jsx)(ea.zB,{control:b.control,name:"SMTP_HOST",render:e=>{let{field:t}=e;return(0,a.jsx)(en.M,{label:"Host",description:"Hostname or IP address of your SMTP server.",children:(0,a.jsx)(ea.MJ,{children:(0,a.jsx)(eN.p,{...t,placeholder:"your.smtp.host.com",disabled:!E})})})}}),(0,a.jsx)(ea.zB,{control:b.control,name:"SMTP_PORT",render:e=>{let{field:t}=e;return(0,a.jsx)(en.M,{label:"Port number",description:(0,a.jsxs)(a.Fragment,{children:[(0,a.jsxs)("span",{className:"block",children:["Port used by your SMTP server. Common ports include 25, 465, and 587."," "]}),(0,a.jsx)("span",{className:"mt-2 block",children:"Avoid using port 25 as modern SMTP email clients shouldn't use this port, it is traditionally blocked by residential ISPs and Cloud Hosting Providers, to curb the amount of spam."})]}),children:(0,a.jsx)(ea.MJ,{children:(0,a.jsx)(eN.p,{type:"number",value:t.value,onChange:e=>t.onChange(Number(e.target.value)),placeholder:"587",disabled:!E})})})}}),(0,a.jsx)(ea.zB,{control:b.control,name:"SMTP_MAX_FREQUENCY",render:e=>{let{field:t}=e;return(0,a.jsx)(en.M,{label:"Minimum interval between emails being sent",description:"How long between each email can a new email be sent via your SMTP server.",children:(0,a.jsx)(ea.MJ,{children:(0,a.jsx)(eU.j,{postTab:"seconds",children:(0,a.jsx)(eN.p,{type:"number",value:t.value,onChange:e=>t.onChange(Number(e.target.value)),disabled:!E})})})})}}),(0,a.jsx)(ea.zB,{control:b.control,name:"SMTP_USER",render:e=>{let{field:t}=e;return(0,a.jsx)(en.M,{label:"Username",description:"Username for your SMTP server",children:(0,a.jsx)(ea.MJ,{children:(0,a.jsx)(eN.p,{...t,placeholder:"SMTP Username",disabled:!E})})})}}),(0,a.jsx)(ea.zB,{control:b.control,name:"SMTP_PASS",render:e=>{let{field:t}=e;return(0,a.jsx)(en.M,{label:"Password",description:"For security reasons, the password is write-only. Once saved, it cannot be retrieved or displayed.",children:(0,a.jsx)(ea.MJ,{children:(0,a.jsx)(eU.j,{postTab:(0,a.jsx)(x.$,{type:"text",className:"p-0",onClick:()=>j(!g),icon:g?(0,a.jsx)(k.A,{}):(0,a.jsx)(B.A,{})}),children:(0,a.jsx)(eN.p,{...t,type:g?"password":"text",placeholder:(null==s?void 0:s.SMTP_PASS)===null?"SMTP Password":"••••••••",disabled:!E})})})})}})]})]})})]}),(0,a.jsxs)(es.wL,{className:"justify-end space-x-2","data-sentry-element":"CardFooter","data-sentry-source-file":"SmtpForm.tsx",children:[b.formState.isDirty&&(0,a.jsx)(x.$,{type:"default",onClick:()=>b.reset(),children:"Cancel"}),(0,a.jsx)(x.$,{type:"primary",htmlType:"submit",loading:c,disabled:!E||!b.formState.isDirty,"data-sentry-element":"Button","data-sentry-source-file":"SmtpForm.tsx",children:"Save changes"})]})]})})})})}):(0,a.jsx)(ee.A,{resourceText:"view SMTP settings"})};var e5=s(28881),e7=s(32144);let e9={integrations:e=>["auth",e,"third-party-auth"]};async function e8(e){let{projectRef:t,tpaId:s}=e,{data:a,error:r}=await (0,eE.yH)("/v1/projects/{ref}/config/auth/third-party-auth/{tpa_id}",{params:{path:{ref:t,tpa_id:s}}});return r&&(0,eE.H4)(r),a}let te=function(){let{onSuccess:e,onError:t,...s}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},a=(0,e7.jE)();return(0,e_.n)(e=>e8(e),{async onSuccess(t,s,r){let{projectRef:n}=s;await a.invalidateQueries(e9.integrations(n)),await (null==e?void 0:e(t,s,r))},async onError(e,s,a){void 0===t?A.oR.error("Failed to delete third party auth integration: ".concat(e.message)):t(e,s,a)},...s})};var tt=s(56947);async function ts(e,t){let{projectRef:s}=e;if(!s)throw Error("projectRef is required");let{data:a,error:r}=await (0,eE.Jt)("/v1/projects/{ref}/config/auth/third-party-auth",{params:{path:{ref:s}},signal:t});return r&&(0,eE.H4)(r),a}let ta=function(e){let{projectRef:t}=e,{enabled:s=!0,...a}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return(0,tt.I)(e9.integrations(t),e=>{let{signal:s}=e;return ts({projectRef:t},s)},{enabled:s&&void 0!==t,...a})};var tr=s(51500),tn=s(72259),ti=s(16426),tl=s.n(ti),to=s(71139);let td=e=>{var t,s,a,r,n;return(null==e?void 0:e.type)==="workos"?"workos":(null==e||null==(t=e.oidc_issuer_url)?void 0:t.startsWith("https://securetoken.google.com/"))?"firebase":(null==e||null==(s=e.oidc_issuer_url)?void 0:s.includes("amazonaws.com"))?"awsCognito":(null==e||null==(a=e.oidc_issuer_url)?void 0:a.includes("auth0.com"))?"auth0":(null==e||null==(r=e.oidc_issuer_url)?void 0:r.includes(".clerk.accounts.dev"))||(null==e||null==(n=e.oidc_issuer_url)?void 0:n.startsWith("https://clerk."))?"clerk":"custom"},tc=e=>{switch(e){case"firebase":return"Firebase";case"auth0":return"Auth0";case"awsCognito":return"Amazon Cognito";case"clerk":return"Clerk";case"workos":return"WorkOS";default:return"Custom"}},tu=e=>{switch(e){case"firebase":return"".concat(R.o2,"/img/icons/firebase-icon.svg");case"auth0":return"".concat(R.o2,"/img/icons/auth0-icon.svg");case"awsCognito":case"custom":default:return"".concat(R.o2,"/img/icons/cognito-icon.svg");case"clerk":return"".concat(R.o2,"/img/icons/clerk-icon.svg");case"workos":return"".concat(R.o2,"/img/icons/workos-icon.svg")}},th=e=>{let{disabled:t,type:s,onSelectIntegrationType:r}=e;return(0,a.jsxs)(to._2,{onClick:()=>r(s),className:(0,tr.cn)("flex items-center gap-x-2 p-2",t&&"cursor-not-allowed"),disabled:t,"data-sentry-element":"DropdownMenuItem","data-sentry-component":"ProviderDropdownItem","data-sentry-source-file":"AddIntegrationDropdown.tsx",children:[(0,a.jsx)(tl(),{src:tu(s),width:16,height:16,alt:"".concat(s," icon"),"data-sentry-element":"Image","data-sentry-source-file":"AddIntegrationDropdown.tsx"}),(0,a.jsx)("span",{children:tc(s)})]},s)},tm=e=>{let{align:t="end",onSelectIntegrationType:s}=e,r=(0,l._P)("isWorkOSTPAEnabled");return(0,a.jsxs)(to.rI,{"data-sentry-element":"DropdownMenu","data-sentry-component":"AddIntegrationDropdown","data-sentry-source-file":"AddIntegrationDropdown.tsx",children:[(0,a.jsx)(to.ty,{asChild:!0,"data-sentry-element":"DropdownMenuTrigger","data-sentry-source-file":"AddIntegrationDropdown.tsx",children:(0,a.jsx)(x.$,{type:"primary",iconRight:(0,a.jsx)(tn.A,{size:14,strokeWidth:1}),"data-sentry-element":"Button","data-sentry-source-file":"AddIntegrationDropdown.tsx",children:"Add provider"})}),(0,a.jsxs)(to.SQ,{align:t,className:"w-56","data-sentry-element":"DropdownMenuContent","data-sentry-source-file":"AddIntegrationDropdown.tsx",children:[(0,a.jsx)(to.lp,{"data-sentry-element":"DropdownMenuLabel","data-sentry-source-file":"AddIntegrationDropdown.tsx",children:"Select Provider"}),(0,a.jsx)(to.mB,{"data-sentry-element":"DropdownMenuSeparator","data-sentry-source-file":"AddIntegrationDropdown.tsx"}),(0,a.jsx)(th,{type:"firebase",onSelectIntegrationType:s,"data-sentry-element":"ProviderDropdownItem","data-sentry-source-file":"AddIntegrationDropdown.tsx"}),(0,a.jsx)(th,{type:"clerk",onSelectIntegrationType:s,"data-sentry-element":"ProviderDropdownItem","data-sentry-source-file":"AddIntegrationDropdown.tsx"}),r&&(0,a.jsx)(th,{type:"workos",onSelectIntegrationType:s}),(0,a.jsx)(th,{type:"auth0",onSelectIntegrationType:s,"data-sentry-element":"ProviderDropdownItem","data-sentry-source-file":"AddIntegrationDropdown.tsx"}),(0,a.jsx)(th,{type:"awsCognito",onSelectIntegrationType:s,"data-sentry-element":"ProviderDropdownItem","data-sentry-source-file":"AddIntegrationDropdown.tsx"})]})]})};async function tx(e){let{projectRef:t,customJwks:s,jwksUrl:a,oidcIssuerUrl:r}=e,{data:n,error:i}=await (0,eE.bE)("/v1/projects/{ref}/config/auth/third-party-auth",{params:{path:{ref:t}},body:{custom_jwks:s,jwks_url:a,oidc_issuer_url:r}});return i&&(0,eE.H4)(i),n}s(17089);let tp=function(){let{onSuccess:e,onError:t,...s}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},a=(0,e7.jE)();return(0,e_.n)(e=>tx(e),{async onSuccess(t,s,r){let{projectRef:n}=s;await a.invalidateQueries(e9.integrations(n)),await (null==e?void 0:e(t,s,r))},async onError(e,s,a){void 0===t?A.oR.error("Failed to create third party auth integration: ".concat(e.message)):t(e,s,a)},...s})};var tf=s(16838);let tS="create-auth0-auth-integration-form",tg=eZ.Ik({enabled:eZ.zM(),auth0DomainName:eZ.Yj().trim().min(1).regex(/^[A-Za-z0-9-.]+$/,"Project IDs should only have alphanumeric characters and hyphens.")}),ty=e=>{let{visible:t,onClose:s,onDelete:r}=e,{ref:n}=(0,l.g)(),{mutate:i,isLoading:o}=tp({onSuccess:()=>{A.oR.success("Successfully created a new Auth0 Auth integration."),s()}}),d=(0,Z.mN)({resolver:(0,eJ.u)(tg),defaultValues:{enabled:!0,auth0DomainName:""}});(0,y.useEffect)(()=>{t&&(d.reset({enabled:!0,auth0DomainName:""}),setTimeout(()=>{d.setFocus("auth0DomainName")},25))},[t]);let c=async e=>{i({projectRef:n,oidcIssuerUrl:"https://".concat(e.auth0DomainName,".auth0.com")})};return(0,a.jsx)(tf.lG,{open:t,onOpenChange:()=>s(),"data-sentry-element":"Dialog","data-sentry-component":"CreateAuth0IntegrationDialog","data-sentry-source-file":"CreateAuth0Dialog.tsx",children:(0,a.jsxs)(tf.Cf,{"data-sentry-element":"DialogContent","data-sentry-source-file":"CreateAuth0Dialog.tsx",children:[(0,a.jsx)(tf.c7,{"data-sentry-element":"DialogHeader","data-sentry-source-file":"CreateAuth0Dialog.tsx",children:(0,a.jsx)(tf.L3,{className:"truncate","data-sentry-element":"DialogTitle","data-sentry-source-file":"CreateAuth0Dialog.tsx",children:"Add new Auth0 connection"})}),(0,a.jsx)(eI.w,{"data-sentry-element":"Separator","data-sentry-source-file":"CreateAuth0Dialog.tsx"}),(0,a.jsx)(tf.OO,{"data-sentry-element":"DialogSection","data-sentry-source-file":"CreateAuth0Dialog.tsx",children:(0,a.jsx)(ea.lV,{...d,"data-sentry-element":"Form_Shadcn_","data-sentry-source-file":"CreateAuth0Dialog.tsx",children:(0,a.jsxs)("form",{id:tS,onSubmit:d.handleSubmit(c),className:"space-y-4",children:[(0,a.jsx)("p",{className:"text-sm text-foreground-light",children:"This will enable a JWT token from your Auth0 project to access data from this Supabase project."}),(0,a.jsx)(ea.zB,{control:d.control,name:"auth0DomainName",render:e=>{let{field:t}=e;return(0,a.jsx)(en.M,{label:"Auth0 domain name",children:(0,a.jsxs)("div",{className:"flex flex-row",children:[(0,a.jsx)(x.$,{type:"default",size:"small",className:"px-2 text-foreground-light rounded-r-none",onClick:()=>d.setFocus("auth0DomainName"),children:"https://"}),(0,a.jsx)(ea.MJ,{children:(0,a.jsx)(eN.p,{className:"border-l-0 rounded-none border-r-0 z-50",...t})}),(0,a.jsx)(x.$,{type:"default",size:"small",className:"px-2 text-foreground-light rounded-l-none",onClick:()=>d.setFocus("auth0DomainName"),children:".auth0.com"})]})})},"data-sentry-element":"FormField_Shadcn_","data-sentry-source-file":"CreateAuth0Dialog.tsx"},"auth0DomainName")]})})}),(0,a.jsxs)(tf.Es,{"data-sentry-element":"DialogFooter","data-sentry-source-file":"CreateAuth0Dialog.tsx",children:[!1,(0,a.jsx)(x.$,{disabled:o,type:"default",onClick:()=>s(),"data-sentry-element":"Button","data-sentry-source-file":"CreateAuth0Dialog.tsx",children:"Cancel"}),(0,a.jsx)(x.$,{form:tS,htmlType:"submit",disabled:o,loading:o,"data-sentry-element":"Button","data-sentry-source-file":"CreateAuth0Dialog.tsx",children:"Create connection"})]})]})})};var tj=s(96572),tA=s(9681),t_=s(61965),tE=s(38417);let tv=["af-south-1","ap-northeast-1","ap-northeast-2","ap-northeast-3","ap-south-1 ","ap-south-2 ","ap-southeast-1","ap-southeast-2","ap-southeast-3","ap-southeast-4","ca-central-1","eu-central-1","eu-central-2","eu-north-1","eu-south-1","eu-south-2","eu-west-1","eu-west-2","eu-west-3","il-central-1","me-central-1","me-south-1","sa-east-1","us-east-1","us-east-2","us-gov-west-1","us-west-1","us-west-2"],tb=e=>{let{value:t,onChange:s}=e,[r,n]=(0,y.useState)(!1);return(0,a.jsxs)(tA.AM,{open:r,onOpenChange:n,"data-sentry-element":"Popover_Shadcn_","data-sentry-component":"AwsRegionSelector","data-sentry-source-file":"AwsRegionSelector.tsx",children:[(0,a.jsx)(tA.Wv,{asChild:!0,"data-sentry-element":"PopoverTrigger_Shadcn_","data-sentry-source-file":"AwsRegionSelector.tsx",children:(0,a.jsx)(ea.MJ,{"data-sentry-element":"FormControl_Shadcn_","data-sentry-source-file":"AwsRegionSelector.tsx",children:(0,a.jsx)(x.$,{type:"default",role:"combobox",className:(0,tr.cn)("w-full justify-between",!t&&"text-muted-foreground"),size:"small",iconRight:(0,a.jsx)(tj.A,{className:"ml-2 h-4 w-4 shrink-0 opacity-50",strokeWidth:1}),"data-sentry-element":"Button","data-sentry-source-file":"AwsRegionSelector.tsx",children:null!=t?t:"Select a region"})})}),(0,a.jsx)(tA.hl,{className:"p-0",sameWidthAsTrigger:!0,"data-sentry-element":"PopoverContent_Shadcn_","data-sentry-source-file":"AwsRegionSelector.tsx",children:(0,a.jsxs)(t_.uB,{"data-sentry-element":"Command_Shadcn_","data-sentry-source-file":"AwsRegionSelector.tsx",children:[(0,a.jsx)(t_.G7,{placeholder:"Search AWS regions...","data-sentry-element":"CommandInput_Shadcn_","data-sentry-source-file":"AwsRegionSelector.tsx"}),(0,a.jsxs)(t_.oI,{"data-sentry-element":"CommandList_Shadcn_","data-sentry-source-file":"AwsRegionSelector.tsx",children:[(0,a.jsx)(t_.xL,{"data-sentry-element":"CommandEmpty_Shadcn_","data-sentry-source-file":"AwsRegionSelector.tsx",children:"No regions found."}),(0,a.jsx)(t_.L$,{"data-sentry-element":"CommandGroup_Shadcn_","data-sentry-source-file":"AwsRegionSelector.tsx",children:(0,a.jsx)(tE.FK,{className:"h-72","data-sentry-element":"ScrollArea","data-sentry-source-file":"AwsRegionSelector.tsx",children:tv.map(e=>(0,a.jsxs)(t_.h_,{value:e,onSelect:e=>{s(e===t?"":e),n(!1)},children:[(0,a.jsx)(S.A,{className:(0,tr.cn)("mr-2 h-4 w-4",e===t?"opacity-100":"opacity-0")}),e]},e))})})]})]})})]})},tN="create-aws-cognito-auth-integration-form",tT=eZ.Ik({enabled:eZ.zM(),awsCognitoUserPoolId:eZ.Yj().trim().min(1).regex(/^[A-Za-z0-9-_]+$/,"The project ID contains invalid characters."),awsRegion:eZ.Yj()}),tC=e=>{let{visible:t,onClose:s,onDelete:r}=e,{ref:n}=(0,l.g)(),{mutate:i,isLoading:o}=tp({onSuccess:()=>{A.oR.success("Successfully created a new Amazon Cognito Auth integration."),s()}}),d=(0,Z.mN)({resolver:(0,eJ.u)(tT),defaultValues:{enabled:!0,awsCognitoUserPoolId:"",awsRegion:"us-east-1"}});(0,y.useEffect)(()=>{t&&(d.reset({enabled:!0,awsCognitoUserPoolId:"",awsRegion:"us-east-1"}),setTimeout(()=>{d.setFocus("awsCognitoUserPoolId")},25))},[t]);let c=async e=>{i({projectRef:n,oidcIssuerUrl:"https://cognito-idp.".concat(e.awsRegion,".amazonaws.com/").concat(e.awsCognitoUserPoolId)})},u=d.watch("awsRegion");return(0,a.jsx)(tf.lG,{open:t,onOpenChange:()=>s(),"data-sentry-element":"Dialog","data-sentry-component":"CreateAwsCognitoAuthIntegrationDialog","data-sentry-source-file":"CreateAwsCognitoAuthDialog.tsx",children:(0,a.jsxs)(tf.Cf,{size:"large","data-sentry-element":"DialogContent","data-sentry-source-file":"CreateAwsCognitoAuthDialog.tsx",children:[(0,a.jsxs)(tf.c7,{"data-sentry-element":"DialogHeader","data-sentry-source-file":"CreateAwsCognitoAuthDialog.tsx",children:[(0,a.jsx)(tf.L3,{className:"truncate","data-sentry-element":"DialogTitle","data-sentry-source-file":"CreateAwsCognitoAuthDialog.tsx",children:"Add new Amazon Cognito Auth connection"}),(0,a.jsx)(tf.rr,{"data-sentry-element":"DialogDescription","data-sentry-source-file":"CreateAwsCognitoAuthDialog.tsx",children:"By adding an Amazon Cognito Auth connection, you can authenticate users using Amazon Cognito User Pools."})]}),(0,a.jsx)(eI.w,{"data-sentry-element":"Separator","data-sentry-source-file":"CreateAwsCognitoAuthDialog.tsx"}),(0,a.jsx)(tf.OO,{"data-sentry-element":"DialogSection","data-sentry-source-file":"CreateAwsCognitoAuthDialog.tsx",children:(0,a.jsx)(ea.lV,{...d,"data-sentry-element":"Form_Shadcn_","data-sentry-source-file":"CreateAwsCognitoAuthDialog.tsx",children:(0,a.jsxs)("form",{id:tN,onSubmit:d.handleSubmit(c),className:"space-y-4",children:[(0,a.jsx)("p",{className:"text-sm text-foreground-light",children:"This will enable a JWT token from Amazon Cognito project to access data from this Supabase project."}),(0,a.jsx)(ea.zB,{control:d.control,name:"awsCognitoUserPoolId",render:e=>{let{field:t}=e;return(0,a.jsx)(en.M,{label:"Amazon Cognito User Pool ID",children:(0,a.jsxs)("div",{className:"flex flex-row",children:[(0,a.jsxs)(x.$,{type:"default",size:"small",className:"px-2 text-foreground-light rounded-r-none",onClick:()=>d.setFocus("awsCognitoUserPoolId"),children:["https://cognito-idp.",u,".amazonaws.com/"]}),(0,a.jsx)(ea.MJ,{children:(0,a.jsx)(eN.p,{className:"rounded-l-none border-l-0 z-50",...t})})]})})},"data-sentry-element":"FormField_Shadcn_","data-sentry-source-file":"CreateAwsCognitoAuthDialog.tsx"},"awsCognitoUserPoolId"),(0,a.jsx)(ea.zB,{control:d.control,name:"awsRegion",render:e=>{let{field:t}=e;return(0,a.jsx)(en.M,{label:"AWS Region",children:(0,a.jsx)(tb,{value:t.value,onChange:t.onChange})})},"data-sentry-element":"FormField_Shadcn_","data-sentry-source-file":"CreateAwsCognitoAuthDialog.tsx"})]})})}),(0,a.jsxs)(tf.Es,{"data-sentry-element":"DialogFooter","data-sentry-source-file":"CreateAwsCognitoAuthDialog.tsx",children:[!1,(0,a.jsx)(x.$,{disabled:o,type:"default",onClick:()=>s(),"data-sentry-element":"Button","data-sentry-source-file":"CreateAwsCognitoAuthDialog.tsx",children:"Cancel"}),(0,a.jsx)(x.$,{form:tN,htmlType:"submit",disabled:o,loading:o,"data-sentry-element":"Button","data-sentry-source-file":"CreateAwsCognitoAuthDialog.tsx",children:"Create connection"})]})]})})};var tM=s(63324);let tR="create-firebase-auth-integration-form",tI=eZ.Ik({enabled:eZ.zM(),domain:eZ.Yj()}).superRefine((e,t)=>{e.domain.match(/https:\/\/clerk([.][a-z0-9-]+){2,}\/?/)||e.domain.match(/https:\/\/[a-z0-9-]+[.]clerk[.]accounts[.]dev\/?$/)||t.addIssue({code:tM.eq.invalid_string,path:["domain"],message:"Production Clerk domains use HTTPS and start with the clerk subdomain (https://clerk.example.com). Development Clerk domains use HTTPS and end with .clerk.accounts.dev (https://example.clerk.accounts.dev).",validation:"regex"})}),tw=e=>{let{visible:t,onClose:s,onDelete:r}=e,{ref:n}=(0,l.g)(),{mutate:i,isLoading:o}=tp({onSuccess:()=>{A.oR.success("Successfully created a new Clerk integration."),s()}}),d=(0,Z.mN)({resolver:(0,eJ.u)(tI),defaultValues:{enabled:!0,domain:""}});(0,y.useEffect)(()=>{t&&(d.reset({enabled:!0,domain:""}),setTimeout(()=>{d.setFocus("domain")},25))},[t]);let c=async e=>{i({projectRef:n,oidcIssuerUrl:e.domain})};return(0,a.jsx)(tf.lG,{open:t,onOpenChange:()=>s(),"data-sentry-element":"Dialog","data-sentry-component":"CreateClerkAuthIntegrationDialog","data-sentry-source-file":"CreateClerkAuthDialog.tsx",children:(0,a.jsxs)(tf.Cf,{"data-sentry-element":"DialogContent","data-sentry-source-file":"CreateClerkAuthDialog.tsx",children:[(0,a.jsx)(tf.c7,{"data-sentry-element":"DialogHeader","data-sentry-source-file":"CreateClerkAuthDialog.tsx",children:(0,a.jsx)(tf.L3,{className:"truncate","data-sentry-element":"DialogTitle","data-sentry-source-file":"CreateClerkAuthDialog.tsx",children:"Add new Clerk connection"})}),(0,a.jsx)(eI.w,{"data-sentry-element":"Separator","data-sentry-source-file":"CreateClerkAuthDialog.tsx"}),(0,a.jsx)(tf.OO,{"data-sentry-element":"DialogSection","data-sentry-source-file":"CreateClerkAuthDialog.tsx",children:(0,a.jsx)(ea.lV,{...d,"data-sentry-element":"Form_Shadcn_","data-sentry-source-file":"CreateClerkAuthDialog.tsx",children:(0,a.jsxs)("form",{id:tR,onSubmit:d.handleSubmit(c),className:"space-y-4",children:[(0,a.jsxs)("p",{className:"text-sm text-foreground-light",children:["Register your Clerk domain. Visit"," ",(0,a.jsx)(Q.g,{href:"https://dashboard.clerk.com/setup/supabase",target:"_blank",rel:"noopener","data-sentry-element":"InlineLink","data-sentry-source-file":"CreateClerkAuthDialog.tsx",children:"Clerk's Connect with Supabase page"})," ","to configure your Clerk instance."]}),(0,a.jsx)(ea.zB,{control:d.control,name:"domain",render:e=>{let{field:t}=e;return(0,a.jsx)(en.M,{label:"Clerk Domain",children:(0,a.jsx)(ea.MJ,{children:(0,a.jsx)(eN.p,{...t,placeholder:"https://clerk.example.com or https://example.clerk.accounts.dev"})})})},"data-sentry-element":"FormField_Shadcn_","data-sentry-source-file":"CreateClerkAuthDialog.tsx"},"domain")]})})}),(0,a.jsxs)(tf.Es,{"data-sentry-element":"DialogFooter","data-sentry-source-file":"CreateClerkAuthDialog.tsx",children:[(0,a.jsx)(x.$,{disabled:o,type:"default",onClick:()=>s(),"data-sentry-element":"Button","data-sentry-source-file":"CreateClerkAuthDialog.tsx",children:"Cancel"}),(0,a.jsx)(x.$,{form:tR,htmlType:"submit",disabled:o,loading:o,"data-sentry-element":"Button","data-sentry-source-file":"CreateClerkAuthDialog.tsx",children:"Create connection"})]})]})})},tL="create-firebase-auth-integration-form",tP=eZ.Ik({enabled:eZ.zM(),firebaseProjectId:eZ.Yj().trim().min(1).regex(/^[A-Za-z0-9-]+$/,"The project ID contains invalid characters.")}),tD=e=>{let{visible:t,onClose:s,onDelete:r}=e,{ref:n}=(0,l.g)(),{mutate:i,isLoading:o}=tp({onSuccess:()=>{A.oR.success("Successfully created a new Firebase Auth integration."),s()}}),d=(0,Z.mN)({resolver:(0,eJ.u)(tP),defaultValues:{enabled:!0,firebaseProjectId:""}});(0,y.useEffect)(()=>{t&&(d.reset({enabled:!0,firebaseProjectId:""}),setTimeout(()=>{d.setFocus("firebaseProjectId")},25))},[t]);let c=async e=>{i({projectRef:n,oidcIssuerUrl:"https://securetoken.google.com/".concat(e.firebaseProjectId)})};return(0,a.jsx)(tf.lG,{open:t,onOpenChange:()=>s(),"data-sentry-element":"Dialog","data-sentry-component":"CreateFirebaseAuthIntegrationDialog","data-sentry-source-file":"CreateFirebaseAuthDialog.tsx",children:(0,a.jsxs)(tf.Cf,{"data-sentry-element":"DialogContent","data-sentry-source-file":"CreateFirebaseAuthDialog.tsx",children:[(0,a.jsx)(tf.c7,{"data-sentry-element":"DialogHeader","data-sentry-source-file":"CreateFirebaseAuthDialog.tsx",children:(0,a.jsx)(tf.L3,{className:"truncate","data-sentry-element":"DialogTitle","data-sentry-source-file":"CreateFirebaseAuthDialog.tsx",children:"Add new Firebase Auth connection"})}),(0,a.jsx)(eI.w,{"data-sentry-element":"Separator","data-sentry-source-file":"CreateFirebaseAuthDialog.tsx"}),(0,a.jsx)(tf.OO,{"data-sentry-element":"DialogSection","data-sentry-source-file":"CreateFirebaseAuthDialog.tsx",children:(0,a.jsx)(ea.lV,{...d,"data-sentry-element":"Form_Shadcn_","data-sentry-source-file":"CreateFirebaseAuthDialog.tsx",children:(0,a.jsxs)("form",{id:tL,onSubmit:d.handleSubmit(c),className:"space-y-4",children:[(0,a.jsx)("p",{className:"text-sm text-foreground-light",children:"This will enable a JWT token from a specific Firebase project to access data from this Supabase project."}),(0,a.jsx)(ea.zB,{control:d.control,name:"firebaseProjectId",render:e=>{let{field:t}=e;return(0,a.jsx)(en.M,{label:"Firebase Auth Project ID",children:(0,a.jsx)(ea.MJ,{children:(0,a.jsx)(eN.p,{...t})})})},"data-sentry-element":"FormField_Shadcn_","data-sentry-source-file":"CreateFirebaseAuthDialog.tsx"},"firebaseProjectId")]})})}),(0,a.jsxs)(tf.Es,{"data-sentry-element":"DialogFooter","data-sentry-source-file":"CreateFirebaseAuthDialog.tsx",children:[!1,(0,a.jsx)(x.$,{disabled:o,type:"default",onClick:()=>s(),"data-sentry-element":"Button","data-sentry-source-file":"CreateFirebaseAuthDialog.tsx",children:"Cancel"}),(0,a.jsx)(x.$,{form:tL,htmlType:"submit",disabled:o,loading:o,"data-sentry-element":"Button","data-sentry-source-file":"CreateFirebaseAuthDialog.tsx",children:"Create connection"})]})]})})},tO="create-work-os-integration-form",tF=eZ.Ik({enabled:eZ.zM(),issuerURL:eZ.Yj().trim().min(1).regex(/^https:\/\/(api.workos.com|[a-zA-Z0-9-]+([.][a-zA-Z0-9-]+){2,})\/(sso|user_management)\/(client|project)_[0-7][0-9A-HJKMNP-TV-Z]{25}\/?$/,"WorkOS URL contains invalid characters or does not have the correct structure.")}),tU=e=>{let{visible:t,onClose:s,onDelete:r}=e,{ref:n}=(0,l.g)(),{mutate:i,isLoading:o}=tp({onSuccess:()=>{A.oR.success("Successfully created a new WorkOS integration."),s()}}),d=(0,Z.mN)({resolver:(0,eJ.u)(tF),defaultValues:{enabled:!0,issuerURL:""}});(0,y.useEffect)(()=>{t&&(d.reset({enabled:!0,issuerURL:""}),setTimeout(()=>{d.setFocus("issuerURL")},25))},[t]);let c=async e=>{i({projectRef:n,oidcIssuerUrl:e.issuerURL})};return(0,a.jsx)(tf.lG,{open:t,onOpenChange:()=>s(),"data-sentry-element":"Dialog","data-sentry-component":"CreateWorkOSIntegrationDialog","data-sentry-source-file":"CreateWorkOSDialog.tsx",children:(0,a.jsxs)(tf.Cf,{"data-sentry-element":"DialogContent","data-sentry-source-file":"CreateWorkOSDialog.tsx",children:[(0,a.jsx)(tf.c7,{"data-sentry-element":"DialogHeader","data-sentry-source-file":"CreateWorkOSDialog.tsx",children:(0,a.jsx)(tf.L3,{className:"truncate","data-sentry-element":"DialogTitle","data-sentry-source-file":"CreateWorkOSDialog.tsx",children:"Add new WorkOS connection"})}),(0,a.jsx)(eI.w,{"data-sentry-element":"Separator","data-sentry-source-file":"CreateWorkOSDialog.tsx"}),(0,a.jsx)(tf.OO,{"data-sentry-element":"DialogSection","data-sentry-source-file":"CreateWorkOSDialog.tsx",children:(0,a.jsx)(ea.lV,{...d,"data-sentry-element":"Form_Shadcn_","data-sentry-source-file":"CreateWorkOSDialog.tsx",children:(0,a.jsxs)("form",{id:tO,onSubmit:d.handleSubmit(c),className:"space-y-4",children:[(0,a.jsx)("p",{className:"text-sm text-foreground-light",children:"Enables a JWT from WorkOS to access data from this Supabase project."}),(0,a.jsx)(ea.zB,{control:d.control,name:"issuerURL",render:e=>{let{field:t}=e;return(0,a.jsx)(en.M,{label:"WorkOS Issuer URL",description:"Obtain your issuer URL from the WorkOS dashboard.",children:(0,a.jsx)(ea.MJ,{children:(0,a.jsx)(eN.p,{...t,placeholder:"https://api.workos.com/user_management/client_ABCDEFGHIJKLMNOPQRSTUVWXYZ"})})})},"data-sentry-element":"FormField_Shadcn_","data-sentry-source-file":"CreateWorkOSDialog.tsx"},"issuerURL")]})})}),(0,a.jsxs)(tf.Es,{"data-sentry-element":"DialogFooter","data-sentry-source-file":"CreateWorkOSDialog.tsx",children:[!1,(0,a.jsx)(x.$,{disabled:o,type:"default",onClick:()=>s(),"data-sentry-element":"Button","data-sentry-source-file":"CreateWorkOSDialog.tsx",children:"Cancel"}),(0,a.jsx)(x.$,{form:tO,htmlType:"submit",disabled:o,loading:o,"data-sentry-element":"Button","data-sentry-source-file":"CreateWorkOSDialog.tsx",children:"Create connection"})]})]})})};var tk=s(2119);let tB=e=>{switch(e){case"firebase":return(0,a.jsxs)(a.Fragment,{children:["Allow users to use Supabase with Firebase project. You'll need to setup RLS policies for all tables that you want to access with a Firebase JWT token. Additionally, you'll need to add custom code to set the ",(0,a.jsx)("code",{children:"authenticated"})," role to all your present and future users. You can read more in the"," ",(0,a.jsx)("a",{className:"hover:decoration-brand underline hover:text-foreground transition",href:"https://supabase.com/docs/guides/auth",children:"documentation"}),"."]});case"auth0":return(0,a.jsxs)(a.Fragment,{children:["Allow users to use Supabase with Auth0 project. Additional setup may be required. You can read more in the"," ",(0,a.jsx)("a",{className:"hover:decoration-brand underline hover:text-foreground transition",href:"https://supabase.com/docs/guides/auth",children:"documentation"}),"."]});case"awsCognito":return(0,a.jsxs)(a.Fragment,{children:["Allow users to use Supabase with an Amazon Cognito. Additional setup may be required. You can read more in the"," ",(0,a.jsx)("a",{className:"hover:decoration-brand underline hover:text-foreground transition",href:"https://supabase.com/docs/guides/auth/third-party/aws-cognito",children:"documentation"}),"."]});case"clerk":return(0,a.jsxs)(a.Fragment,{children:["Allow users to use Supabase with Clerk. Additional setup may be required. You can read more in the"," ",(0,a.jsx)("a",{className:"hover:decoration-brand underline hover:text-foreground transition",href:"https://supabase.com/docs/guides/auth/third-party/clerk",children:"documentation"}),"."]});case"workos":return(0,a.jsxs)(a.Fragment,{children:["Allow users to use Supabase with WorkOS. Additional setup may be required. You can read more in the"," ",(0,a.jsx)("a",{className:"hover:decoration-brand underline hover:text-foreground transition",href:"https://supabase.com/docs/guides/auth/third-party/workos",children:"documentation"}),"."]});default:return"Custom"}},tH=e=>{var t,s,r,n,i,l;let{type:o,integration:d}=e;switch(o){case"firebase":{let e=(null==(t=d.oidc_issuer_url)?void 0:t.replace("https://securetoken.google.com/",""))||"";return(0,a.jsxs)("div",{className:"text-sm flex flex-row gap-x-4",children:[(0,a.jsx)("span",{className:"text-foreground-light w-36",children:"Firebase Project ID"}),(0,a.jsx)("span",{className:"text-foreground",children:e})]})}case"auth0":let c=(null==(s=d.oidc_issuer_url)?void 0:s.replace("https://","").replace(".auth0.com",""))||"";return(0,a.jsxs)("div",{className:"text-sm flex flex-row gap-x-4",children:[(0,a.jsx)("span",{className:"text-foreground-light w-36",children:"Auth0 Domain Name"}),(0,a.jsx)("span",{className:"text-foreground",children:c})]});case"awsCognito":{let e=(null==(r=d.oidc_issuer_url)?void 0:r.split(".").filter(e=>tv.includes(e))[0])||"",t=(null==(n=d.oidc_issuer_url)?void 0:n.split("/").filter(t=>t.startsWith(e||""))[0])||"";return(0,a.jsxs)("div",{className:"text-sm flex flex-col gap-y-2",children:[(0,a.jsxs)("div",{className:"flex flex-row gap-x-4",children:[(0,a.jsx)("span",{className:"text-foreground-light w-36",children:"Region"}),(0,a.jsx)("span",{className:"text-foreground",children:e})]}),(0,a.jsxs)("div",{className:"flex flex-row gap-x-4",children:[(0,a.jsx)("span",{className:"text-foreground-light w-36",children:"User Pool ID"}),(0,a.jsx)("span",{className:"text-foreground",children:t})]})]})}case"clerk":return(0,a.jsxs)("div",{className:"text-sm flex flex-row gap-x-4",children:[(0,a.jsx)("span",{className:"text-foreground-light w-36",children:"Domain"}),(0,a.jsx)("span",{className:"text-foreground",children:null!=(i=null==d?void 0:d.oidc_issuer_url)?i:""})]});case"workos":return(0,a.jsxs)("div",{className:"text-sm flex flex-row gap-x-4",children:[(0,a.jsx)("span",{className:"text-foreground-light w-36",children:"Issuer URL"}),(0,a.jsx)("span",{className:"text-foreground",children:null!=(l=null==d?void 0:d.oidc_issuer_url)?l:""})]});default:return(0,a.jsx)(a.Fragment,{children:"Custom"})}},tW=e=>{let{integration:t,canUpdateConfig:s,onDelete:r}=e,n=td(t);return"custom"===n?null:(0,a.jsx)(a.Fragment,{children:(0,a.jsxs)("div",{className:"bg-surface-100 border overflow-hidden shadow px-5 py-4 flex flex-row first:rounded-t-md last:rounded-b-md space-x-4",children:[(0,a.jsx)("div",{className:"py-1",children:(0,a.jsx)(tl(),{src:tu(n),width:21,height:21,alt:"".concat(n," icon"),"data-sentry-element":"Image","data-sentry-source-file":"IntegrationCard.tsx"})}),(0,a.jsxs)("div",{className:"flex flex-col flex-0 overflow-y-auto w-full gap-y-4",children:[(0,a.jsxs)("div",{className:"text-sm flex flex-col",children:[(0,a.jsx)("span",{className:"text-foreground",children:tc(n)}),(0,a.jsx)("div",{className:"text-foreground-lighter",children:tB(n)})]}),(0,a.jsx)(tH,{type:n,integration:t,"data-sentry-element":"IntegrationTypeContent","data-sentry-source-file":"IntegrationCard.tsx"}),(0,a.jsx)("div",{children:(0,a.jsx)(x.$,{type:"danger",disabled:!s,onClick:()=>r(),"data-sentry-element":"Button","data-sentry-source-file":"IntegrationCard.tsx",children:"Delete integration"})})]}),(0,a.jsx)("div",{className:"flex-1",children:(0,a.jsxs)(tk.E,{className:"space-x-1",size:"large",variant:"brand",children:[(0,a.jsx)("div",{className:"h-3.5 w-3.5 bg-brand rounded-full flex justify-center items-center",children:(0,a.jsx)(S.A,{className:"h-2 w-2 text-background-overlay",strokeWidth:6})}),(0,a.jsx)("span",{children:"Enabled"})]})})]})})},tz=()=>{let{ref:e}=(0,l.g)(),{data:t,isLoading:s,isError:r,isSuccess:n,error:i}=ta({projectRef:e}),d=t||[],[c,u]=(0,y.useState)(),[h,m]=(0,y.useState)(),{mutateAsync:x}=te(),{can:p}=(0,M.hl)(f.aG.UPDATE,"custom_config_gotrue");return r?(0,a.jsx)(ed.A,{error:i,subject:"Failed to retrieve auth configuration for Third Party Auth Integrations"}):(0,a.jsxs)(o.gu,{isFullWidth:!0,"data-sentry-element":"ScaffoldSection","data-sentry-component":"ThirdPartyAuthForm","data-sentry-source-file":"index.tsx",children:[(0,a.jsxs)("div",{className:"flex justify-between gap-4",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)(o.sZ,{"data-sentry-element":"ScaffoldSectionTitle","data-sentry-source-file":"index.tsx",children:"Third Party Auth"}),(0,a.jsxs)(o.aw,{className:"mb-6","data-sentry-element":"ScaffoldSectionDescription","data-sentry-source-file":"index.tsx",children:["Use third-party authentication (TPA) systems based on JWTs to access your project.",(0,a.jsx)("br",{}),"Billing is based on the number of monthly active users (MAUs) requesting your API throughout the billing period. Refer to our"," ",(0,a.jsx)(Q.g,{href:"https://supabase.com/docs/guides/platform/manage-your-usage/monthly-active-users-third-party","data-sentry-element":"InlineLink","data-sentry-source-file":"index.tsx",children:"billing docs"})," ","for more information."]})]}),(0,a.jsxs)("div",{className:"flex items-center gap-2 ",children:[(0,a.jsx)(v.A,{href:"https://supabase.com/docs/guides/auth/third-party/overview","data-sentry-element":"DocsButton","data-sentry-source-file":"index.tsx"}),0!==d.length&&(0,a.jsx)(tm,{onSelectIntegrationType:u})]})]}),s&&(0,a.jsx)("div",{className:(0,tr.cn)("border rounded border-default px-20 py-16 flex flex-col items-center justify-center space-y-4"),children:(0,a.jsx)(e5.A,{size:24,className:"animate-spin"})}),n?0===d.length?(0,a.jsxs)("div",{className:(0,tr.cn)("border rounded border-default px-20 py-16 flex flex-col items-center justify-center space-y-4"),children:[(0,a.jsx)("p",{className:"text-sm text-foreground-light",children:"No providers configured yet"}),(0,a.jsx)(tm,{align:"center",buttonText:"Add a new integration",onSelectIntegrationType:u})]}):(0,a.jsx)("div",{className:"-space-y-px",children:d.map(e=>(0,a.jsx)(tW,{integration:e,canUpdateConfig:p,onDelete:()=>{m(e)}},e.id))}):null,(0,a.jsx)(tD,{visible:"firebase"===c,onDelete:()=>{},onClose:()=>u(void 0),"data-sentry-element":"CreateFirebaseAuthIntegrationDialog","data-sentry-source-file":"index.tsx"}),(0,a.jsx)(tC,{visible:"awsCognito"===c,onDelete:()=>{},onClose:()=>u(void 0),"data-sentry-element":"CreateAwsCognitoAuthIntegrationDialog","data-sentry-source-file":"index.tsx"}),(0,a.jsx)(ty,{visible:"auth0"===c,onDelete:()=>{},onClose:()=>u(void 0),"data-sentry-element":"CreateAuth0IntegrationDialog","data-sentry-source-file":"index.tsx"}),(0,a.jsx)(tw,{visible:"clerk"===c,onDelete:()=>{},onClose:()=>u(void 0),"data-sentry-element":"CreateClerkAuthIntegrationDialog","data-sentry-source-file":"index.tsx"}),(0,a.jsx)(tU,{visible:"workos"===c,onDelete:()=>{},onClose:()=>u(void 0),"data-sentry-element":"CreateWorkOSIntegrationDialog","data-sentry-source-file":"index.tsx"}),(0,a.jsx)(ek.A,{size:"medium",visible:!!h,variant:"destructive",title:"Confirm to delete integration",confirmLabel:"Delete",confirmLabelLoading:"Deleting",onCancel:()=>m(void 0),onConfirm:async()=>{if(!h)return;let t=td(h);try{await x({projectRef:e,tpaId:h.id}),A.oR.success("Successfully deleted ".concat(tc(t),".")),m(void 0),u(void 0)}catch(e){A.oR.error("Failed to delete ".concat(tc(t),".")),console.error(e)}},"data-sentry-element":"ConfirmationModal","data-sentry-source-file":"index.tsx",children:(0,a.jsxs)("p",{className:"text-sm text-foreground-light",children:["Are you sure you want to delete the"," ",tc(td(h))," integration?"]})})]})}},98969:(e,t,s)=>{"use strict";s.d(t,{A:()=>n});var a=s(80263),r=s(87610);let n=e=>{let{resourceText:t,isFullPage:s=!1}=e,n=()=>(0,a.jsx)("div",{className:"block w-full rounded border border-opacity-20 py-4 px-6 border-overlay bg-surface-200","data-sentry-component":"NoPermissionMessage","data-sentry-source-file":"NoPermission.tsx",children:(0,a.jsxs)("div",{className:"flex space-x-3",children:[(0,a.jsx)("div",{className:"mt-1",children:(0,a.jsx)(r.A,{size:20,"data-sentry-element":"AlertCircle","data-sentry-source-file":"NoPermission.tsx"})}),(0,a.jsx)("div",{className:"flex w-full items-center justify-between",children:(0,a.jsxs)("div",{className:"space-y-1",children:[(0,a.jsxs)("p",{className:"text-sm",children:["You need additional permissions to ",t]}),(0,a.jsx)("div",{children:(0,a.jsx)("p",{className:"text-sm text-foreground-light",children:"Contact your organization owner or administrator for assistance."})})]})})]})});return s?(0,a.jsx)("div",{className:"flex h-full items-center justify-center",children:(0,a.jsx)("div",{className:"w-[550px]",children:(0,a.jsx)(n,{})})}):(0,a.jsx)(n,{})}}}]);