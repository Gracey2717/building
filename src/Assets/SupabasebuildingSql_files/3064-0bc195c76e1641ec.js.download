try{!function(){var e="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof globalThis?globalThis:"undefined"!=typeof self?self:{},t=(new e.Error).stack;t&&(e._sentryDebugIds=e._sentryDebugIds||{},e._sentryDebugIds[t]="b4d998b7-0ae6-4420-a301-588445f9355f",e._sentryDebugIdIdentifier="sentry-dbid-b4d998b7-0ae6-4420-a301-588445f9355f")}()}catch(e){}"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[3064],{12070:(e,t,s)=>{s.d(t,{I:()=>u});var n=s(80263),a=s(53239),r=s(9681),i=s(40022),o=s(51500),l=s(38417),d=s(74245),c=s(19428);let u=e=>{let{title:t,options:s=[],activeOptions:u=[],valueKey:m,labelKey:x,iconKey:h="icon",name:p="default",variant:f="rectangular",buttonType:v,disabled:y,labelClass:g,className:j,maxHeightClass:b="h-[205px]",clearButtonText:w="Clear",onSaveFilters:_}=e,[k,N]=(0,a.useState)(!1),[C,A]=(0,a.useState)([]),S=u.map(e=>{let t=s.find(t=>t[m]===e);return t&&t[x]?t[x]:""});return(0,a.useEffect)(()=>{!k&&u.length>0&&A(u)},[k,u]),(0,n.jsxs)(r.AM,{open:k,onOpenChange:N,"data-sentry-element":"Popover_Shadcn_","data-sentry-component":"FilterPopover","data-sentry-source-file":"FilterPopover.tsx",children:[(0,n.jsx)(r.Wv,{asChild:!0,"data-sentry-element":"PopoverTrigger_Shadcn_","data-sentry-source-file":"FilterPopover.tsx",children:(0,n.jsx)(i.$,{asChild:!0,disabled:y,type:null!=v?v:u.length>0?"default":"dashed",onClick:()=>N(!1),className:"rounded"===f?"rounded-full":"","data-sentry-element":"Button","data-sentry-source-file":"FilterPopover.tsx",children:(0,n.jsxs)("div",{children:[(0,n.jsx)("span",{children:p}),u.length>0&&(0,n.jsx)("span",{className:"mr-1",children:":"}),u.length>=3?(0,n.jsxs)("span",{children:[S[0]," and ",u.length-1," others"]}):u.length>0?(0,n.jsx)("span",{children:S.join(", ")}):null]})})}),(0,n.jsxs)(r.hl,{className:(0,o.cn)("p-0 w-44",j),align:"start",portal:!0,"data-sentry-element":"PopoverContent_Shadcn_","data-sentry-source-file":"FilterPopover.tsx",children:[(0,n.jsx)("div",{className:"border-b border-overlay bg-surface-200 rounded-t pb-1 px-3",children:(0,n.jsx)("span",{className:"text-xs text-foreground-light",children:null!=t?t:"Select ".concat(p.toLowerCase())})}),(0,n.jsx)(l.FK,{className:s.length>7?b:"","data-sentry-element":"ScrollArea","data-sentry-source-file":"FilterPopover.tsx",children:(0,n.jsx)("div",{className:"p-3 flex flex-col gap-y-2",children:s.map(e=>{let t=e[m],s=h?e[h]:void 0;return(0,n.jsxs)("div",{className:"flex items-center gap-x-2",children:[(0,n.jsx)(d.S,{id:t,checked:C.includes(t),onCheckedChange:()=>{C.includes(t)?A(C.filter(e=>e!==t)):A(C.concat(t))}}),(0,n.jsxs)(c.J,{htmlFor:e[m],className:(0,o.cn)("flex items-center gap-x-2 text-xs",g),children:[s&&(0,n.jsx)("img",{src:s,alt:e[x],className:(0,o.cn)("w-4 h-4",e.iconClass)}),(0,n.jsx)("span",{children:e[x]})]})]},t)})})}),(0,n.jsxs)("div",{className:"flex items-center justify-end gap-2 border-t border-overlay bg-surface-200 py-2 px-3",children:[(0,n.jsx)(i.$,{size:"tiny",type:"default",onClick:()=>{_([]),A([]),N(!1)},"data-sentry-element":"Button","data-sentry-source-file":"FilterPopover.tsx",children:w}),(0,n.jsx)(i.$,{type:"primary",onClick:()=>{let e=s.map(e=>e[m]);_(C.sort((t,s)=>e.indexOf(t)-e.indexOf(s))),N(!1)},"data-sentry-element":"Button","data-sentry-source-file":"FilterPopover.tsx",children:"Save"})]})]})]})}},21957:(e,t,s)=>{s.d(t,{AF:()=>l,GS:()=>i,UC:()=>o,jU:()=>r});var n=s(63492),a=s(73875);let r="px-5 py-5",i=20,o=a.S5.map(e=>({name:e.title,value:"key"in e?e.key:e.title.toLowerCase(),icon:"".concat(n.o2,"/img/icons/").concat(e.misc.iconKey,".svg"),iconClass:"GitHub"===e.title?"dark:invert":""})).concat(a.ns.properties.SMS_PROVIDER.enum.map(e=>({name:e.label,value:e.value,icon:"".concat(n.o2,"/img/icons/").concat(e.icon),iconClass:""}))),l=[{id:"img",name:"",minWidth:95,width:95,resizable:!1},{id:"id",name:"UID",width:280},{id:"name",name:"Display name",minWidth:0,width:150},{id:"email",name:"Email",width:300},{id:"phone",name:"Phone"},{id:"providers",name:"Providers",minWidth:150},{id:"provider_type",name:"Provider type",minWidth:150},{id:"created_at",name:"Created at",width:260},{id:"last_sign_in_at",name:"Last sign in at",width:260}]},22759:(e,t,s)=>{s.d(t,{dS:()=>ed,$U:()=>el,nz:()=>eo});var n=s(80263),a=s(60045),r=s(53434),i=s.n(r),o=s(80903),l=s(8854),d=s(60372);let c=(0,s(15740).A)("Ban",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m4.9 4.9 14.2 14.2",key:"1m5liu"}]]);var u=s(17089),m=s(25643),x=s(29012),h=s(15601),p=s.n(h),f=s(53239),v=s(73969),y=s(75232),g=s(88602),j=s(55006),b=s(5816),w=s(80251),_=s(65172);async function k(e){let{projectRef:t,userId:s}=e,{data:n,error:a}=await (0,_.yH)("/platform/auth/{ref}/users/{id}/factors",{params:{path:{ref:t,id:s}}});return a&&(0,_.H4)(a),n}let N=function(){let{onSuccess:e,onError:t,...s}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return(0,w.n)(e=>k(e),{async onSuccess(t,s,n){await (null==e?void 0:e(t,s,n))},async onError(e,s,n){void 0===t?v.oR.error("Failed to delete the user's MFA factors: ".concat(e.message)):t(e,s,n)},...s})};async function C(e){let{projectRef:t,user:s}=e,{data:n,error:a}=await (0,_.bE)("/platform/auth/{ref}/recover",{params:{path:{ref:t}},body:{email:s.email}});return a&&(0,_.H4)(a),n}let A=function(){let{onSuccess:e,onError:t,...s}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return(0,w.n)(e=>C(e),{async onSuccess(t,s,n){await (null==e?void 0:e(t,s,n))},async onError(e,s,n){void 0===t?v.oR.error("Failed to reset user password: ".concat(e.message)):t(e,s,n)},...s})};async function S(e){let{projectRef:t,user:s}=e,{data:n,error:a}=await (0,_.bE)("/platform/auth/{ref}/magiclink",{params:{path:{ref:t}},body:{email:s.email}});return a&&(0,_.H4)(a),n}let U=function(){let{onSuccess:e,onError:t,...s}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return(0,w.n)(e=>S(e),{async onSuccess(t,s,n){await (null==e?void 0:e(t,s,n))},async onError(e,s,n){void 0===t?v.oR.error("Failed to send magic link: ".concat(e.message)):t(e,s,n)},...s})};async function M(e){let{projectRef:t,user:s}=e,{data:n,error:a}=await (0,_.bE)("/platform/auth/{ref}/otp",{params:{path:{ref:t}},body:{phone:s.phone}});return a&&(0,_.H4)(a),n}let O=function(){let{onSuccess:e,onError:t,...s}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return(0,w.n)(e=>M(e),{async onSuccess(t,s,n){await (null==e?void 0:e(t,s,n))},async onError(e,s,n){void 0===t?v.oR.error("Failed to send magic link: ".concat(e.message)):t(e,s,n)},...s})};var F=s(32144),R=s(58982);async function D(e){let{projectRef:t,userId:s,banDuration:n}=e,{data:a,error:r}=await (0,_.F6)("/platform/auth/{ref}/users/{id}",{params:{path:{ref:t,id:s}},body:{ban_duration:"number"==typeof n?"".concat(n,"h"):n}});return r&&(0,_.H4)(r),a}let L=function(){let{onSuccess:e,onError:t,...s}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=(0,F.jE)();return(0,w.n)(e=>D(e),{async onSuccess(t,s,a){let{projectRef:r}=s;await n.invalidateQueries(R.Z.usersInfinite(r)),await (null==e?void 0:e(t,s,a))},async onError(e,s,n){void 0===t?v.oR.error("Failed to update user: ".concat(e.message)):t(e,s,n)},...s})};var E=s(75019),P=s(97600),T=s(63492),I=s(34531),H=s(51500),z=s(77635),B=s(40022),W=s(47142),Y=s(50204),G=s(73875),Z=s(32981),$=s(87494),V=s(10663),q=s(67120),X=s(47452),Q=s(93210),J=s(40990),K=s(67258);let ee=e=>{let{visible:t,user:s,onClose:a}=e,{ref:r}=(0,y.g)(),{mutate:o,isLoading:l}=L({onSuccess:(e,t)=>{let s=i()().add(Number(t.banDuration),"hours").format("DD MMM YYYY HH:mm (ZZ)");v.oR.success("User banned successfully until ".concat(s)),a()}}),d=V.Ik({value:V.Yj().min(1,{message:"Please provide a duration"}),unit:V.k5(["hours","days"])}),c={value:"24",unit:"hours"},u=(0,$.mN)({mode:"onBlur",reValidateMode:"onChange",resolver:(0,Z.u)(d),defaultValues:c}),{value:m,unit:x}=u.watch(),h=i()().add(Number(m),x).format("DD MMM YYYY HH:mm (ZZ)");return(0,f.useEffect)(()=>{t&&u.reset(c)},[t]),(0,n.jsx)(q.A,{hideFooter:!0,visible:t,size:"small",header:"Confirm to ban user",onCancel:()=>a(),"data-sentry-element":"Modal","data-sentry-component":"BanUserModal","data-sentry-source-file":"BanUserModal.tsx",children:(0,n.jsx)(X.lV,{...u,"data-sentry-element":"Form_Shadcn_","data-sentry-source-file":"BanUserModal.tsx",children:(0,n.jsxs)("form",{onSubmit:u.handleSubmit(e=>{if(void 0===r)return console.error("Project ref is required");if(void 0===s.id)return v.oR.error("Failed to ban user: User ID not found");let t="hours"===e.unit?Number(e.value):24*Number(e.value);o({projectRef:r,userId:s.id,banDuration:t})}),children:[(0,n.jsxs)(q.A.Content,{className:"flex flex-col gap-y-3","data-sentry-element":"Modal.Content","data-sentry-source-file":"BanUserModal.tsx",children:[(0,n.jsx)("p",{className:"text-sm",children:"This will revoke the user's access to your project and prevent them from logging in for a specified duration."}),(0,n.jsxs)("div",{className:"flex items-start gap-x-2 [&>div:first-child]:flex-grow",children:[(0,n.jsx)(X.zB,{control:u.control,name:"value",render:e=>{let{field:t}=e;return(0,n.jsx)(K.M,{className:"[&>div>div]:mt-0",label:"Set a ban duration",children:(0,n.jsx)(X.MJ,{children:(0,n.jsx)(Q.p,{...t})})})},"data-sentry-element":"FormField_Shadcn_","data-sentry-source-file":"BanUserModal.tsx"}),(0,n.jsx)(X.zB,{control:u.control,name:"unit",render:e=>{let{field:t}=e;return(0,n.jsx)(K.M,{className:"[&>div>div]:mt-0 mt-[33px]",children:(0,n.jsx)(X.MJ,{children:(0,n.jsxs)(J.l6,{...t,value:t.value,onValueChange:e=>u.setValue("unit",e),children:[(0,n.jsx)(J.bq,{className:"capitalize w-24",children:t.value}),(0,n.jsxs)(J.gC,{children:[(0,n.jsx)(J.eb,{value:"hours",children:"Hours"}),(0,n.jsx)(J.eb,{value:"days",children:"Days"})]})]})})})},"data-sentry-element":"FormField_Shadcn_","data-sentry-source-file":"BanUserModal.tsx"})]}),(0,n.jsxs)("div",{children:[(0,n.jsx)("p",{className:"text-sm text-foreground-lighter",children:"This user will not be able to log in until:"}),(0,n.jsx)("p",{className:(0,H.cn)("text-sm",!m&&"text-foreground-light"),children:m?h:"Invalid duration set"})]})]}),(0,n.jsx)(z.w,{"data-sentry-element":"Separator","data-sentry-source-file":"BanUserModal.tsx"}),(0,n.jsxs)(q.A.Content,{className:"flex justify-end gap-2","data-sentry-element":"Modal.Content","data-sentry-source-file":"BanUserModal.tsx",children:[(0,n.jsx)(B.$,{type:"default",disabled:l,onClick:()=>a(),"data-sentry-element":"Button","data-sentry-source-file":"BanUserModal.tsx",children:"Cancel"}),(0,n.jsx)(B.$,{type:"warning",htmlType:"submit",loading:l,"data-sentry-element":"Button","data-sentry-source-file":"BanUserModal.tsx",children:"Confirm ban"})]})]})})})};var et=s(29622),es=s(95301),en=s(21957),ea=s(26005);let er="DD MMM, YYYY HH:mm",ei=(0,H.cn)("bg-surface-100 border-default text-foreground flex items-center justify-between","gap-x-4 border px-5 py-4 text-sm first:rounded-tr first:rounded-tl last:rounded-br last:rounded-bl"),eo=e=>{var t,s,r,m,x;let{user:h,onDeleteSuccess:g}=e,{ref:j}=(0,y.g)(),w=null!==h.email,_=null!==h.phone,k=null!==h.banned_until,{authenticationSignInProviders:C}=(0,P.x)(["authentication:sign_in_providers"]),S=(null!=(s=null==(t=h.raw_app_meta_data)?void 0:t.providers)?s:[]).map(e=>({name:e.startsWith("sso")?"SAML":e,icon:"email"===e?"".concat(T.o2,"/img/icons/email-icon2.svg"):ea.FI[e]?"".concat(T.o2,"/img/icons/").concat(ea.FI[e],".svg"):void 0})),{can:M}=(0,E.hl)(a.aG.AUTH_EXECUTE,"*"),{can:F}=(0,E.hl)(a.aG.AUTH_EXECUTE,"send_magic_link"),{can:R}=(0,E.hl)(a.aG.AUTH_EXECUTE,"send_recovery"),{can:D}=(0,E.hl)(a.aG.AUTH_EXECUTE,"send_otp"),{can:Z}=(0,E.hl)(a.aG.TENANT_SQL_DELETE,"auth.users"),{can:$}=(0,E.hl)(a.aG.TENANT_SQL_DELETE,"auth.mfa_factors"),[V,q]=(0,f.useState)(),[X,Q]=(0,f.useState)(!1),[J,K]=(0,f.useState)(!1),[eo,ec]=(0,f.useState)(!1),[eu,em]=(0,f.useState)(!1),{data:ex}=(0,b.op)({projectRef:j}),eh=null!=(r=null==ex?void 0:ex.MAILER_OTP_EXP)?r:0,ep=Math.floor(eh/60),ef=Math.floor(eh%60),ev="".concat(eh>60?"".concat(ep," minute").concat(ep>1?"s":""," ").concat(ef>0?"and":""," "):"").concat(ef>0?"".concat(ef," second").concat(ef>1?"s":""):""),{mutate:ey,isLoading:eg}=A({onSuccess:(e,t)=>{q("send_recovery"),v.oR.success("Sent password recovery to ".concat(t.user.email))},onError:e=>{v.oR.error("Failed to send password recovery: ".concat(e.message))}}),{mutate:ej,isLoading:eb}=U({onSuccess:(e,t)=>{q("send_magic_link"),v.oR.success("Sent magic link to ".concat(t.user.email))},onError:e=>{v.oR.error("Failed to send magic link: ".concat(e.message))}}),{mutate:ew,isLoading:e_}=O({onSuccess:(e,t)=>{q("send_otp"),v.oR.success("Sent OTP to ".concat(t.user.phone))},onError:e=>{v.oR.error("Failed to send OTP: ".concat(e.message))}}),{mutate:ek}=N({onSuccess:()=>{v.oR.success("Successfully deleted the user's factors"),em(!1)}}),{mutate:eN,isLoading:eC}=L({onSuccess:()=>{v.oR.success("Successfully unbanned user"),K(!1)}}),eA=async()=>{if(await (0,I.wR)(200),!j)return console.error("Project ref is required");ek({projectRef:j,userId:h.id})},eS=()=>void 0===j?console.error("Project ref is required"):void 0===h.id?v.oR.error("Failed to ban user: User ID not found"):void eN({projectRef:j,userId:h.id,banDuration:"none"});return(0,f.useEffect)(()=>{if(void 0!==V){let e=setTimeout(()=>q(void 0),5e3);return()=>clearTimeout(e)}},[V]),(0,n.jsxs)(n.Fragment,{children:[(0,n.jsxs)("div",{children:[(0,n.jsx)(es.x,{user:h,"data-sentry-element":"UserHeader","data-sentry-source-file":"UserOverview.tsx"}),k?(0,n.jsx)(W.Z,{type:"warning",label:"User banned until ".concat(i()(h.banned_until).format(er)),className:"border-r-0 border-l-0 rounded-none -mt-px [&_svg]:ml-0.5 mb-0"}):(0,n.jsx)(z.w,{}),(0,n.jsxs)("div",{className:(0,H.cn)("flex flex-col gap-y-1",en.jU),children:[(0,n.jsx)(el,{property:"User UID",value:h.id,"data-sentry-element":"RowData","data-sentry-source-file":"UserOverview.tsx"}),(0,n.jsx)(el,{property:"Created at",value:h.created_at?i()(h.created_at).format(er):void 0,"data-sentry-element":"RowData","data-sentry-source-file":"UserOverview.tsx"}),(0,n.jsx)(el,{property:"Updated at",value:h.updated_at?i()(h.updated_at).format(er):void 0,"data-sentry-element":"RowData","data-sentry-source-file":"UserOverview.tsx"}),(0,n.jsx)(el,{property:"Invited at",value:h.invited_at,"data-sentry-element":"RowData","data-sentry-source-file":"UserOverview.tsx"}),(0,n.jsx)(el,{property:"Confirmation sent at",value:h.confirmation_sent_at,"data-sentry-element":"RowData","data-sentry-source-file":"UserOverview.tsx"}),(0,n.jsx)(el,{property:"Confirmed at",value:h.confirmed_at?i()(h.confirmed_at).format(er):void 0,"data-sentry-element":"RowData","data-sentry-source-file":"UserOverview.tsx"}),(0,n.jsx)(el,{property:"Last signed in",value:h.last_sign_in_at?i()(h.last_sign_in_at).format(er):void 0,"data-sentry-element":"RowData","data-sentry-source-file":"UserOverview.tsx"}),(0,n.jsx)(el,{property:"SSO",value:h.is_sso_user,"data-sentry-element":"RowData","data-sentry-source-file":"UserOverview.tsx"})]}),(0,n.jsxs)("div",{className:(0,H.cn)("flex flex-col !pt-0",en.jU),children:[(0,n.jsx)("p",{children:"Provider Information"}),(0,n.jsx)("p",{className:"text-sm text-foreground-light",children:"The user has the following providers"})]}),(0,n.jsx)("div",{className:(0,H.cn)("flex flex-col -space-y-1 !pt-0",en.jU),children:S.map(e=>{var t,s,a;let r=G.S5.find(t=>"key"in t&&t.key===e.name||t.title.toLowerCase()===e.name),i=Object.keys(null!=(t=null==r?void 0:r.properties)?t:{}).find(e=>e.toLowerCase().endsWith("_enabled")),l="email"===e.name?e.name.toLowerCase():null!=(s=null==r?void 0:r.title)?s:e.name,d=null!=(a=null==ex?void 0:ex[i])&&a;return(0,n.jsxs)("div",{className:(0,H.cn)(ei,"items-start justify-start"),children:[e.icon&&(0,n.jsx)("img",{width:16,src:e.icon,alt:"".concat(e.name," auth icon"),className:(0,H.cn)("mt-1.5","github"===e.name?"dark:invert":"")}),(0,n.jsxs)("div",{className:"flex-grow mt-0.5",children:[(0,n.jsx)("p",{className:"capitalize",children:l}),(0,n.jsxs)("p",{className:"text-xs text-foreground-light",children:["Signed in with a ",l," account via"," ","SAML"===l?"SSO":"OAuth"]}),C&&(0,n.jsx)(B.$,{asChild:!0,type:"default",className:"mt-2",children:(0,n.jsxs)(p(),{href:"/project/".concat(j,"/auth/providers?provider=").concat("SAML"===e.name?"SAML 2.0":e.name),children:["Configure ",l," provider"]})})]}),d?(0,n.jsxs)("div",{className:"flex items-center gap-1 rounded-full border border-brand-400 bg-brand-200 py-1 px-1 text-xs text-brand",children:[(0,n.jsx)("span",{className:"rounded-full bg-brand p-0.5 text-xs text-brand-200",children:(0,n.jsx)(o.A,{strokeWidth:2,size:12})}),(0,n.jsx)("span",{className:"px-1",children:"Enabled"})]}):(0,n.jsx)("div",{className:"rounded-md border border-strong bg-surface-100 py-1 px-3 text-xs text-foreground-lighter",children:"Disabled"})]},e.name)})}),(0,n.jsx)(z.w,{"data-sentry-element":"Separator","data-sentry-source-file":"UserOverview.tsx"}),(0,n.jsxs)("div",{className:(0,H.cn)("flex flex-col -space-y-1",en.jU),children:[w&&(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(ed,{title:"Reset password",description:"Send a password recovery email to the user",button:{icon:(0,n.jsx)(l.A,{}),text:"Send password recovery",isLoading:eg,disabled:!R,onClick:()=>{j&&ey({projectRef:j,user:h})}},success:"send_recovery"===V?{title:"Password recovery sent",description:"The link in the email is valid for ".concat(ev)}:void 0}),(0,n.jsx)(ed,{title:"Send magic link",description:"Passwordless login via email for the user",button:{icon:(0,n.jsx)(l.A,{}),text:"Send magic link",isLoading:eb,disabled:!F,onClick:()=>{j&&ej({projectRef:j,user:h})}},success:"send_magic_link"===V?{title:"Magic link sent",description:"The link in the email is valid for ".concat(ev)}:void 0})]}),_&&(0,n.jsx)(ed,{title:"Send OTP",description:"Passwordless login via phone for the user",button:{icon:(0,n.jsx)(l.A,{}),text:"Send OTP",isLoading:e_,disabled:!D,onClick:()=>{j&&ew({projectRef:j,user:h})}},success:"send_otp"===V?{title:"OTP sent",description:"The link in the OTP SMS is valid for ".concat(ev)}:void 0})]}),(0,n.jsx)(z.w,{"data-sentry-element":"Separator","data-sentry-source-file":"UserOverview.tsx"}),(0,n.jsxs)("div",{className:(0,H.cn)("flex flex-col",en.jU),children:[(0,n.jsx)("p",{children:"Danger zone"}),(0,n.jsx)("p",{className:"text-sm text-foreground-light",children:"Be wary of the following features as they cannot be undone."})]}),(0,n.jsxs)("div",{className:(0,H.cn)("flex flex-col -space-y-1 !pt-0",en.jU),children:[(0,n.jsx)(ed,{title:"Remove MFA factors",description:"Removes all MFA factors associated with the user",button:{icon:(0,n.jsx)(d.A,{}),text:"Remove MFA factors",disabled:!$,onClick:()=>em(!0)},className:"!bg border-destructive-400","data-sentry-element":"RowAction","data-sentry-source-file":"UserOverview.tsx"}),(0,n.jsx)(ed,{title:k?"User is banned until ".concat(i()(h.banned_until).format(er)):"Ban user",description:k?"User has no access to the project until after this date":"Revoke access to the project for a set duration",button:{icon:(0,n.jsx)(c,{}),text:k?"Unban user":"Ban user",disabled:!M,onClick:()=>{k?K(!0):Q(!0)}},className:"!bg border-destructive-400","data-sentry-element":"RowAction","data-sentry-source-file":"UserOverview.tsx"}),(0,n.jsx)(ed,{title:"Delete user",description:"User will no longer have access to the project",button:{icon:(0,n.jsx)(u.A,{}),type:"danger",text:"Delete user",disabled:!Z,onClick:()=>ec(!0)},className:"!bg border-destructive-400","data-sentry-element":"RowAction","data-sentry-source-file":"UserOverview.tsx"})]})]}),(0,n.jsx)(et.i,{visible:eo,selectedUser:h,onClose:()=>ec(!1),onDeleteSuccess:()=>{ec(!1),g()},"data-sentry-element":"DeleteUserModal","data-sentry-source-file":"UserOverview.tsx"}),(0,n.jsx)(Y.A,{visible:eu,variant:"warning",title:"Confirm to remove MFA factors",confirmLabel:"Remove factors",confirmLabelLoading:"Removing",onCancel:()=>em(!1),onConfirm:()=>eA(),alert:{base:{variant:"warning"},title:"Removing MFA factors will drop the user's authentication assurance level (AAL) to AAL1",description:"Note that this does not sign the user out"},"data-sentry-element":"ConfirmationModal","data-sentry-source-file":"UserOverview.tsx",children:(0,n.jsxs)("p",{className:"text-sm text-foreground-light",children:["Are you sure you want to remove the MFA factors for the user"," ",(0,n.jsx)("span",{className:"text-foreground",children:null!=(x=null!=(m=h.email)?m:h.phone)?x:"this user"}),"?"]})}),(0,n.jsx)(ee,{visible:X,user:h,onClose:()=>Q(!1),"data-sentry-element":"BanUserModal","data-sentry-source-file":"UserOverview.tsx"}),(0,n.jsx)(Y.A,{variant:"warning",visible:J,title:"Confirm to unban user",loading:eC,confirmLabel:"Unban user",confirmLabelLoading:"Unbanning",onCancel:()=>K(!1),onConfirm:()=>eS(),"data-sentry-element":"ConfirmationModal","data-sentry-source-file":"UserOverview.tsx",children:(0,n.jsx)("p",{className:"text-sm text-foreground-light",children:"The user will have access to your project again once unbanned. Are you sure you want to unban this user?"})})]})},el=e=>{let{property:t,value:s}=e;return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsxs)("div",{className:"flex items-center gap-x-2 group justify-between",children:[(0,n.jsx)("p",{className:" text-foreground-lighter text-xs",children:t}),"boolean"==typeof s?(0,n.jsx)("div",{className:"h-[26px] flex items-center justify-center min-w-[70px]",children:s?(0,n.jsx)("div",{className:"rounded-full w-4 h-4 dark:bg-white bg-black flex items-center justify-center",children:(0,n.jsx)(o.A,{size:10,className:"text-contrast",strokeWidth:4})}):(0,n.jsx)("div",{className:"rounded-full w-4 h-4 dark:bg-white bg-black flex items-center justify-center",children:(0,n.jsx)(m.A,{size:10,className:"text-contrast",strokeWidth:4})})}):(0,n.jsxs)("div",{className:"flex items-center gap-x-2 h-[26px] font-mono min-w-[40px]",children:[(0,n.jsx)("p",{className:"text-xs",children:s||"-"}),!!s&&(0,n.jsx)(j.A,{iconOnly:!0,type:"text",icon:(0,n.jsx)(x.A,{}),className:"transition opacity-0 group-hover:opacity-100 px-1",text:s})]})]}),(0,n.jsx)(z.w,{"data-sentry-element":"Separator","data-sentry-source-file":"UserOverview.tsx"})]})},ed=e=>{var t,s,a;let{title:r,description:i,button:l,success:d,className:c}=e,u=null!=(t=null==l?void 0:l.disabled)&&t;return(0,n.jsxs)("div",{className:(0,H.cn)(ei,c),"data-sentry-component":"RowAction","data-sentry-source-file":"UserOverview.tsx",children:[(0,n.jsxs)("div",{children:[(0,n.jsx)("p",{children:d?d.title:r}),(0,n.jsx)("p",{className:"text-xs text-foreground-light",children:d?d.description:i})]}),(0,n.jsx)(g.G,{type:null!=(s=null==l?void 0:l.type)?s:"default",icon:d?(0,n.jsx)(o.A,{className:"text-brand"}):l.icon,loading:null!=(a=l.isLoading)&&a,onClick:l.onClick,disabled:u,tooltip:{content:{side:"bottom",text:u?"You need additional permissions to ".concat(l.text.toLowerCase()):void 0}},"data-sentry-element":"ButtonTooltip","data-sentry-source-file":"UserOverview.tsx",children:l.text})]})}},26005:(e,t,s)=>{s.d(t,{yA:()=>D,uJ:()=>C,TW:()=>R,Mn:()=>F,FI:()=>S});var n=s(80263),a=s(53434),r=s.n(a),i=s(59450),o=s(29277),l=s(17089),d=s(24560),c=s(63492),u=s(74245),m=s(51500),x=s(17761),h=s(52647),p=s(73875),f=s(21957),v=s(72259),y=s(48649),g=s(69036),j=s(53239),b=s(71139),w=s(40022);let _=e=>{let{col:t,setSortByValue:s}=e,a=(0,j.useRef)(0),[r,i]=(0,j.useState)(!1);return(0,j.useEffect)(()=>{a.current=Number(new Date)},[r]),(0,n.jsxs)("div",{className:"flex items-center justify-between font-normal text-xs w-full","data-sentry-component":"HeaderCell","data-sentry-source-file":"UsersGridComponents.tsx",children:[(0,n.jsx)("div",{className:"flex items-center gap-x-2",children:(0,n.jsx)("p",{className:"!text-foreground",children:t.name})}),["created_at","email","phone"].includes(t.id)&&(0,n.jsxs)(b.rI,{open:r,onOpenChange:e=>{!1===e&&Number(new Date)-a.current>100&&i(e)},children:[(0,n.jsx)(b.ty,{asChild:!0,children:(0,n.jsx)(w.$,{type:"text",icon:(0,n.jsx)(v.A,{}),className:"p-0 h-5 w-5",onClick:()=>i(!r)})}),(0,n.jsxs)(b.SQ,{className:"w-36",children:[(0,n.jsxs)(b._2,{className:"flex items-center gap-x-2",onClick:()=>{i(!1),s("".concat(t.id,":desc"))},children:[(0,n.jsx)(y.A,{size:14}),"Sort descending"]}),(0,n.jsxs)(b._2,{className:"flex items-center gap-x-2",onClick:()=>{i(!1),s("".concat(t.id,":asc"))},children:[(0,n.jsx)(g.A,{size:14}),"Sort ascending"]})]})]})]})},k="https://avatars.githubusercontent.com",N=[k,"https://lh3.googleusercontent.com"],C=e=>e.map(e=>{var t,s;let n=null!=(s=null==(t=e.raw_app_meta_data)?void 0:t.provider)?s:"",a=e.providers.map(e=>e.startsWith("sso")?"SAML":e);return{id:e.id,email:e.email,phone:e.phone,created_at:e.created_at,last_sign_in_at:e.last_sign_in_at,providers:e.is_anonymous?"-":a,provider_icons:a.map(e=>"email"===e?"".concat(c.o2,"/img/icons/email-icon2.svg"):"SAML"===e?"".concat(c.o2,"/img/icons/saml-icon.svg"):S[e]?"".concat(c.o2,"/img/icons/").concat(S[e],".svg"):void 0).filter(Boolean),provider_type:e.is_anonymous?"Anonymous":"email"===n?"-":U.includes(n)?"Social":M.includes(n)?"Phone":"-",img:R(e),name:F(e)}}),A={social:[{email:"email-icon2"},{apple:"apple-icon"},{azure:"microsoft-icon"},{bitbucket:"bitbucket-icon"},{discord:"discord-icon"},{facebook:"facebook-icon"},{figma:"figma-icon"},{github:"github-icon"},{gitlab:"gitlab-icon"},{google:"google-icon"},{kakao:"kakao-icon"},{keycloak:"keycloak-icon"},{linkedin_oidc:"linkedin-icon"},{notion:"notion-icon"},{twitch:"twitch-icon"},{twitter:"twitter-icon"},{slack_oidc:"slack-icon"},{slack:"slack-icon"},{spotify:"spotify-icon"},{workos:"workos-icon"},{zoom:"zoom-icon"}],phone:[{twilio:"twilio-icon"},{messagebird:"messagebird-icon"},{textlocal:"messagebird-icon"},{vonage:"messagebird-icon"},{twilioverify:"twilio-verify-icon"}]},S=Object.values([...A.social,...A.phone]).reduce((e,t)=>{let[[s,n]]=Object.entries(t);return{...e,[s]:n}},{}),U=A.social.map(e=>{let[t]=Object.keys(e);return t}),M=A.phone.map(e=>{let[t]=Object.keys(e);return t});function O(e){if(e){if("string"==typeof e)return e;if(Array.isArray(e))return e.map(e=>O(e)).join(" ");try{return JSON.stringify(e)}catch(e){}}}function F(e){var t;let s=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"-",{custom_claims:n,displayName:a,display_name:r,fullName:i,full_name:o,familyName:l,family_name:d,givenName:c,given_name:u,surname:m,lastName:x,last_name:h,firstName:p,first_name:f}=null!=(t=e.raw_user_meta_data)?t:{},{displayName:v,display_name:y,fullName:g,full_name:j,familyName:b,family_name:w,givenName:_,given_name:k,surname:N,lastName:C,last_name:A,firstName:S,first_name:U}=null!=n?n:{},M=O(l||d||m||x||h||b||w||N||C||A),F=O(c||u||p||f||_||k||S||U);return O(a||r||v||y||i||o||g||j||F&&M&&"".concat(F," ").concat(M)||M||F)||s}function R(e){var t;let{avatarUrl:s,avatarURL:n,avatar_url:a,profileUrl:r,profileURL:i,profile_url:o,profileImage:l,profile_image:d,profileImageUrl:c,profileImageURL:u,profile_image_url:m}=null!=(t=e.raw_user_meta_data)?t:{},x=s||n||a||l||d||r||i||o||c||u||m||"";if("string"!=typeof x)return;let h=N.some(e=>x.startsWith(e));try{let e=new URL(x);return e.searchParams.set("s","24"),h?x.startsWith(k)?e.href:x:void 0}catch(e){return h?x:void 0}}let D=e=>{var t;let{config:s,users:a,visibleColumns:c=[],setSortByValue:v,onSelectDeleteUser:y}=e,g=null!=(t=s.map(e=>e.id))?t:f.AF.map(e=>e.id),j=f.AF.map(e=>{var t,c,f;let g=s.find(t=>t.id===e.id);return{key:e.id,name:e.name,resizable:null==(t=e.resizable)||t,sortable:!1,draggable:!0,width:null!=(c=null==g?void 0:g.width)?c:e.width,minWidth:null!=(f=e.minWidth)?f:120,headerCellClass:"z-50 outline-none !shadow-none",renderHeaderCell:()=>{if("img"!==e.id)return(0,n.jsx)(_,{col:e,setSortByValue:v})},renderCell:t=>{let{row:s}=t,[c,f]=(0,d.Uk)(),v=null==s?void 0:s[e.id],g=null==a?void 0:a.find(e=>e.id===s.id),j=null!==v&&["created_at","last_sign_in_at"].includes(e.id)?r()(v).format("ddd DD MMM YYYY HH:mm:ss [GMT]ZZ"):Array.isArray(v)?"providers"===e.id?v.map(e=>{let t=p.S5.find(t=>"key"in t&&t.key===e||t.title.toLowerCase()===e);return null==t?void 0:t.title}).join(", "):v.join(", "):v,b=!!(null==g?void 0:g.confirmed_at);return"img"===e.id?(0,n.jsxs)("div",{className:"flex items-center justify-center gap-x-2",children:[(0,n.jsx)(u.S,{checked:c,onClick:e=>{e.stopPropagation(),f({row:s,type:"ROW",checked:!c,isShiftClick:e.shiftKey})}}),(0,n.jsx)("div",{className:(0,m.cn)("flex items-center justify-center w-6 h-6 rounded-full bg-center bg-cover bg-no-repeat",s.img?"border":"bg-selection"),style:{backgroundImage:s.img?"url('".concat(s.img,"')"):"none"},children:!s.img&&(0,n.jsx)(i.A,{size:12})})]}):(0,n.jsxs)(x.tz,{children:[(0,n.jsx)(x.Rc,{asChild:!0,children:(0,n.jsxs)("div",{className:(0,m.cn)("w-full flex items-center text-xs",e.id.includes("provider")?"capitalize":""),children:["providers"===e.id&&s.provider_icons.map((e,t)=>{let a=s.providers[t];return(0,n.jsx)("div",{className:"min-w-6 min-h-6 rounded-full border flex items-center justify-center bg-surface-75",style:{marginLeft:0===t?0:"-8px",zIndex:s.provider_icons.length-t},children:(0,n.jsx)("img",{width:16,src:e,alt:"".concat(a," auth icon"),className:(0,m.cn)("github"===a&&"dark:invert")},"".concat(null==g?void 0:g.id,"-").concat(a))})}),"last_sign_in_at"!==e.id||b?(0,n.jsx)("p",{className:(0,m.cn)("providers"===e.id&&"ml-1"),children:null===j?"-":j}):(0,n.jsx)("p",{className:"text-foreground-lighter",children:"Waiting for verification"})]})}),(0,n.jsxs)(x.Ip,{onClick:e=>e.stopPropagation(),children:[(0,n.jsxs)(x.kt,{className:"gap-x-2",onFocusCapture:e=>e.stopPropagation(),onSelect:()=>{let t="providers"===e.id?s.providers.join(", "):j;(0,h.l)(t)},children:[(0,n.jsx)(o.A,{size:12}),(0,n.jsxs)("span",{children:["Copy ","id"===e.id?e.name:e.name.toLowerCase()]})]}),(0,n.jsx)(x.K5,{}),(0,n.jsxs)(x.kt,{className:"gap-x-2",onFocusCapture:e=>e.stopPropagation(),onSelect:()=>{g&&y(g)},children:[(0,n.jsx)(l.A,{size:12}),(0,n.jsx)("span",{children:"Delete user"})]})]})]})}}}),b=j.find(e=>"img"===e.key);return g.length>0&&(j=j.filter(e=>g.includes(e.key)).sort((e,t)=>g.indexOf(e.key)-g.indexOf(t.key))),0===c.length?j:[b].concat(j.filter(e=>c.includes(e.key)))}},29622:(e,t,s)=>{s.d(t,{i:()=>d});var n=s(80263),a=s(75232),r=s(73969),i=s(45209),o=s(34531),l=s(50204);let d=e=>{var t,s;let{visible:d,selectedUser:c,onClose:u,onDeleteSuccess:m}=e,{ref:x}=(0,a.g)(),{mutate:h,isLoading:p}=(0,i.X)({onSuccess:()=>{r.oR.success("Successfully deleted ".concat(null==c?void 0:c.email)),null==m||m()}}),f=async()=>(await (0,o.wR)(200),x)?(null==c?void 0:c.id)===void 0?r.oR.error("Failed to delete user: User ID not found"):void h({projectRef:x,userId:c.id}):console.error("Project ref is required");return(0,n.jsx)(l.A,{visible:d,variant:"destructive",title:"Confirm to delete user",loading:p,confirmLabel:"Delete",onCancel:()=>u(),onConfirm:()=>f(),alert:{title:"Deleting a user is irreversible",description:"This will remove the selected the user from the project and all associated data."},"data-sentry-element":"ConfirmationModal","data-sentry-component":"DeleteUserModal","data-sentry-source-file":"DeleteUserModal.tsx",children:(0,n.jsxs)("p",{className:"text-sm text-foreground-light",children:["This is permanent! Are you sure you want to delete the user"," ",null!=(s=null!=(t=null==c?void 0:c.email)?t:null==c?void 0:c.phone)?s:"this user","?"]})})}},36902:(e,t,s)=>{s.d(t,{A:()=>n});let n=(0,s(15740).A)("Lock",[["rect",{width:"18",height:"11",x:"3",y:"11",rx:"2",ry:"2",key:"1w4ew1"}],["path",{d:"M7 11V7a5 5 0 0 1 10 0v4",key:"fwvmzm"}]])},45209:(e,t,s)=>{s.d(t,{X:()=>d});var n=s(32144),a=s(80251),r=s(73969),i=s(65172),o=s(58982);async function l(e){let{projectRef:t,userId:s}=e,{data:n,error:a}=await (0,i.yH)("/platform/auth/{ref}/users/{id}",{params:{path:{ref:t,id:s}}});return a&&(0,i.H4)(a),n}let d=function(){let{onSuccess:e,onError:t,...s}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},i=(0,n.jE)();return(0,a.n)(e=>l(e),{async onSuccess(t,s,n){let{projectRef:a,skipInvalidation:r=!1}=s;r||await Promise.all([i.invalidateQueries(o.Z.usersInfinite(a)),i.invalidateQueries(o.Z.usersCount(a))]),await (null==e?void 0:e(t,s,n))},async onError(e,s,n){void 0===t?r.oR.error("Failed to delete user: ".concat(e.message)):t(e,s,n)},...s})}},48649:(e,t,s)=>{s.d(t,{A:()=>n});let n=(0,s(15740).A)("ArrowDownWideNarrow",[["path",{d:"m3 16 4 4 4-4",key:"1co6wj"}],["path",{d:"M7 20V4",key:"1yoxec"}],["path",{d:"M11 4h10",key:"1w87gc"}],["path",{d:"M11 8h7",key:"djye34"}],["path",{d:"M11 12h4",key:"q8tih4"}]])},59450:(e,t,s)=>{s.d(t,{A:()=>n});let n=(0,s(15740).A)("User",[["path",{d:"M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2",key:"975kel"}],["circle",{cx:"12",cy:"7",r:"4",key:"17ys0d"}]])},60372:(e,t,s)=>{s.d(t,{A:()=>n});let n=(0,s(15740).A)("ShieldOff",[["path",{d:"m2 2 20 20",key:"1ooewy"}],["path",{d:"M5 5a1 1 0 0 0-1 1v7c0 5 3.5 7.5 7.67 8.94a1 1 0 0 0 .67.01c2.35-.82 4.48-1.97 5.9-3.71",key:"1jlk70"}],["path",{d:"M9.309 3.652A12.252 12.252 0 0 0 11.24 2.28a1.17 1.17 0 0 1 1.52 0C14.51 3.81 17 5 19 5a1 1 0 0 1 1 1v7a9.784 9.784 0 0 1-.08 1.264",key:"18rp1v"}]])},69036:(e,t,s)=>{s.d(t,{A:()=>n});let n=(0,s(15740).A)("ArrowUpNarrowWide",[["path",{d:"m3 8 4-4 4 4",key:"11wl7u"}],["path",{d:"M7 4v16",key:"1glfcx"}],["path",{d:"M11 12h4",key:"q8tih4"}],["path",{d:"M11 16h7",key:"uosisv"}],["path",{d:"M11 20h10",key:"jvxblo"}]])},82692:(e,t,s)=>{s.d(t,{$:()=>r});var n=s(80263),a=s(51500);let r=e=>{let{loading:t}=e;return(0,n.jsx)("div",{className:"relative overflow-hidden w-full h-px bg-border m-auto","data-sentry-component":"LoadingLine","data-sentry-source-file":"LoadingLine.tsx",children:(0,n.jsx)("span",{className:(0,a.cn)("absolute w-[80px] h-px ml-auto mr-auto left-0 right-0 text-center block top-0","transition-all","line-loading-bg-light dark:line-loading-bg",t&&"animate-line-loading-slower opacity-100",t?"opacity-100":"opacity-0")})})}},95301:(e,t,s)=>{s.d(t,{x:()=>d});var n=s(80263),a=s(29012),r=s(55006),i=s(51500),o=s(21957),l=s(26005);let d=e=>{var t,s,d;let{user:c}=e,u=(0,l.Mn)(c),m="-"!==u,x=null!==c.phone,h=c.is_anonymous;return(0,n.jsx)("div",{className:(0,i.cn)(o.jU),"data-sentry-component":"UserHeader","data-sentry-source-file":"UserHeader.tsx",children:x?(0,n.jsxs)("div",{className:"flex items-center gap-x-1",children:[(0,n.jsx)("p",{children:c.phone}),(0,n.jsx)(r.A,{iconOnly:!0,type:"text",icon:(0,n.jsx)(a.A,{}),className:"px-1",text:null!=(t=null==c?void 0:c.phone)?t:""})]}):h?(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)("p",{children:"Anonymous user"}),(0,n.jsxs)("div",{className:"flex items-center gap-x-1",children:[(0,n.jsx)("p",{className:"text-foreground-light text-sm",children:c.id}),(0,n.jsx)(r.A,{iconOnly:!0,type:"text",icon:(0,n.jsx)(a.A,{}),className:"px-1",text:null!=(s=null==c?void 0:c.id)?s:""})]})]}):(0,n.jsxs)(n.Fragment,{children:[m&&(0,n.jsx)("p",{children:u}),(0,n.jsxs)("div",{className:"flex items-center gap-x-1",children:[(0,n.jsx)("p",{className:(0,i.cn)(m?"text-foreground-light text-sm":"text-foreground"),children:c.email}),(0,n.jsx)(r.A,{iconOnly:!0,type:"text",icon:(0,n.jsx)(a.A,{}),className:"px-1",text:null!=(d=null==c?void 0:c.email)?d:""})]})]})})}}}]);