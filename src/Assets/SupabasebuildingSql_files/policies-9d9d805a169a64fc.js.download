try{!function(){var e="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof globalThis?globalThis:"undefined"!=typeof self?self:{},t=(new e.Error).stack;t&&(e._sentryDebugIds=e._sentryDebugIds||{},e._sentryDebugIds[t]="73e742a9-df6c-4b5b-927a-a1fe1641abed",e._sentryDebugIdIdentifier="sentry-dbid-73e742a9-df6c-4b5b-927a-a1fe1641abed")}()}catch(e){}(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[4986,7248],{107:(e,t,a)=>{var s=a(50117),n=a(94277),r=Object.prototype.hasOwnProperty;e.exports=n(function(e,t,a){r.call(e,a)?e[a].push(t):s(e,a,[t])})},4576:e=>{var t="\ud800-\udfff",a="\\u2700-\\u27bf",s="a-z\\xdf-\\xf6\\xf8-\\xff",n="A-Z\\xc0-\\xd6\\xd8-\\xde",r="\\xac\\xb1\\xd7\\xf7\\x00-\\x2f\\x3a-\\x40\\x5b-\\x60\\x7b-\\xbf\\u2000-\\u206f \\t\\x0b\\f\\xa0\\ufeff\\n\\r\\u2028\\u2029\\u1680\\u180e\\u2000\\u2001\\u2002\\u2003\\u2004\\u2005\\u2006\\u2007\\u2008\\u2009\\u200a\\u202f\\u205f\\u3000",i="['’]",l="["+r+"]",o="["+s+"]",c="[^"+t+r+"\\d+"+a+s+n+"]",d="(?:\ud83c[\udde6-\uddff]){2}",u="[\ud800-\udbff][\udc00-\udfff]",x="["+n+"]",m="(?:"+o+"|"+c+")",p="(?:"+x+"|"+c+")",f="(?:"+i+"(?:d|ll|m|re|s|t|ve))?",h="(?:"+i+"(?:D|LL|M|RE|S|T|VE))?",y="(?:[\\u0300-\\u036f\\ufe20-\\ufe2f\\u20d0-\\u20ff]|\ud83c[\udffb-\udfff])?",g="[\\ufe0e\\ufe0f]?",j="(?:\\u200d(?:"+["[^"+t+"]",d,u].join("|")+")"+g+y+")*",v="(?:"+["["+a+"]",d,u].join("|")+")"+(g+y+j),b=RegExp([x+"?"+o+"+"+f+"(?="+[l,x,"$"].join("|")+")",p+"+"+h+"(?="+[l,x+m,"$"].join("|")+")",x+"?"+m+"+"+f,x+"+"+h,"\\d*(?:1ST|2ND|3RD|(?![123])\\dTH)(?=\\b|[a-z_])","\\d*(?:1st|2nd|3rd|(?![123])\\dth)(?=\\b|[A-Z_])","\\d+",v].join("|"),"g");e.exports=function(e){return e.match(b)||[]}},5010:(e,t,a)=>{"use strict";a.d(t,{A:()=>s});let s=(0,a(15740).A)("Timer",[["line",{x1:"10",x2:"14",y1:"2",y2:"2",key:"14vaq8"}],["line",{x1:"12",x2:"15",y1:"14",y2:"11",key:"17fdiu"}],["circle",{cx:"12",cy:"14",r:"8",key:"1e1u0o"}]])},9387:(e,t,a)=>{"use strict";a.d(t,{Z:()=>n}),a(80263);var s=a(53239);function n(e){let t=(0,s.useRef)();return(0,s.useEffect)(()=>{t.current=e}),t.current}a(54955),a(34531)},15196:e=>{var t=/[^\x00-\x2f\x3a-\x40\x5b-\x60\x7b-\x7f]+/g;e.exports=function(e){return e.match(t)||[]}},19686:(e,t,a)=>{"use strict";a.d(t,{Ay:()=>c});var s={};a.r(s),a.d(s,{BRAND:()=>l.qt,DIRTY:()=>r.jm,EMPTY_PATH:()=>r.I3,INVALID:()=>r.uY,NEVER:()=>l.tm,OK:()=>r.OK,ParseStatus:()=>r.MY,Schema:()=>l.Sj,ZodAny:()=>l.Ml,ZodArray:()=>l.n,ZodBigInt:()=>l.Lr,ZodBoolean:()=>l.WF,ZodBranded:()=>l.eN,ZodCatch:()=>l.hw,ZodDate:()=>l.aP,ZodDefault:()=>l.Xi,ZodDiscriminatedUnion:()=>l.jv,ZodEffects:()=>l.k1,ZodEnum:()=>l.Vb,ZodError:()=>o.G,ZodFirstPartyTypeKind:()=>l.kY,ZodFunction:()=>l.CZ,ZodIntersection:()=>l.Jv,ZodIssueCode:()=>o.eq,ZodLazy:()=>l.Ih,ZodLiteral:()=>l.DN,ZodMap:()=>l.Ut,ZodNaN:()=>l.Tq,ZodNativeEnum:()=>l.WM,ZodNever:()=>l.iS,ZodNull:()=>l.PQ,ZodNullable:()=>l.l1,ZodNumber:()=>l.rS,ZodObject:()=>l.bv,ZodOptional:()=>l.Ii,ZodParsedType:()=>i.Zp,ZodPipeline:()=>l._c,ZodPromise:()=>l.$i,ZodReadonly:()=>l.EV,ZodRecord:()=>l.b8,ZodSchema:()=>l.lK,ZodSet:()=>l.Kz,ZodString:()=>l.ND,ZodSymbol:()=>l.K5,ZodTransformer:()=>l.BG,ZodTuple:()=>l.y0,ZodType:()=>l.aR,ZodUndefined:()=>l._Z,ZodUnion:()=>l.fZ,ZodUnknown:()=>l._,ZodVoid:()=>l.a0,addIssueToContext:()=>r.zn,any:()=>l.bz,array:()=>l.YO,bigint:()=>l.o,boolean:()=>l.zM,coerce:()=>l.au,custom:()=>l.Ie,date:()=>l.p6,datetimeRegex:()=>l.fm,defaultErrorMap:()=>n.su,discriminatedUnion:()=>l.gM,effect:()=>l.QZ,enum:()=>l.k5,function:()=>l.fH,getErrorMap:()=>n.$W,getParsedType:()=>i.CR,instanceof:()=>l.Nl,intersection:()=>l.E$,isAborted:()=>r.G4,isAsync:()=>r.xP,isDirty:()=>r.DM,isValid:()=>r.fn,late:()=>l.fn,lazy:()=>l.RZ,literal:()=>l.eu,makeIssue:()=>r.y7,map:()=>l.Tj,nan:()=>l.oi,nativeEnum:()=>l.fc,never:()=>l.Zm,null:()=>l.ch,nullable:()=>l.me,number:()=>l.ai,object:()=>l.Ik,objectUtil:()=>i.o6,oboolean:()=>l.yN,onumber:()=>l.p7,optional:()=>l.lq,ostring:()=>l.Di,pipeline:()=>l.Tk,preprocess:()=>l.vk,promise:()=>l.iv,quotelessJson:()=>o.WI,record:()=>l.g1,set:()=>l.hZ,setErrorMap:()=>n.pJ,strictObject:()=>l.re,string:()=>l.Yj,symbol:()=>l.HR,transformer:()=>l.Gu,tuple:()=>l.PV,undefined:()=>l.Vx,union:()=>l.KC,unknown:()=>l.L5,util:()=>i.ZS,void:()=>l.rI});var n=a(54686),r=a(93298),i=a(14595),l=a(10663),o=a(63324);let c=s},20680:(e,t,a)=>{"use strict";a.d(t,{A:()=>s});let s=(0,a(15740).A)("ChevronsDown",[["path",{d:"m7 6 5 5 5-5",key:"1lc07p"}],["path",{d:"m7 13 5 5 5-5",key:"1d48rs"}]])},24276:(e,t,a)=>{"use strict";a.d(t,{A:()=>s});let s=(0,a(15740).A)("Grid3x3",[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",key:"afitv7"}],["path",{d:"M3 9h18",key:"1pudct"}],["path",{d:"M3 15h18",key:"5xshup"}],["path",{d:"M9 3v18",key:"fh3hqa"}],["path",{d:"M15 3v18",key:"14nvp0"}]])},24863:(e,t,a)=>{"use strict";a.d(t,{A:()=>s});let s=(0,a(15740).A)("Layers",[["path",{d:"m12.83 2.18a2 2 0 0 0-1.66 0L2.6 6.08a1 1 0 0 0 0 1.83l8.58 3.91a2 2 0 0 0 1.66 0l8.58-3.9a1 1 0 0 0 0-1.83Z",key:"8b97xw"}],["path",{d:"m22 17.65-9.17 4.16a2 2 0 0 1-1.66 0L2 17.65",key:"dd6zsq"}],["path",{d:"m22 12.65-9.17 4.16a2 2 0 0 1-1.66 0L2 12.65",key:"ep9fru"}]])},30788:(e,t,a)=>{var s=a(98198),n=a(33312);e.exports=function(e,t,a,r){return null==e?[]:(n(t)||(t=null==t?[]:[t]),n(a=r?void 0:a)||(a=null==a?[]:[a]),s(e,t,a))}},32351:(e,t,a)=>{var s=a(48817);e.exports=function(e,t){return e&&e.length&&t&&t.length?s(e,t):e}},34556:(e,t,a)=>{"use strict";a.r(t),a.d(t,{default:()=>tn});var s=a(80263),n=a(75232),r=a(81097),i=a.n(r),l=a(48388),o=a.n(l),c=a(26089),d=a.n(c),u=a(97344),x=a.n(u),m=a(53239),p=a(73969),f=a(83927),h=a.n(f),y=a(72035),g=a(67120),j=a(50204);let v={SELECTION:"SELECTION",TEMPLATES:"TEMPLATES",EDITOR:"EDITOR",REVIEW:"REVIEW"};var b=a(14685),N=a.n(b),E=a(84305),S=a.n(E);let w=(e,t)=>{let{definition:a,check:s}=e,n={...e,definition:a?a.replace(/\s+/g," ").trim():void 0===a?null:a,check:s?s.replace(/\s+/g," ").trim():void 0===s?null:s};if(x()(t))return P(n);if(S()(e,t))return{};let r={};return(S()(n.name,t.name)||(r.name=n.name),S()(n.definition,t.definition)||(r.definition=n.definition),S()(n.check,t.check)||(r.check=n.check),S()(n.roles,t.roles)||(r.roles=n.roles),x()(r))?{}:A(n,r)},P=e=>{let{name:t,definition:a,check:s,command:n,schema:r,table:i}=e,l=0===e.roles.length?["public"]:e.roles;return{description:"Add policy for the ".concat(n,' operation under the policy "').concat(t,'"'),statement:['CREATE POLICY "'.concat(t,'" ON "').concat(r,'"."').concat(i,'"'),"AS PERMISSIVE FOR ".concat(n),"TO ".concat(l.join(", ")),"".concat(a?"USING (".concat(a,")"):""),"".concat(s?"WITH CHECK (".concat(s,")"):"")].join("\n")}},A=(e,t)=>{var a;let{name:s,schema:n,table:r}=e,i=N()(t,["definition"]),l=N()(t,["check"]),o=N()(t,["name"]),c=N()(t,["roles"]),d=Object.keys(t),u="Update policy's ".concat(1===d.length?d[0]:"".concat(d.slice(0,d.length-1).join(", ")," and ").concat(d[d.length-1])," "),x=0===(null!=(a=null==t?void 0:t.roles)?a:[]).length?["public"]:t.roles,m='ALTER POLICY "'.concat(s,'" ON "').concat(n,'"."').concat(r,'"');return{description:u,statement:["BEGIN;",...i?["  ".concat(m," USING (").concat(t.definition,");")]:[],...l?["  ".concat(m," WITH CHECK (").concat(t.check,");")]:[],...c?["  ".concat(m," TO ").concat(x.join(", "),";")]:[],...o?["  ".concat(m,' RENAME TO "').concat(t.name,'";')]:[],"COMMIT;"].join("\n")}},k=e=>{let{command:t,definition:a,check:s,roles:n}=e;return{...e,action:"PERMISSIVE",command:t||void 0,definition:a||void 0,check:s||void 0,roles:n.length>0?n:void 0}},C=(e,t)=>{let{definition:a,check:s}=e,n={...e,definition:a?a.replace(/\s+/g," ").trim():a,check:s?s.replace(/\s+/g," ").trim():s},r={id:t.id};return S()(n.name,t.name)||(r.name=n.name),S()(n.definition,t.definition)||(r.definition=n.definition||void 0),S()(n.check,t.check)||(r.check=n.check||void 0),S()(n.roles,t.roles)||(0===n.roles.length?r.roles=["public"]:r.roles=n.roles||void 0),r};var T=a(79467);let R=e=>{let{operation:t="",onSelectOperation:a=h()}=e;return(0,s.jsxs)("div",{className:"flex justify-between space-x-12","data-sentry-component":"PolicyAllowedOperation","data-sentry-source-file":"PolicyAllowedOperation.tsx",children:[(0,s.jsxs)("div",{className:"flex w-1/3 flex-col space-y-2",children:[(0,s.jsx)("label",{className:"text-base text-foreground-light",htmlFor:"allowed-operation",children:"Allowed operation"}),(0,s.jsx)("p",{className:"text-sm text-foreground-lighter",children:"Select an operation for this policy"})]}),(0,s.jsx)("div",{className:"w-2/3",children:(0,s.jsx)("div",{className:"flex items-center space-x-8",children:(0,s.jsx)(T.A.Group,{type:"small-cards",size:"tiny",id:"allowed-operation","data-sentry-element":"Radio.Group","data-sentry-source-file":"PolicyAllowedOperation.tsx",children:["SELECT","INSERT","UPDATE","DELETE","ALL"].map(e=>(0,s.jsx)(T.A,{name:"allowed-operation",label:e,value:e,checked:t===e,onChange:e=>a(e.target.value)},e))})})})]})};var _=a(59024),L=a(9387),I=a(63159),O=a(30435);let D=e=>{let{operation:t="",definition:a="",check:n="",onUpdatePolicyUsing:r=h(),onUpdatePolicyCheck:i=h()}=e,l=e=>["SELECT","UPDATE","DELETE","ALL"].includes(e)||!e,o=e=>["INSERT","UPDATE","ALL"].includes(e),c=(0,L.Z)(t)||"";return(0,m.useEffect)(()=>{l(c)&&!l(t)&&r(void 0),o(c)&&!o(t)&&i(void 0)},[t]),(0,s.jsxs)("div",{className:"space-y-4","data-sentry-component":"PolicyDefinition","data-sentry-source-file":"PolicyDefinition.tsx",children:[l(t)&&(0,s.jsxs)("div",{className:"flex space-x-12",children:[(0,s.jsxs)("div",{className:"flex w-1/3 flex-col space-y-2",children:[(0,s.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,s.jsx)("label",{className:"text-base text-foreground-light",htmlFor:"policy-name",children:"USING expression"}),(0,s.jsxs)(O.m_,{children:[(0,s.jsx)(O.k$,{children:(0,s.jsx)(I.A,{className:"text-foreground-light",size:16,strokeWidth:1.5})}),(0,s.jsx)(O.ZI,{side:"bottom",children:(0,s.jsxs)("div",{className:"w-[300px] space-y-2",children:[(0,s.jsx)("p",{className:"text-xs text-foreground",children:"This expression will be added to queries that refer to the table if row-level security is enabled."}),(0,s.jsx)("p",{className:"text-xs text-foreground",children:"Rows for which the expression returns true will be visible. Any rows for which the expression returns false or null will not be visible to the user (in a SELECT), and will not be available for modification (in an UPDATE or DELETE)."}),(0,s.jsx)("p",{className:"text-xs text-foreground",children:"Such rows are silently suppressed - no error is reported."})]})})]})]}),(0,s.jsx)("p",{className:"text-sm text-foreground-lighter",children:"Provide a SQL conditional expression that returns a boolean."})]}),(0,s.jsx)("div",{className:"w-2/3 ".concat(o(t)?"h-32":"h-56"),children:(0,s.jsx)(_.A,{defaultValue:a,onInputChange:r})})]}),o(t)&&(0,s.jsxs)("div",{className:"flex space-x-12",children:[(0,s.jsxs)("div",{className:"flex w-1/3 flex-col space-y-2",children:[(0,s.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,s.jsx)("label",{className:"text-base text-foreground-light",htmlFor:"policy-name",children:"WITH CHECK expression"}),(0,s.jsxs)(O.m_,{children:[(0,s.jsx)(O.k$,{children:(0,s.jsx)(I.A,{className:"text-foreground-light",size:16,strokeWidth:1.5})}),(0,s.jsx)(O.ZI,{side:"bottom",children:(0,s.jsxs)("div",{className:"w-[300px] space-y-2",children:[(0,s.jsx)("p",{className:"text-xs text-foreground",children:"This expression will be used in INSERT and UPDATE queries against the table if row-level security is enabled."}),(0,s.jsx)("p",{className:"text-xs text-foreground",children:"Only rows for which the expression evaluates to true will be allowed. An error will be thrown if the expression evaluates to false or null for any of the records inserted or any of the records that result from the update."}),(0,s.jsx)("p",{className:"text-xs text-foreground",children:"Note that this expression is evaluated against the proposed new contents of the row, not the original contents."})]})})]})]}),(0,s.jsx)("p",{className:"text-sm text-foreground-lighter",children:"Provide a SQL conditional expression that returns a boolean."})]}),(0,s.jsx)("div",{className:"w-2/3 ".concat(l(t)?"h-32":"h-56"),children:(0,s.jsx)(_.A,{defaultValue:n,onInputChange:i})})]})]})};var M=a(40022);let Z=e=>{let{showTemplates:t,onViewTemplates:a=h(),onReviewPolicy:n=h()}=e;return(0,s.jsx)("div",{className:"flex justify-between items-center border-t px-6 py-4 border-default","data-sentry-component":"PolicyEditorFooter","data-sentry-source-file":"PolicyEditorFooter.tsx",children:(0,s.jsxs)("div",{className:"flex w-full items-center justify-end gap-2",children:[t&&(0,s.jsx)(M.$,{type:"default",onClick:a,children:"View templates"}),(0,s.jsx)(M.$,{type:"primary",onClick:n,"data-sentry-element":"Button","data-sentry-source-file":"PolicyEditorFooter.tsx",children:"Review"})]})})};var U=a(95708);let F=e=>{let{name:t="",limit:a=100,onUpdatePolicyName:n}=e;return(0,s.jsxs)("div",{className:"flex flex-col md:flex-row gap-4 md:gap-12","data-sentry-component":"PolicyName","data-sentry-source-file":"PolicyName.tsx",children:[(0,s.jsxs)("div",{className:"flex md:w-1/3 flex-col space-y-2",children:[(0,s.jsx)("label",{className:"text-base text-foreground-light",htmlFor:"policy-name",children:"Policy name"}),(0,s.jsx)("p",{className:"text-sm text-foreground-lighter",children:"A descriptive name for your policy"})]}),(0,s.jsx)("div",{className:"relative md:w-2/3",children:(0,s.jsx)(U.A,{id:"policy-name",value:t,onChange:e=>n(e.target.value),actions:(0,s.jsxs)("span",{className:"mr-3 text-sm text-foreground-lighter",children:[t.length,"/",a]}),"data-sentry-element":"Input","data-sentry-source-file":"PolicyName.tsx"})})]})};var z=a(58174),W=a(20313),V=a(90437),G=a(72192),B=a(5483),H=a(14506),q=a.n(H),Y=a(96342),K=a(30788),$=a.n(K),Q=a(37253),X=a.n(Q),J=a(72259),ee=a(75189),et=a(80903),ea=a(3689),es=a(87610),en=a(9681),er=a(38417),ei=a(10455);function el(e){let{options:t,value:a,label:n,error:r,descriptionText:l,placeholder:o,searchPlaceholder:c="Search for option",emptyMessage:d,disabled:u,allowDuplicateSelection:x=!1,onChange:p=()=>{}}=e,f=(0,m.useRef)(null),[h,y]=(0,m.useState)(!1),[g,j]=(0,m.useState)(a||[]),[v,b]=(0,m.useState)(""),[N,E]=(0,m.useState)(128),S=a||g;(0,m.useEffect)(()=>{E(f.current?f.current.offsetWidth:N)},[f.current]),(0,m.useEffect)(()=>{h||b("")},[h]);let w="".concat(N,"px"),P=$()(t,["disabled"],["desc"]),A=v.length>0?i()(P,e=>!e.disabled&&e.name.includes(v)):i()(P,{disabled:!1}),k=e=>void 0!==(S||[]).find(t=>t===e.value),C=e=>{let t=g.filter((t,a)=>a!==e);j(t),p(t)},T=e=>{let a=k(e),s=x?[...S.concat([e.value])]:a?[...X()(S,e.value)]:[...S.concat([e.value])],n=t.filter(e=>e.disabled).map(e=>e.name),r=x?s.concat(n):[...new Set(s.concat(n))];j(r),p(r)};return(0,s.jsxs)("div",{className:"form-group ".concat(u?"pointer-events-none opacity-50":""),"data-sentry-component":"MultiSelect","data-sentry-source-file":"index.tsx",children:[n&&(0,s.jsx)("label",{className:"!w-full",children:n}),(0,s.jsx)("div",{className:["form-control form-control--multi-select","border border-strong bg-control","multi-select relative block w-full space-x-1 overflow-auto rounded","".concat(void 0!==r?"border-red-800 bg-red-100":"")].join(" "),ref:f,children:(0,s.jsxs)(en.AM,{open:h,onOpenChange:y,modal:!1,"data-sentry-element":"Popover_Shadcn_","data-sentry-source-file":"index.tsx",children:[(0,s.jsx)(en.Wv,{asChild:!0,"data-sentry-element":"PopoverTrigger_Shadcn_","data-sentry-source-file":"index.tsx",children:(0,s.jsxs)("div",{className:["flex w-full flex-wrap items-start gap-1.5 p-1.5 cursor-pointer","".concat(0===S.length?"h-9":"")].join(" "),onClick:()=>y(!0),children:[0===S.length&&o&&(0,s.jsx)("div",{className:"px-2 text-sm text-foreground-light h-full flex items-center",children:o}),S.map((e,t)=>{var a;let n="".concat(e,"-").concat(t),r=P.find(t=>t.value===e),i=null!=(a=null==r?void 0:r.disabled)&&a;return r?i?(0,s.jsx)(ei.a,{name:e},n):(0,s.jsx)(ei.h,{name:e,handleRemove:()=>x?C(t):T(r)},n):(0,s.jsx)(s.Fragment,{})}),(0,s.jsx)("div",{className:"absolute inset-y-0 right-0 pl-3 pr-2 flex space-x-1 items-center cursor-pointer ",children:(0,s.jsx)(J.A,{size:16,strokeWidth:2,className:"text-foreground-lighter","data-sentry-element":"ChevronDown","data-sentry-source-file":"index.tsx"})})]})}),(0,s.jsxs)(en.hl,{className:"p-0",side:"bottom",align:"start",style:{width:w,marginLeft:"-5px"},"data-sentry-element":"PopoverContent_Shadcn_","data-sentry-source-file":"index.tsx",children:[(0,s.jsx)(U.A,{className:"[&>div>div>div>input]:!rounded-b-none [&>div>div>div>input]:!pl-9",icon:(0,s.jsx)(ee.A,{size:16}),placeholder:c,value:v,onChange:e=>b(e.target.value),"data-sentry-element":"Input","data-sentry-source-file":"index.tsx"}),(0,s.jsx)(er.FK,{className:(0,Y.default)("p-1",A.length>5?"h-[225px]":""),"data-sentry-element":"ScrollArea","data-sentry-source-file":"index.tsx",children:A.length>=1?A.map(e=>{let t=!!(!x&&S&&S.find(t=>t===e.value));return(0,s.jsxs)("div",{onClick:()=>T(e),className:["text-typography-body-light [[data-theme*=dark]_&]:text-typography-body-dark","group flex cursor-pointer items-center justify-between transition","space-x-1 rounded bg-transparent p-2 px-4 text-sm hover:bg-overlay-hover","".concat(t?" [[data-theme*=dark]_&]:bg-green-600 [[data-theme*=dark]_&]:bg-opacity-25":"")].join(" "),children:[(0,s.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,s.jsx)("p",{children:e.name}),void 0!==e.description&&(0,s.jsx)("p",{className:"opacity-50",children:e.description})]}),t&&(0,s.jsx)(et.A,{size:16,strokeWidth:3,className:"cursor-pointer transition ".concat(t?"text-brand":"")}),x&&(0,s.jsxs)("div",{className:"flex items-center opacity-0 group-hover:opacity-100 transition space-x-1",children:[(0,s.jsx)(ea.A,{size:14}),(0,s.jsx)("p",{className:"text-sm",children:"Add value"})]})]},"multiselect-option-".concat(e.id))}):0===t.length?(0,s.jsx)("div",{className:"flex h-full w-full flex-col border-default items-center justify-center border border-dashed p-3",children:d||(0,s.jsxs)("div",{className:"flex w-full items-center space-x-2",children:[(0,s.jsx)(es.A,{strokeWidth:1.5,size:18,className:"text-foreground-light"}),(0,s.jsx)("p",{className:"text-sm text-foreground-light",children:"No options available"})]})}):(0,s.jsx)("div",{className:"flex h-full w-full flex-col border-default items-center justify-center border border-dashed p-3",children:d||(0,s.jsx)("div",{className:"flex w-full items-center space-x-2",children:(0,s.jsx)("p",{className:"text-sm text-foreground-light",children:"No options found"})})})})]})]})}),l&&(0,s.jsx)("span",{className:"form-text text-muted mt-2 text-sm",children:l}),r&&(0,s.jsx)("span",{className:"text-red-900 text-sm mt-2",children:r})]})}let eo=e=>{let{selectedRoles:t,onUpdateSelectedRoles:a}=e,{data:n}=(0,B.YA)(),{data:r,error:i,isLoading:l,isError:o,isSuccess:c}=(0,G._X)({projectRef:null==n?void 0:n.ref,connectionString:null==n?void 0:n.connectionString}),d=q()((null!=r?r:[]).filter(e=>!z.QY.includes(e.name)),e=>e.name.toLocaleLowerCase()).map(e=>({id:e.id,name:e.name,value:e.name,disabled:!1}));return(0,s.jsxs)("div",{className:"flex flex-col md:flex-row gap-4 md:gap-12","data-sentry-component":"PolicyRoles","data-sentry-source-file":"PolicyRoles.tsx",children:[(0,s.jsxs)("div",{className:"flex md:w-1/3 flex-col space-y-2",children:[(0,s.jsx)("label",{className:"text-foreground-light text-base",htmlFor:"policy-name",children:"Target roles"}),(0,s.jsx)("p",{className:"text-foreground-lighter text-sm",children:"Apply policy to the selected roles"})]}),(0,s.jsxs)("div",{className:"relative md:w-2/3",children:[l&&(0,s.jsx)(V.A,{className:"py-4"}),o&&(0,s.jsx)(W.A,{error:i,subject:"Failed to retrieve database roles"}),c&&(0,s.jsx)(el,{options:d,value:t,placeholder:"Defaults to all (public) roles if none selected",searchPlaceholder:"Search for a role",onChange:a})]})]})},ec=e=>{var t,a,n,r;let{isNewPolicy:i=!0,policyFormFields:l={},onUpdatePolicyFormFields:o=()=>{},onViewTemplates:c=()=>{},onReviewPolicy:d=()=>{}}=e,u=null!=(t=null==l?void 0:l.command)?t:"",x=null!=(a=null==l?void 0:l.definition)?a:"",m=null!=(n=null==l?void 0:l.check)?n:"",p=(null!=(r=null==l?void 0:l.roles)?r:[]).filter(e=>"public"!==e);return(0,s.jsxs)("div",{"data-sentry-component":"PolicyEditor","data-sentry-source-file":"index.tsx",children:[(0,s.jsx)(g.A.Content,{"data-sentry-element":"Modal.Content","data-sentry-source-file":"index.tsx",children:(0,s.jsx)(F,{name:l.name,limit:63,onUpdatePolicyName:e=>o({name:e}),"data-sentry-element":"PolicyName","data-sentry-source-file":"index.tsx"})}),(0,s.jsx)(g.A.Separator,{"data-sentry-element":"Modal.Separator","data-sentry-source-file":"index.tsx"}),i&&(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(g.A.Content,{children:(0,s.jsx)(R,{operation:u,onSelectOperation:e=>o({command:e})})}),(0,s.jsx)(g.A.Separator,{})]}),(0,s.jsx)(g.A.Content,{"data-sentry-element":"Modal.Content","data-sentry-source-file":"index.tsx",children:(0,s.jsx)(eo,{selectedRoles:p,onUpdateSelectedRoles:e=>o({roles:e}),"data-sentry-element":"PolicyRoles","data-sentry-source-file":"index.tsx"})}),(0,s.jsx)(g.A.Separator,{"data-sentry-element":"Modal.Separator","data-sentry-source-file":"index.tsx"}),(0,s.jsx)(g.A.Content,{"data-sentry-element":"Modal.Content","data-sentry-source-file":"index.tsx",children:(0,s.jsx)(D,{operation:u,definition:x,check:m,onUpdatePolicyUsing:e=>o({definition:e}),onUpdatePolicyCheck:e=>o({check:e}),"data-sentry-element":"PolicyDefinition","data-sentry-source-file":"index.tsx"})}),(0,s.jsx)(Z,{showTemplates:i,onViewTemplates:c,onReviewPolicy:d,"data-sentry-element":"PolicyEditorFooter","data-sentry-source-file":"index.tsx"})]})},ed=e=>{let{policy:t={},onSelectBack:a=h(),onSelectSave:n=h()}=e,[r,i]=(0,m.useState)(!1),l=t.statement||"";return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(g.A.Content,{"data-sentry-element":"Modal.Content","data-sentry-source-file":"PolicyReview.tsx",children:(0,s.jsxs)("div",{className:"space-y-6",children:[(0,s.jsx)("div",{className:"flex items-center justify-between space-y-8",children:(0,s.jsx)("div",{className:"flex flex-col",children:(0,s.jsx)("p",{className:"text-sm text-foreground-light",children:"This is the SQL statement that will be used to create your policy."})})}),(0,s.jsx)("div",{className:"space-y-4 overflow-y-auto",style:{maxHeight:"25rem"},children:x()(t)?(0,s.jsx)("div",{className:"my-10 flex items-center justify-center space-x-2 opacity-50",children:(0,s.jsx)("p",{className:"text-base text-foreground-light",children:"There are no changes made to this policy"})}):(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsx)("span",{children:t.description}),(0,s.jsx)("div",{className:"h-40",children:(0,s.jsx)(_.A,{readOnly:!0,defaultValue:l})})]})})]})}),(0,s.jsxs)("div",{className:"flex w-full items-center justify-end gap-2 border-t px-6 py-4 border-default",children:[(0,s.jsx)(M.$,{type:"default",onClick:a,"data-sentry-element":"Button","data-sentry-source-file":"PolicyReview.tsx",children:"Back to edit"}),(0,s.jsx)(M.$,{type:"primary",disabled:x()(t),onClick:()=>{i(!0),n()},loading:r,"data-sentry-element":"Button","data-sentry-source-file":"PolicyReview.tsx",children:"Save policy"})]})]})};var eu=a(1012),ex=a(32035),em=a(24276),ep=a(11192),ef=a(67776),eh=a(23445),ey=a(37411);let eg=e=>{let{description:t="",showAssistantPreview:a,onViewTemplates:n=h(),onViewEditor:r=h(),onToggleFeaturePreviewModal:i}=e;return(0,ey.qM)(),(0,s.jsxs)(g.A.Content,{className:"space-y-4 py-4","data-sentry-element":"Modal.Content","data-sentry-component":"PolicySelection","data-sentry-source-file":"PolicySelection.tsx",children:[(0,s.jsxs)("div",{className:"flex flex-col gap-y-2",children:[(0,s.jsx)("p",{className:"text-sm text-foreground-light",children:t}),(0,s.jsxs)("div",{className:"grid grid-cols-1 gap-2 lg:grid-cols-1",children:[(0,s.jsx)(ex.A,{title:"Get started quickly",description:"Create a policy from a template",icon:(0,s.jsx)("div",{className:"flex",children:(0,s.jsx)("div",{className:" flex h-8 w-8 items-center justify-center rounded bg-foreground text-background ",children:(0,s.jsx)(em.A,{size:14,strokeWidth:2})})}),onClick:n,"data-sentry-element":"CardButton","data-sentry-source-file":"PolicySelection.tsx"}),(0,s.jsx)(ex.A,{title:"For full customization",description:"Create a policy from scratch",icon:(0,s.jsx)("div",{className:"flex",children:(0,s.jsx)("div",{className:" flex h-8 w-8 items-center justify-center rounded bg-foreground text-background ",children:(0,s.jsx)(ep.A,{size:14,strokeWidth:2})})}),onClick:r,"data-sentry-element":"CardButton","data-sentry-source-file":"PolicySelection.tsx"})]})]}),a&&void 0!==i&&(0,s.jsxs)(eu.Fc,{children:[(0,s.jsx)(ef.A,{}),(0,s.jsx)(eu.XL,{children:"Try the new Supabase Assistant for RLS policies"}),(0,s.jsx)(eu.TN,{children:"Create RLS policies for your tables with the help of AI"}),(0,s.jsxs)("div",{className:"flex items-center gap-x-2 mt-3",children:[(0,s.jsx)(M.$,{type:"default",onClick:i,children:"Toggle feature preview"}),(0,s.jsx)(M.$,{asChild:!0,type:"default",icon:(0,s.jsx)(eh.A,{strokeWidth:1.5}),children:(0,s.jsx)("a",{href:"https://supabase.com/blog/studio-introducing-assistant#introducing-the-supabase-assistant",target:"_blank",rel:"noreferrer",children:"Learn more"})})]})]})]})},ej=e=>{let{selectedTemplate:t}=e,{id:a,templateName:n,description:r,statement:i}=t;return(0,s.jsx)("div",{className:"space-y-8 md:w-[70%]","data-sentry-component":"TemplatePreview","data-sentry-source-file":"TemplatePreview.tsx",children:!x()(t)&&(0,s.jsx)("div",{className:"flex h-full flex-col justify-between",children:(0,s.jsxs)("div",{className:"my-5 h-full space-y-6 px-6",children:[(0,s.jsx)("div",{className:"space-y-2",children:(0,s.jsxs)("div",{className:"flex flex-col space-y-2",children:[(0,s.jsx)("h3",{children:n}),(0,s.jsx)("p",{className:"text-foreground-light text-sm",children:r})]})}),(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsx)("label",{className:"text-foreground-light text-sm",children:"Policy SQL template:"}),(0,s.jsx)("div",{className:"h-64",children:(0,s.jsx)(_.A,{readOnly:!0,queryId:a,defaultValue:i})})]})]})})})};var ev=a(43242);let eb=e=>{let{templates:t=[],templatesNote:a="",selectedTemplate:n,setSelectedTemplate:r=h()}=e;return(0,s.jsxs)("div",{className:"flex flex-col justify-between border-r border-default w-full","data-sentry-component":"TemplatesList","data-sentry-source-file":"TemplatesList.tsx",children:[(0,s.jsx)("div",{className:"hide-scrollbar divide-border-primary space-y-0 divide-y divide-solid overflow-y-auto",style:{maxHeight:"24rem"},children:(0,s.jsx)(ev.Ay,{type:"border","data-sentry-element":"Menu","data-sentry-source-file":"TemplatesList.tsx",children:t.map((e,t)=>{let a=(null==n?void 0:n.id)===(null==e?void 0:e.id);return(0,s.jsx)("div",{className:"border-b border-overlay hover:bg-surface-200 "+(a?"bg-surface-300":""),children:(0,s.jsx)(ev.Ay.Item,{active:a,onClick:()=>r(e),children:(0,s.jsx)("div",{className:"truncate py-2",children:e.templateName})},e.id)},t)})})}),a&&(0,s.jsx)("div",{className:"px-4 py-2",children:(0,s.jsx)("p",{className:"text-xs text-foreground-lighter",children:a})})]})},eN=e=>{let{templates:t=[],templatesNote:a="",onUseTemplate:n=h()}=e,[r,i]=(0,m.useState)(t[0]);return(0,s.jsxs)("div",{"data-sentry-component":"PolicyTemplates","data-sentry-source-file":"index.tsx",children:[(0,s.jsxs)("div",{className:"flex flex-col md:flex-row justify-between border-t border-default",children:[(0,s.jsx)(eb,{templatesNote:a,templates:t,selectedTemplate:r,setSelectedTemplate:i,"data-sentry-element":"TemplatesList","data-sentry-source-file":"index.tsx"}),(0,s.jsx)(ej,{selectedTemplate:r,"data-sentry-element":"TemplatePreview","data-sentry-source-file":"index.tsx"})]}),(0,s.jsxs)("div",{className:"flex w-full items-center justify-end gap-3 border-t px-6 py-4 border-default",children:[(0,s.jsx)("span",{className:"text-sm text-foreground-lighter",children:"This will override any existing code you've written"}),(0,s.jsx)(M.$,{type:"primary",disabled:x()(r),onClick:()=>n(r),"data-sentry-element":"Button","data-sentry-source-file":"index.tsx",children:"Use this template"})]})]})};var eE=a(28758),eS=a(99846),ew=a(62136);let eP=e=>{let{view:t,schema:a,table:n,isNewPolicy:r,showAssistantPreview:i,onSelectBackFromTemplates:l=h(),onToggleFeaturePreviewModal:o}=e,c=()=>t===v.EDITOR||t===v.SELECTION?"".concat(r?"Adding new policy to":"Editing policy from"," ").concat(a,".").concat(n):t===v.REVIEW?"Reviewing policy to be ".concat(r?"created":"updated"," on ").concat(a,".").concat(n):void 0;return t===v.TEMPLATES?(0,s.jsx)("div",{children:(0,s.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,s.jsx)("span",{onClick:l,className:"cursor-pointer text-foreground-lighter transition-colors hover:text-foreground",children:(0,s.jsx)(eS.A,{strokeWidth:2,size:14})}),(0,s.jsx)("h4",{children:"Select a template to use for your new policy"})]})}):(0,s.jsxs)("div",{className:"w-full flex items-center justify-between gap-x-4","data-sentry-component":"PolicyEditorModalTitle","data-sentry-source-file":"PolicyEditorModalTitle.tsx",children:[(0,s.jsx)("h4",{className:"truncate",title:c(),children:c()}),(0,s.jsxs)("div",{className:"flex items-center gap-x-2 pr-6",children:[i&&t===v.EDITOR&&(0,s.jsx)(M.$,{type:"default",icon:(0,s.jsx)(ef.A,{}),onClick:o,children:"Try Supabase Assistant"}),(0,s.jsx)(ew.A,{className:"mt-[-4px]",href:"https://supabase.com/docs/learn/auth-deep-dive/auth-policies","data-sentry-element":"DocsButton","data-sentry-source-file":"PolicyEditorModalTitle.tsx"})]})]})},eA=e=>{let{visible:t=!1,schema:a="",table:n="",selectedPolicyToEdit:r={},showAssistantPreview:i=!1,onSelectCancel:l=h(),onCreatePolicy:o,onUpdatePolicy:c,onSaveSuccess:d=h()}=e,{toggleFeaturePreviewModal:u}=(0,y.j_)(),f=x()(r),b=f?{schema:a,table:n,name:"",definition:"",check:"",command:null,roles:[]}:r,[N,E]=(0,m.useState)(""),[S,P]=(0,m.useState)(v.EDITOR),[A,T]=(0,m.useState)(b),[R,_]=(0,m.useState)(""),[L,I]=(0,m.useState)(!1),[O,D]=(0,m.useState)(!1);(0,m.useEffect)(()=>{t&&(f?M():Z(),T(b))},[t]);let M=()=>P(v.SELECTION),Z=()=>P(v.EDITOR),U=()=>{E(S),P(v.TEMPLATES)},F=()=>P(v.REVIEW),z=()=>{u(),l()},W=async e=>{(f?await o(e):await c(e))?Z():d()};return(0,s.jsx)(g.A,{hideFooter:!0,size:S===v.SELECTION?"medium":"xxlarge",visible:t,contentStyle:{padding:0},header:[(0,s.jsx)(eP,{view:S,isNewPolicy:f,schema:a,table:n,showAssistantPreview:i,onSelectBackFromTemplates:()=>P(N),onToggleFeaturePreviewModal:z},"0")],onCancel:()=>{L?D(!0):l()},"data-sentry-element":"Modal","data-sentry-component":"PolicyEditorModal","data-sentry-source-file":"index.tsx",children:(0,s.jsxs)("div",{children:[(0,s.jsx)(j.A,{visible:O,title:"Discard changes",confirmLabel:"Discard",onCancel:()=>D(!1),onConfirm:()=>{l(),D(!1),I(!1)},"data-sentry-element":"ConfirmationModal","data-sentry-source-file":"index.tsx",children:(0,s.jsx)("p",{className:"text-sm text-foreground-light",children:"There are unsaved changes. Are you sure you want to close the editor? Your changes will be lost."})}),S===v.SELECTION?(0,s.jsx)(eg,{description:"Write rules with PostgreSQL's policies to fit your unique business needs.",onViewTemplates:U,onViewEditor:Z,showAssistantPreview:i,onToggleFeaturePreviewModal:z}):S===v.EDITOR?(0,s.jsx)(ec,{isNewPolicy:f,policyFormFields:A,onUpdatePolicyFormFields:e=>{I(!0),e.name&&e.name.length>63||T({...A,...e})},onViewTemplates:U,onReviewPolicy:()=>{let{name:e,definition:t,check:a,command:s}=A;return 0===e.length?p.oR.error("Please provide a name for your policy"):s?["SELECT","DELETE"].includes(s)&&!t?p.oR.error("Please provide a USING expression for your policy"):"INSERT"!==s||a?"UPDATE"!==s||t||a?void(_(w(A,r)),F()):p.oR.error("Please provide either a USING, or WITH CHECK expression, or both for your policy"):p.oR.error("Please provide a WITH CHECK expression for your policy"):p.oR.error("Please select an operation for your policy")}}):S===v.TEMPLATES?(0,s.jsx)(eN,{templates:(0,eE.S3)(a,n).filter(e=>!e.preview),templatesNote:"* References a specific column in the table",onUseTemplate:e=>{T({...A,name:e.name,definition:e.definition,check:e.check,command:e.command,roles:e.roles}),Z()}}):S===v.REVIEW?(0,s.jsx)(ed,{policy:R,onSelectBack:Z,onSelectSave:()=>{W(f?k(A):C(A,r)),I(!1)}}):null]})})};var ek=a(92882),eC=a(33647),eT=a(47319),eR=a(32144),e_=a(80251),eL=a(15629),eI=a(30784);async function eO(e){let{projectRef:t,connectionString:a,payload:s}=e,n=new Headers;a&&n.set("x-connection-encrypted",a);let{sql:r}=eT.A.policies.create(s),{result:i}=await (0,eL.E)({projectRef:t,connectionString:a,sql:r,queryKey:["policy","create"]});return i}let eD=function(){let{onSuccess:e,onError:t,...a}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},s=(0,eR.jE)();return(0,e_.n)(e=>eO(e),{async onSuccess(t,a,n){let{projectRef:r}=a;await s.invalidateQueries(eI.S.list(r)),await (null==e?void 0:e(t,a,n))},async onError(e,a,s){void 0===t?p.oR.error("Failed to create database policy: ".concat(e.message)):t(e,a,s)},...a})};var eM=a(17498),eZ=a(48700),eU=a(86349),eF=a(91194),ez=a(44326),eW=a(95300),eV=a(98357),eG=a(93796),eB=a(82228),eH=a(2119),eq=a(3434);let eY=e=>{let{table:t="",label:a="",bucket:n,policies:r=[],onSelectPolicyAdd:i=h(),onSelectPolicyEdit:l=h(),onSelectPolicyDelete:o=h()}=e;return(0,s.jsxs)(eB.Zp,{"data-sentry-element":"Card","data-sentry-component":"StoragePoliciesBucketRow","data-sentry-source-file":"StoragePoliciesBucketRow.tsx",children:[(0,s.jsxs)(eB.aR,{className:"flex flex-row w-full items-center justify-between gap-0 space-y-0","data-sentry-element":"CardHeader","data-sentry-source-file":"StoragePoliciesBucketRow.tsx",children:[(0,s.jsxs)("div",{className:"flex items-center gap-3",children:[(0,s.jsx)(eV.A,{className:"text-foreground-light",size:16,strokeWidth:1.5,"data-sentry-element":"Archive","data-sentry-source-file":"StoragePoliciesBucketRow.tsx"}),(0,s.jsx)(eB.ZB,{"data-sentry-element":"CardTitle","data-sentry-source-file":"StoragePoliciesBucketRow.tsx",children:a}),(null==n?void 0:n.public)&&(0,s.jsx)(eH.E,{variant:"warning",children:"Public"})]}),!!n&&(0,s.jsx)(M.$,{type:"outline",onClick:()=>i(n.name,t),children:"New policy"})]}),0===r.length?(0,s.jsx)(eB.Wu,{children:(0,s.jsx)("p",{className:"text-sm text-foreground-lighter",children:"No policies created yet"})}):(0,s.jsx)(eB.Wu,{className:"p-0",children:(0,s.jsxs)(eq.XI,{className:"table-fixed",children:[(0,s.jsx)(eq.A0,{children:(0,s.jsxs)(eq.Hj,{children:[(0,s.jsx)(eq.nd,{className:"w-[40%]",children:"Name"}),(0,s.jsx)(eq.nd,{className:"w-[20%]",children:"Command"}),(0,s.jsx)(eq.nd,{className:"w-[30%]",children:"Applied to"}),(0,s.jsx)(eq.nd,{className:"w-0 text-right",children:(0,s.jsx)("span",{className:"sr-only",children:"Actions"})})]})}),(0,s.jsx)(eq.BF,{children:r.map(e=>{var a;return(0,s.jsx)(eG.V,{policy:e,onSelectEditPolicy:e=>{var a;return l(e,null!=(a=null==n?void 0:n.name)?a:"",t)},onSelectDeletePolicy:o},null!=(a=e.id)?a:e.name)})})]})})]})};var eK=a(55240),e$=a.n(eK);let eQ=[{id:"policy-1",templateName:"Allow access to JPG images in a public folder to anonymous users",description:"This policy uses native postgres functions, functions from auth and storage schema",name:"Give anon users access to JPG images in folder",statement:"\nCREATE POLICY \"policy_name\"\nON storage.objects FOR {operation} {USING | WITH CHECK} (\n  -- restrict bucket\n  bucket_id = {bucket_name}\n  -- allow access to only jpg file\n  AND storage.\"extension\"(name) = 'jpg'\n  -- in the public folder\n  AND LOWER((storage.foldername(name))[1]) = 'public'\n  -- to anonymous users\n  AND auth.role() = 'anon'\n);\n    ".trim(),definition:"bucket_id = {bucket_id} AND storage.\"extension\"(name) = 'jpg' AND LOWER((storage.foldername(name))[1]) = 'public' AND auth.role() = 'anon'",allowedOperations:[]},{id:"policy-2",templateName:"Give users access to only their own top level folder named as uid",description:"For example a user with id d7bed83c-44a0-4a4f-925f-efc384ea1e50 will be able to access anything under the folder d7bed83c-44a0-4a4f-925f-efc384ea1e50/",name:"Give users access to own folder",statement:'\nCREATE POLICY "policy_name"\nON storage.objects FOR {operation} {USING | WITH CHECK} (\n    -- restrict bucket\n    bucket_id = {bucket_name}\n    and (select auth.uid()::text) = (storage.foldername(name))[1]\n);\n    '.trim(),definition:"bucket_id = {bucket_id} AND (select auth.uid()::text) = (storage.foldername(name))[1]",allowedOperations:[]},{id:"policy-3",templateName:"Give users access to a folder only to authenticated users",description:"This policy gives users access to a folder (e.g private) only if they are authenticated",name:"Give users authenticated access to folder",statement:"\nCREATE POLICY \"policy_name\"\nON storage.objects FOR {operation} {USING | WITH CHECK} (\n    -- restrict bucket\n    bucket_id = {bucket_name}\n    AND (storage.foldername(name))[1] = 'private'\n    AND (select auth.role()) = 'authenticated'\n);\n    ".trim(),definition:"bucket_id = {bucket_id} AND (storage.foldername(name))[1] = 'private' AND auth.role() = 'authenticated'",allowedOperations:[]},{id:"policy-4",templateName:"Give access to a nested folder called admin/assets only to a specific user",description:'This policy gives read access to all authenticated users for your project to the folder "public"',name:"Give access to a folder",statement:"\nCREATE POLICY \"policy_name\"\nON storage.objects FOR {operation} {USING | WITH CHECK} (\n	  -- restrict bucket\n    bucket_id = {bucket_name}\n    AND (storage.foldername(name))[1] = 'admin' AND (storage.foldername(name))[2] = 'assets'\n    AND (select auth.uid()::text) = 'd7bed83c-44a0-4a4f-925f-efc384ea1e50'\n);\n    ".trim(),definition:"bucket_id = {bucket_id} AND (storage.foldername(name))[1] = 'admin' AND (storage.foldername(name))[2] = 'assets' AND (select auth.uid()::text) = 'd7bed83c-44a0-4a4f-925f-efc384ea1e50'",allowedOperations:[]},{id:"policy-5",templateName:"Give access to a file to a user",description:"This policy gives access to a specific file to a specific user",name:"Give access to a file to user",statement:"\nCREATE POLICY \"policy_name\"\nON storage.objects FOR {operation} {USING | WITH CHECK} (\n	  -- restrict bucket\n    bucket_id = {bucket_name}\n    AND name = 'admin/assets/Costa Rican Frog.jpg'\n    AND (select auth.uid()::text) = 'd7bed83c-44a0-4a4f-925f-efc384ea1e50'\n);\n    ".trim(),definition:"bucket_id = {bucket_id} AND name = 'admin/assets/Costa Rican Frog.jpg' AND (select auth.uid()::text) = 'd7bed83c-44a0-4a4f-925f-efc384ea1e50'",allowedOperations:[]}];var eX=a(35768),eJ=a(52308);let e0=e=>{let{definition:t="",onUpdatePolicyDefinition:a=()=>{}}=e;return(0,s.jsxs)("div",{className:"flex flex-col md:flex-row gap-4 md:gap-12","data-sentry-component":"PolicyDefinition","data-sentry-source-file":"StoragePoliciesEditor.tsx",children:[(0,s.jsxs)("div",{className:"flex md:w-1/3 flex-col space-y-2",children:[(0,s.jsx)("label",{className:"text-base text-foreground-light",htmlFor:"policy-name",children:"Policy definition"}),(0,s.jsx)("p",{className:"text-sm text-foreground-lighter",children:"Provide a SQL conditional expression that returns a boolean."})]}),(0,s.jsx)("div",{className:"h-56 md:w-2/3",children:(0,s.jsx)(_.A,{defaultValue:t,onInputChange:a,"data-sentry-element":"SqlEditor","data-sentry-source-file":"StoragePoliciesEditor.tsx"})})]})},e1=e=>{let{allowedOperations:t=[],onToggleOperation:a=()=>{}}=e,n=(0,eW.wS)(t);return(0,s.jsxs)("div",{className:"flex flex-col md:flex-row justify-between gap-4 md:gap-12","data-sentry-component":"PolicyAllowedOperations","data-sentry-source-file":"StoragePoliciesEditor.tsx",children:[(0,s.jsxs)("div",{className:"flex md:w-1/3 flex-col space-y-2",children:[(0,s.jsx)("label",{className:"text-base text-foreground-light",htmlFor:"allowed-operation",children:"Allowed operation"}),(0,s.jsxs)("p",{className:"text-sm text-foreground-lighter",children:["Based on the operations you have selected, you can use the highlighted functions in the"," ",(0,s.jsx)("a",{href:"https://supabase.com/docs/reference/javascript/storage-from-list",target:"_blank",rel:"noreferrer",className:"underline",children:"client library"}),"."]})]}),(0,s.jsxs)("div",{className:"md:w-2/3",children:[(0,s.jsxs)("div",{className:"flex flex-wrap items-center gap-x-8 gap-y-4",children:[(0,s.jsx)(eX.A,{label:"SELECT",onChange:()=>a("SELECT"),checked:t.includes("SELECT"),"data-sentry-element":"Checkbox","data-sentry-source-file":"StoragePoliciesEditor.tsx"}),(0,s.jsx)(eX.A,{label:"INSERT",onChange:()=>a("INSERT"),checked:t.includes("INSERT"),"data-sentry-element":"Checkbox","data-sentry-source-file":"StoragePoliciesEditor.tsx"}),(0,s.jsx)(eX.A,{label:"UPDATE",onChange:()=>a("UPDATE"),checked:t.includes("UPDATE"),"data-sentry-element":"Checkbox","data-sentry-source-file":"StoragePoliciesEditor.tsx"}),(0,s.jsx)(eX.A,{label:"DELETE",onChange:()=>a("DELETE"),checked:t.includes("DELETE"),"data-sentry-element":"Checkbox","data-sentry-source-file":"StoragePoliciesEditor.tsx"})]}),(0,s.jsx)("div",{className:"flex w-5/6 flex-wrap",children:Object.keys(eJ.Uw).map(e=>(0,s.jsx)("div",{className:"mr-2 mt-2 font-mono",children:(0,s.jsx)(eH.E,{variant:n.includes(e)?"brand":"default",children:e})},e))})]})]})},e2=e=>{let{onViewTemplates:t=()=>{},onReviewPolicy:a=()=>{}}=e;return(0,s.jsxs)("div",{className:"flex w-full items-center justify-end gap-x-2 border-t px-6 py-3 border-default","data-sentry-component":"PolicyEditorFooter","data-sentry-source-file":"StoragePoliciesEditor.tsx",children:[(0,s.jsx)(M.$,{type:"default",onClick:t,"data-sentry-element":"Button","data-sentry-source-file":"StoragePoliciesEditor.tsx",children:"View templates"}),(0,s.jsx)(M.$,{type:"primary",onClick:a,"data-sentry-element":"Button","data-sentry-source-file":"StoragePoliciesEditor.tsx",children:"Review"})]})},e3=e=>{let{policyFormFields:t={},onViewTemplates:a=h(),onUpdatePolicyName:n=h(),onUpdatePolicyDefinition:r=h(),onToggleOperation:i=h(),onUpdatePolicyRoles:l=h(),onReviewPolicy:o=h()}=e,c=t.definition,d=t.roles;return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsxs)("div",{className:"space-y-4 py-4",children:[(0,s.jsx)(g.A.Content,{"data-sentry-element":"Modal.Content","data-sentry-source-file":"StoragePoliciesEditor.tsx",children:(0,s.jsx)(F,{name:t.name,limit:50,onUpdatePolicyName:n,"data-sentry-element":"PolicyName","data-sentry-source-file":"StoragePoliciesEditor.tsx"})}),(0,s.jsx)(g.A.Separator,{"data-sentry-element":"Modal.Separator","data-sentry-source-file":"StoragePoliciesEditor.tsx"}),(0,s.jsx)(g.A.Content,{"data-sentry-element":"Modal.Content","data-sentry-source-file":"StoragePoliciesEditor.tsx",children:(0,s.jsx)(e1,{allowedOperations:t.allowedOperations,onToggleOperation:i,"data-sentry-element":"PolicyAllowedOperations","data-sentry-source-file":"StoragePoliciesEditor.tsx"})}),(0,s.jsx)(g.A.Separator,{"data-sentry-element":"Modal.Separator","data-sentry-source-file":"StoragePoliciesEditor.tsx"}),(0,s.jsx)(g.A.Content,{"data-sentry-element":"Modal.Content","data-sentry-source-file":"StoragePoliciesEditor.tsx",children:(0,s.jsx)(eo,{selectedRoles:d,onUpdateSelectedRoles:l,"data-sentry-element":"PolicyRoles","data-sentry-source-file":"StoragePoliciesEditor.tsx"})}),(0,s.jsx)(g.A.Separator,{"data-sentry-element":"Modal.Separator","data-sentry-source-file":"StoragePoliciesEditor.tsx"}),(0,s.jsx)(g.A.Content,{"data-sentry-element":"Modal.Content","data-sentry-source-file":"StoragePoliciesEditor.tsx",children:(0,s.jsx)(e0,{definition:c,onUpdatePolicyDefinition:r,"data-sentry-element":"PolicyDefinition","data-sentry-source-file":"StoragePoliciesEditor.tsx"})})]}),(0,s.jsx)(e2,{onViewTemplates:a,onReviewPolicy:o,"data-sentry-element":"PolicyEditorFooter","data-sentry-source-file":"StoragePoliciesEditor.tsx"})]})},e5=()=>(0,s.jsx)("div",{className:"my-10 flex items-center justify-center space-x-2 opacity-50","data-sentry-component":"ReviewEmptyState","data-sentry-source-file":"StoragePoliciesReview.tsx",children:(0,s.jsx)("p",{children:"There are no changes made to this policy"})}),e4=e=>{let{policyStatements:t=[],onSelectBack:a=()=>{},onSelectSave:n=()=>{}}=e,[r,i]=(0,m.useState)(!1);return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsxs)(g.A.Content,{className:"space-y-6","data-sentry-element":"Modal.Content","data-sentry-source-file":"StoragePoliciesReview.tsx",children:[(0,s.jsx)("div",{className:"flex items-center justify-between space-y-8 space-x-4",children:(0,s.jsx)("div",{className:"flex flex-col",children:(0,s.jsxs)("p",{className:"text-sm text-foreground-light",children:["These are the SQL statements that will be used to create your policies. The suffix appended to the end of your policy name (",(0,s.jsx)("code",{children:"[hashString]_[number]"}),") just functions as a unique identifier for each of your policies."]})})}),(0,s.jsxs)("div",{className:"space-y-4 overflow-y-auto",style:{maxHeight:"25rem"},children:[0===t.length&&(0,s.jsx)(e5,{}),t.map((e,t)=>{let a=e.statement||"";return(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsx)("span",{children:e.description}),(0,s.jsx)("div",{className:"h-40",children:(0,s.jsx)(_.A,{readOnly:!0,defaultValue:a})})]},"policy_".concat(t))})]})]}),(0,s.jsx)(g.A.Separator,{"data-sentry-element":"Modal.Separator","data-sentry-source-file":"StoragePoliciesReview.tsx"}),(0,s.jsxs)(g.A.Content,{className:"flex w-full items-center justify-end gap-2","data-sentry-element":"Modal.Content","data-sentry-source-file":"StoragePoliciesReview.tsx",children:[(0,s.jsx)(M.$,{type:"default",onClick:a,"data-sentry-element":"Button","data-sentry-source-file":"StoragePoliciesReview.tsx",children:"Back to edit"}),t.length>0&&(0,s.jsx)(M.$,{type:"primary",onClick:()=>{i(!0),n()},loading:r,children:"Save policy"})]})]})},e8={name:"",roles:[],policyIds:[],definition:"",allowedOperations:[]},e6=e=>{let{visible:t=!1,bucketName:a="",onSelectCancel:n=()=>{},onCreatePolicies:r=()=>{},onSaveSuccess:i=()=>{}}=e,[l,o]=(0,m.useState)(""),[c,d]=(0,m.useState)(""),[u,x]=(0,m.useState)(e8),[f,y]=(0,m.useState)([]);(0,m.useEffect)(()=>{t&&(j(),x(e8))},[t]);let j=()=>d(v.SELECTION),b=e=>{"new"===e&&x({...u,definition:"bucket_id = '".concat(a,"'")}),d(v.EDITOR)},N=()=>{o(c),d(v.TEMPLATES)},E=()=>d(v.REVIEW),S=async e=>{-1!==(await r(e)).indexOf(!0)?b():i()};return(0,s.jsx)(g.A,{hideFooter:!0,className:"[&>div:first-child]:py-3",size:c===v.SELECTION?"medium":"xxlarge",visible:t,contentStyle:{padding:0},header:[(0,s.jsx)(e=>{let{view:t,bucketName:a,onSelectBackFromTemplates:n=h()}=e;return t===v.TEMPLATES?(0,s.jsx)("div",{children:(0,s.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,s.jsx)("span",{onClick:n,className:"cursor-pointer text-foreground-lighter transition-colors hover:text-foreground",children:(0,s.jsx)(eS.A,{strokeWidth:2,size:14})}),(0,s.jsx)("h4",{className:"textlg m-0",children:"Select a template to use for your new policy"})]})}):(0,s.jsxs)("div",{className:"w-full flex items-center justify-between gap-x-2 pr-6","data-sentry-component":"StoragePolicyEditorModalTitle","data-sentry-source-file":"StoragePoliciesEditPolicyModal.tsx",children:[(0,s.jsx)("h4",{className:"m-0 truncate",children:t===v.EDITOR||t===v.SELECTION?"Adding new policy to ".concat(a):t===v.REVIEW?"Reviewing policies to be created for ".concat(a):void 0}),(0,s.jsx)(ew.A,{href:"https://supabase.com/docs/learn/auth-deep-dive/auth-policies","data-sentry-element":"DocsButton","data-sentry-source-file":"StoragePoliciesEditPolicyModal.tsx"})]})},{view:c,bucketName:a,onSelectBackFromTemplates:()=>d(l)},"0")],onCancel:n,"data-sentry-element":"Modal","data-sentry-component":"StoragePoliciesEditPolicyModal","data-sentry-source-file":"StoragePoliciesEditPolicyModal.tsx",children:(0,s.jsx)("div",{className:"w-full",children:c===v.SELECTION?(0,s.jsx)(eg,{description:"PostgreSQL policies control access to your files and folders",onViewTemplates:N,onViewEditor:()=>b("new"),showAssistantPreview:!1}):c===v.EDITOR?(0,s.jsx)(e3,{policyFormFields:u,onViewTemplates:N,onUpdatePolicyName:e=>{e.length<=50&&x({...u,name:e})},onUpdatePolicyDefinition:e=>{x({...u,definition:e})},onToggleOperation:function(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(t)return x({...u,allowedOperations:[e]});let a=u.allowedOperations.includes(e)?e$()(u.allowedOperations.slice(),e):u.allowedOperations.concat([e]);return x({...u,allowedOperations:a})},onUpdatePolicyRoles:e=>{x({...u,roles:e})},onReviewPolicy:()=>{let{name:e,definition:t,allowedOperations:s}=u;return 0===e.length?p.oR.error("Please provide a name for your policy"):0===t.length?p.oR.error("Please provide a definition for your policy"):0===s.length?p.oR.error("Please allow at least one operation in your policy"):void(y((0,eW.Xn)(a,u)),E())}}):c===v.TEMPLATES?(0,s.jsx)(eN,{templates:eQ,onUseTemplate:e=>{let{id:t,...s}=e,n=(0,eW.EQ)(s.definition,a);x({...u,...s,definition:n}),b()},templatesNote:""}):c===v.REVIEW?(0,s.jsx)(e4,{policyStatements:f,onSelectBack:b,onSelectSave:()=>{S((0,eW.kg)(a,u))}}):(0,s.jsx)("div",{})})})},e7=()=>(0,s.jsx)(eB.Zp,{"data-sentry-element":"Card","data-sentry-component":"StoragePoliciesPlaceholder","data-sentry-source-file":"StoragePoliciesPlaceholder.tsx",children:(0,s.jsx)(eB.Wu,{"data-sentry-element":"CardContent","data-sentry-source-file":"StoragePoliciesPlaceholder.tsx",children:(0,s.jsx)("p",{className:"text-sm text-foreground-light",children:"Create a bucket first to start writing policies!"})})}),e9=()=>{let{data:e}=(0,B.YA)(),{ref:t}=(0,n.g)(),{data:a,isLoading:r}=(0,eU.p)({projectRef:t}),l=null!=a?a:[],[c,u]=(0,m.useState)({}),[f,h]=(0,m.useState)({}),[y,g]=(0,m.useState)({}),{data:j,refetch:v,isLoading:b}=(0,eC.j)({projectRef:null==e?void 0:e.ref,connectionString:null==e?void 0:e.connectionString,schema:"storage"}),N=null!=j?j:[],{mutateAsync:E}=eD({onError:()=>{}}),{mutateAsync:S}=(0,eZ.V)(),{mutate:w}=(0,eM.f)({onSuccess:async()=>{await v(),p.oR.success("Successfully deleted policy!"),h({})}}),P=x()(c)&&!x()(y)&&d()(y,["bucket"],"").length>0,A=!x()(y)&&!P,k=i()(N,{table:"objects"}),C=(0,eW._S)(l,k),T=d()(o()(C,{name:"Ungrouped"}),["policies"],[]),R=i()(N,{table:"buckets"}),_=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";u({}),g({bucket:e,table:t})},L=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"";g({bucket:t,table:a}),u(e)},I=()=>{g({})},O=e=>h(e),D=async()=>{p.oR.success("Successfully saved policy!"),await v(),I()},M=async t=>e?await Promise.all(t.map(async t=>{try{return await E({projectRef:null==e?void 0:e.ref,connectionString:null==e?void 0:e.connectionString,payload:t}),!1}catch(e){return p.oR.error("Error adding policy: ".concat(e.message)),!0}})):(console.error("Project is required"),!0),Z=async t=>{if(!e)return console.error("Project is required"),!0;try{return await E({projectRef:null==e?void 0:e.ref,connectionString:null==e?void 0:e.connectionString,payload:t}),!1}catch(e){return p.oR.error("Error adding policy: ".concat(e.message)),!0}},U=async t=>{if(!e)return console.error("Project is required"),!0;try{return await S({projectRef:null==e?void 0:e.ref,connectionString:null==e?void 0:e.connectionString,originalPolicy:c,payload:t}),!1}catch(e){return p.oR.error("Error updating policy: ".concat(e.message)),!0}},F=async()=>{if(!e)return console.error("Project is required");w({projectRef:null==e?void 0:e.ref,connectionString:null==e?void 0:e.connectionString,originalPolicy:f})};return(0,s.jsxs)("div",{className:"flex min-h-full w-full flex-col","data-sentry-component":"StoragePolicies","data-sentry-source-file":"StoragePolicies.tsx",children:[r||b?(0,s.jsx)("div",{className:"flex h-full items-center justify-center",children:(0,s.jsx)(eF.A,{className:"animate-spin",size:16})}):(0,s.jsxs)("div",{children:[(0,s.jsxs)(ek.gu,{isFullWidth:!0,children:[(0,s.jsx)(ek.sZ,{children:"Buckets"}),(0,s.jsx)(ek.aw,{className:"mb-6",children:"Write policies for each bucket to control access to the bucket and its contents"}),0===l.length&&(0,s.jsx)(e7,{}),(0,s.jsx)("div",{className:"flex flex-col gap-y-4",children:l.map(e=>{let t=d()(o()(C,{name:e.name}),["policies"],[]).sort((e,t)=>e.name.localeCompare(t.name));return(0,s.jsx)(eY,{table:"objects",label:e.name,bucket:e,policies:t,onSelectPolicyAdd:_,onSelectPolicyEdit:L,onSelectPolicyDelete:O},e.name)})})]}),(0,s.jsxs)(ek.gu,{isFullWidth:!0,children:[(0,s.jsx)(ek.sZ,{children:"Schema"}),(0,s.jsx)(ek.aw,{className:"mb-6",children:"Write policies for the tables under the storage schema directly for greater control"}),(0,s.jsxs)("div",{className:"flex flex-col gap-y-4",children:[(0,s.jsx)(eY,{table:"objects",label:"Other policies under storage.objects",policies:T,onSelectPolicyAdd:_,onSelectPolicyEdit:L,onSelectPolicyDelete:O}),(0,s.jsx)(eY,{table:"buckets",label:"Policies under storage.buckets",policies:R,onSelectPolicyAdd:_,onSelectPolicyEdit:L,onSelectPolicyDelete:O})]})]})]}),(0,s.jsx)(e6,{visible:P,bucketName:y.bucket,onSelectCancel:I,onCreatePolicies:M,onSaveSuccess:D,"data-sentry-element":"StoragePoliciesEditPolicyModal","data-sentry-source-file":"StoragePolicies.tsx"}),(0,s.jsx)(eA,{schema:"storage",visible:A,table:y.table,selectedPolicyToEdit:c,onSelectCancel:I,onCreatePolicy:Z,onUpdatePolicy:U,onSaveSuccess:D,"data-sentry-element":"PolicyEditorModal","data-sentry-source-file":"StoragePolicies.tsx"}),(0,s.jsx)(ez.A,{danger:!0,visible:!x()(f),title:"Confirm to delete policy",description:'This is permanent! Are you sure you want to delete the policy "'.concat(f.name,'"'),buttonLabel:"Delete",buttonLoadingLabel:"Deleting",onSelectCancel:()=>h({}),onSelectConfirm:F,"data-sentry-element":"ConfirmModal","data-sentry-source-file":"StoragePolicies.tsx"})]})};var te=a(96232),tt=a(12101),ta=a(4958);let ts=()=>(0,s.jsx)(e9,{"data-sentry-element":"StoragePolicies","data-sentry-component":"StoragePoliciesPage","data-sentry-source-file":"policies.tsx"});ts.getLayout=e=>(0,s.jsx)(te.A,{children:(0,s.jsx)(ta.A,{title:"Policies",children:(0,s.jsx)(tt.M,{title:"Storage policies",subtitle:"Safeguard your files with policies that define the operations allowed for your users at the bucket level.",children:(0,s.jsx)(ek.eh,{children:e})})})});let tn=ts},35375:(e,t,a)=>{(window.__NEXT_P=window.__NEXT_P||[]).push(["/project/[ref]/storage/policies",function(){return a(34556)}])},35768:(e,t,a)=>{"use strict";a.d(t,{A:()=>d});var s=a(80263),n=a(53239),r=a(1848),i=a(70800),l=a(60115);let o=(0,n.createContext)({parentCallback:e=>{},parentSize:""});function c(e){let{className:t,id:a="",name:n="",label:r,afterLabel:c,beforeLabel:d,description:u,checked:x,value:m,onChange:p,onBlur:f,size:h="medium",disabled:y=!1,...g}=e,{formContextOnChange:j,values:v,handleBlur:b}=(0,l.x)(),N=(0,i.A)("checkbox");return(0,s.jsx)(o.Consumer,{"data-sentry-element":"CheckboxContext.Consumer","data-sentry-component":"Checkbox","data-sentry-source-file":"Checkbox.tsx",children:e=>{let{parentCallback:i,parentSize:l}=e,o=a||n||(r?r.toLowerCase().replace(/^[^A-Z0-9]+/gi,"").replace(/ /g,"-"):void 0);h=l||h;let E=n||o,S=null!=x?x:void 0,w=[N.container];return t&&w.push(t),v&&void 0===x&&(S=v[a||n]),(0,s.jsxs)("div",{className:w.join(" "),children:[(0,s.jsx)("input",{id:o,name:E,type:"checkbox",className:[N.base,N.size[h]].join(" "),onChange:function(e){i&&i(e),p&&p(e),j&&j(e)},onBlur:function(e){b&&setTimeout(()=>{b(e)},100),f&&f(e)},checked:S,value:m||o,disabled:y,...g}),(0,s.jsxs)("label",{className:[N.label.base,N.label[h]].join(" "),htmlFor:o,children:[(0,s.jsxs)("span",{children:[d&&(0,s.jsx)("span",{className:[N.label_before.base,N.label_before[h]].join(" "),children:d}),r,c&&(0,s.jsx)("span",{className:[N.label_after.base,N.label_after[h]].join(" "),children:c})]}),u&&(0,s.jsx)("p",{className:[N.description.base,N.description[h]].join(" "),children:u})]})]})}})}c.Group=function(e){let{id:t,layout:a="vertical",error:n,descriptionText:l,label:d,afterLabel:u,beforeLabel:x,labelOptional:m,children:p,className:f,options:h,onChange:y,size:g="medium"}=e,j=(0,i.A)("checkbox");return(0,s.jsx)(r.H,{label:d,afterLabel:u,beforeLabel:x,labelOptional:m,layout:a,id:t,error:n,descriptionText:l,className:f,size:g,"data-sentry-element":"FormLayout","data-sentry-component":"Group","data-sentry-source-file":"Checkbox.tsx",children:(0,s.jsx)(o.Provider,{value:{parentCallback:e=>{y&&y(e)},parentSize:g},"data-sentry-element":"CheckboxContext.Provider","data-sentry-source-file":"Checkbox.tsx",children:(0,s.jsx)("div",{className:j.group,children:h?h.map(e=>(0,s.jsx)(c,{id:e.id,value:e.value,label:e.label,beforeLabel:e.beforeLabel,afterLabel:e.afterLabel,checked:e.checked,name:e.name,description:e.description,defaultChecked:e.defaultChecked},e.id)):p})})})};let d=c},36975:(e,t,a)=>{"use strict";a.d(t,{A:()=>s});let s=(0,a(15740).A)("Vault",[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",key:"afitv7"}],["circle",{cx:"7.5",cy:"7.5",r:".5",fill:"currentColor",key:"kqv944"}],["path",{d:"m7.9 7.9 2.7 2.7",key:"hpeyl3"}],["circle",{cx:"16.5",cy:"7.5",r:".5",fill:"currentColor",key:"w0ekpg"}],["path",{d:"m13.4 10.6 2.7-2.7",key:"264c1n"}],["circle",{cx:"7.5",cy:"16.5",r:".5",fill:"currentColor",key:"nkw3mc"}],["path",{d:"m7.9 16.1 2.7-2.7",key:"p81g5e"}],["circle",{cx:"16.5",cy:"16.5",r:".5",fill:"currentColor",key:"fubopw"}],["path",{d:"m13.4 13.4 2.7 2.7",key:"abhel3"}],["circle",{cx:"12",cy:"12",r:"2",key:"1c9p78"}]])},37253:(e,t,a)=>{var s=a(48550),n=a(92479),r=a(50084);e.exports=n(function(e,t){return r(e)?s(e,t):[]})},42092:(e,t,a)=>{var s=a(48550),n=a(40293),r=a(92479),i=a(50084);e.exports=r(function(e,t){return i(e)?s(e,n(t,1,i,!0)):[]})},43171:e=>{e.exports=function(e,t,a,s){var n=-1,r=null==e?0:e.length;for(s&&r&&(a=e[++n]);++n<r;)a=t(a,e[n],n,e);return a}},48550:(e,t,a)=>{var s=a(45558),n=a(10116),r=a(59568),i=a(71057),l=a(10876),o=a(99582);e.exports=function(e,t,a,c){var d=-1,u=n,x=!0,m=e.length,p=[],f=t.length;if(!m)return p;a&&(t=i(t,l(a))),c?(u=r,x=!1):t.length>=200&&(u=o,x=!1,t=new s(t));e:for(;++d<m;){var h=e[d],y=null==a?h:a(h);if(h=c||0!==h?h:0,x&&y==y){for(var g=f;g--;)if(t[g]===y)continue e;p.push(h)}else u(t,y,c)||p.push(h)}return p}},48817:(e,t,a)=>{var s=a(71057),n=a(35902),r=a(49830),i=a(10876),l=a(2482),o=Array.prototype.splice;e.exports=function(e,t,a,c){var d=c?r:n,u=-1,x=t.length,m=e;for(e===t&&(t=l(t)),a&&(m=s(e,i(a)));++u<x;)for(var p=0,f=t[u],h=a?a(f):f;(p=d(m,h,p,c))>-1;)m!==e&&o.call(m,p,1),o.call(e,p,1);return e}},49830:e=>{e.exports=function(e,t,a,s){for(var n=a-1,r=e.length;++n<r;)if(s(e[n],t))return n;return -1}},52793:(e,t,a)=>{e.exports=a(55950)(function(e,t,a){return e+(a?"_":"")+t.toLowerCase()})},53689:(e,t,a)=>{var s=a(57658),n=a(15743),r=/[\xc0-\xd6\xd8-\xf6\xf8-\xff\u0100-\u017f]/g,i=RegExp("[\\u0300-\\u036f\\ufe20-\\ufe2f\\u20d0-\\u20ff]","g");e.exports=function(e){return(e=n(e))&&e.replace(r,s).replace(i,"")}},55240:(e,t,a)=>{e.exports=a(92479)(a(32351))},55950:(e,t,a)=>{var s=a(43171),n=a(53689),r=a(76316),i=RegExp("['’]","g");e.exports=function(e){return function(t){return s(r(n(t).replace(i,"")),e,"")}}},56189:e=>{e.exports=function(e){return function(t){return null==e?void 0:e[t]}}},57624:(e,t,a)=>{"use strict";a.d(t,{A:()=>s});let s=(0,a(15740).A)("Columns3",[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",key:"afitv7"}],["path",{d:"M9 3v18",key:"fh3hqa"}],["path",{d:"M15 3v18",key:"14nvp0"}]])},57658:(e,t,a)=>{e.exports=a(56189)({À:"A",Á:"A",Â:"A",Ã:"A",Ä:"A",Å:"A",à:"a",á:"a",â:"a",ã:"a",ä:"a",å:"a",Ç:"C",ç:"c",Ð:"D",ð:"d",È:"E",É:"E",Ê:"E",Ë:"E",è:"e",é:"e",ê:"e",ë:"e",Ì:"I",Í:"I",Î:"I",Ï:"I",ì:"i",í:"i",î:"i",ï:"i",Ñ:"N",ñ:"n",Ò:"O",Ó:"O",Ô:"O",Õ:"O",Ö:"O",Ø:"O",ò:"o",ó:"o",ô:"o",õ:"o",ö:"o",ø:"o",Ù:"U",Ú:"U",Û:"U",Ü:"U",ù:"u",ú:"u",û:"u",ü:"u",Ý:"Y",ý:"y",ÿ:"y",Æ:"Ae",æ:"ae",Þ:"Th",þ:"th",ß:"ss",Ā:"A",Ă:"A",Ą:"A",ā:"a",ă:"a",ą:"a",Ć:"C",Ĉ:"C",Ċ:"C",Č:"C",ć:"c",ĉ:"c",ċ:"c",č:"c",Ď:"D",Đ:"D",ď:"d",đ:"d",Ē:"E",Ĕ:"E",Ė:"E",Ę:"E",Ě:"E",ē:"e",ĕ:"e",ė:"e",ę:"e",ě:"e",Ĝ:"G",Ğ:"G",Ġ:"G",Ģ:"G",ĝ:"g",ğ:"g",ġ:"g",ģ:"g",Ĥ:"H",Ħ:"H",ĥ:"h",ħ:"h",Ĩ:"I",Ī:"I",Ĭ:"I",Į:"I",İ:"I",ĩ:"i",ī:"i",ĭ:"i",į:"i",ı:"i",Ĵ:"J",ĵ:"j",Ķ:"K",ķ:"k",ĸ:"k",Ĺ:"L",Ļ:"L",Ľ:"L",Ŀ:"L",Ł:"L",ĺ:"l",ļ:"l",ľ:"l",ŀ:"l",ł:"l",Ń:"N",Ņ:"N",Ň:"N",Ŋ:"N",ń:"n",ņ:"n",ň:"n",ŋ:"n",Ō:"O",Ŏ:"O",Ő:"O",ō:"o",ŏ:"o",ő:"o",Ŕ:"R",Ŗ:"R",Ř:"R",ŕ:"r",ŗ:"r",ř:"r",Ś:"S",Ŝ:"S",Ş:"S",Š:"S",ś:"s",ŝ:"s",ş:"s",š:"s",Ţ:"T",Ť:"T",Ŧ:"T",ţ:"t",ť:"t",ŧ:"t",Ũ:"U",Ū:"U",Ŭ:"U",Ů:"U",Ű:"U",Ų:"U",ũ:"u",ū:"u",ŭ:"u",ů:"u",ű:"u",ų:"u",Ŵ:"W",ŵ:"w",Ŷ:"Y",ŷ:"y",Ÿ:"Y",Ź:"Z",Ż:"Z",Ž:"Z",ź:"z",ż:"z",ž:"z",Ĳ:"IJ",ĳ:"ij",Œ:"Oe",œ:"oe",ŉ:"'n",ſ:"s"})},58174:(e,t,a)=>{"use strict";a.d(t,{Fg:()=>s,QY:()=>n,mV:()=>r});let s=["anon","service_role","authenticated","authenticator","dashboard_user","supabase_admin","supabase_auth_admin","supabase_functions_admin","supabase_read_only_user","supabase_realtime_admin","supabase_replication_admin","supabase_storage_admin","pgbouncer","pgsodium_keyholder","pgsodium_keyiduser","pgsodium_keymaker","pgtle_admin"],n=["postgres","pgbouncer","supabase_admin","supabase_auth_admin","supabase_storage_admin","dashboard_user","authenticator","pg_database_owner","pg_read_all_data","pg_write_all_data"],r={canLogin:{disabled:!1,description:"User can login",grant_by_dashboard:!0},canCreateRole:{disabled:!1,description:"User can create roles",grant_by_dashboard:!0},canCreateDb:{disabled:!1,description:"User can create databases",grant_by_dashboard:!0},canBypassRls:{disabled:!1,description:"User bypasses every row level security policy",grant_by_dashboard:!0},isSuperuser:{disabled:!0,description:"User is a Superuser",grant_by_dashboard:!1},isReplicationRole:{disabled:!1,description:"User can initiate streaming replication and put the system in and out of backup mode",grant_by_dashboard:!0}}},59024:(e,t,a)=>{"use strict";a.d(t,{A:()=>c});var s=a(80263),n=a(14360),r=a(83927),i=a.n(r),l=a(53239),o=a(34487);let c=e=>{let{queryId:t,language:a="pgsql",defaultValue:r="",readOnly:c=!1,contextmenu:d=!0,onInputChange:u=i()}=e,x=(0,n.useMonaco)(),m=(0,l.useRef)();return(0,l.useEffect)(()=>{if(x){let e=x.languages.registerDocumentFormattingEditProvider("pgsql",{async provideDocumentFormattingEdits(e){let t=e.getValue(),a=(0,o.A)(t);return[{range:e.getFullModelRange(),text:a}]}});return()=>{e.dispose()}}},[x]),(0,l.useEffect)(()=>{if(m.current){var e;null==(e=m.current)||e.changeViewZones(e=>{e.addZone({afterLineNumber:0,heightInPx:4,domNode:document.createElement("div")})})}},[t]),(0,s.jsx)(n.default,{className:"monaco-editor",theme:"supabase",defaultLanguage:a,defaultValue:r,path:t,loading:(0,s.jsx)(()=>(0,s.jsx)("h4",{className:"text-lg","data-sentry-component":"Loading","data-sentry-source-file":"SqlEditor.tsx",children:"Loading"}),{}),options:{readOnly:c,tabSize:2,fontSize:13,minimap:{enabled:!1},wordWrap:"on",fixedOverflowWidgets:!0,contextmenu:d},onMount:(e,t)=>{m.current=e,e.changeViewZones(e=>{e.addZone({afterLineNumber:0,heightInPx:4,domNode:document.createElement("div")})})},onChange:u,"data-sentry-element":"Editor","data-sentry-component":"SqlEditor","data-sentry-source-file":"SqlEditor.tsx"})}},59350:(e,t,a)=>{"use strict";a.d(t,{A:()=>s});let s=(0,a(15740).A)("Webhook",[["path",{d:"M18 16.98h-5.99c-1.1 0-1.95.94-2.48 1.9A4 4 0 0 1 2 17c.01-.7.2-1.4.57-2",key:"q3hayz"}],["path",{d:"m6 17 3.13-5.78c.53-.97.1-2.18-.5-3.1a4 4 0 1 1 6.89-4.06",key:"1go1hn"}],["path",{d:"m12 6 3.13 5.73C15.66 12.7 16.9 13 18 13a4 4 0 0 1 0 8",key:"qlwsc0"}]])},59863:(e,t,a)=>{var s=a(20564);e.exports=function(e,t){var a=[];return s(e,function(e,s,n){t(e,s,n)&&a.push(e)}),a}},74680:(e,t,a)=>{"use strict";a.d(t,{A:()=>s});let s=(0,a(15740).A)("CircleX",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m15 9-6 6",key:"1uzhvr"}],["path",{d:"m9 9 6 6",key:"z0biqf"}]])},76316:(e,t,a)=>{var s=a(15196),n=a(99851),r=a(15743),i=a(4576);e.exports=function(e,t,a){return(e=r(e),void 0===(t=a?void 0:t))?n(e)?i(e):s(e):e.match(t)||[]}},79467:(e,t,a)=>{"use strict";a.d(t,{A:()=>d});var s=a(80263),n=a(53239),r=a(1848),i=a(70800),l=a(60115);let o=(0,n.createContext)({parentCallback:e=>{},type:"",name:"",activeId:"",parentSize:""});function c(e){var t;let{id:a=(t=46656*Math.random()|0,("00000"+(46656*Math.random()|0).toString(36)).slice(-3)+("00000"+t.toString(36)).slice(-3)),disabled:n,value:r,label:c,afterLabel:d,beforeLabel:u,description:x,name:m,checked:p,className:f,onChange:h,onBlur:y,hidden:g=!1,size:j="medium",align:v="vertical",optionalLabel:b,addOnBefore:N,children:E}=e,S=(0,i.A)("radio"),{handleBlur:w}=(0,l.x)();function P(e){w&&w(e),y&&y(e)}return(0,s.jsx)(o.Consumer,{"data-sentry-element":"RadioContext.Consumer","data-sentry-component":"Radio","data-sentry-source-file":"Radio.tsx",children:e=>{let{parentCallback:t,type:i,name:l,activeId:o,parentSize:y}=e;j=y||j;let w=o===a||!!p||!1!==p&&void 0,A=[f,S.variants[i].container.base,"list"===i&&!g&&S.variants[i].container.size[j]];return A.push(S.variants[i].base),A.push(S.variants[i].size[j]),w?A.push(S.variants[i].active):A.push(S.variants[i].inactive),n&&A.push(S.disabled),"list"!==i&&(g=!0),(0,s.jsxs)("label",{htmlFor:a,className:A.join(" "),children:[(0,s.jsx)("input",{id:a,name:l||m,type:"radio",className:[S.base,S.size[j],g&&S.hidden,S.variants[i].radio_offset,""].join(" "),checked:w,disabled:n,value:r||a,onChange:e=>{t&&t(e),h&&h(e)},onBlur:P}),N,E||(0,s.jsxs)(s.Fragment,{children:[(0,s.jsxs)("div",{className:[S.label.base,S.label[j],S.variants[i].container.align[v]].join(" "),children:[u&&(0,s.jsx)("div",{className:[S.label_before.base,S.label_before[j]].join(" "),children:u}),(0,s.jsx)("div",{children:c}),d&&(0,s.jsx)("div",{className:[S.label_after.base,S.label_after[j]].join(" "),children:d}),x&&(0,s.jsx)("div",{className:[S.description.base,S.description[j]].join(" "),children:x})]}),b&&(0,s.jsx)("div",{className:[S.optionalLabel.base,S.optionalLabel[j]].join(" "),children:b})]})]})}})}c.Group=function(e){let{id:t,layout:a,error:d,descriptionText:u,label:x,afterLabel:m,beforeLabel:p,labelOptional:f,children:h,className:y,type:g="list",options:j,value:v,name:b,onChange:N,size:E="medium",validation:S,groupClassName:w,labelsLayout:P="vertical"}=e,[A,k]=(0,n.useState)(""),C=(0,i.A)("radio"),{formContextOnChange:T,values:R,errors:_,touched:L,fieldLevelValidation:I}=(0,l.x)();return R&&!v&&(v=R[t||b]),d||(_&&!d&&(d=_[t||b]),d=L&&L[t||b]?d:void 0),(0,n.useEffect)(()=>{S&&I(t,S(v))},[]),(0,n.useEffect)(()=>{k(v)},[v]),(0,s.jsx)("fieldset",{name:b,className:y,"data-sentry-component":"RadioGroup","data-sentry-source-file":"Radio.tsx",children:(0,s.jsx)(r.H,{nonBoxInput:!0,label:x,afterLabel:m,beforeLabel:p,labelOptional:f,layout:a,id:t,error:d,descriptionText:u,size:E,labelLayout:P,"data-sentry-element":"FormLayout","data-sentry-source-file":"Radio.tsx",children:(0,s.jsx)("div",{className:w||C.variants[g].group,children:(0,s.jsx)(o.Provider,{value:{parentCallback:function(e){N&&N(e),T&&T(e),S&&I(t,S(e.target.value)),k(e.target.id)},type:g,name:b,activeId:A,parentSize:E},"data-sentry-element":"RadioContext.Provider","data-sentry-source-file":"Radio.tsx",children:j?j.map(e=>(0,s.jsx)(c,{id:e.id,label:e.label,beforeLabel:e.beforeLabel,afterLabel:e.afterLabel,value:e.value,description:e.description})):h})})})})};let d=c},81097:(e,t,a)=>{var s=a(82875),n=a(59863),r=a(85892),i=a(33312);e.exports=function(e,t){return(i(e)?s:n)(e,r(t,3))}},85563:(e,t,a)=>{"use strict";a.d(t,{A:()=>s});let s=(0,a(15740).A)("Clock5",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["polyline",{points:"12 6 12 12 14.5 16",key:"1pcbox"}]])},89080:(e,t,a)=>{"use strict";a.d(t,{A:()=>s});let s=(0,a(15740).A)("Pen",[["path",{d:"M21.174 6.812a1 1 0 0 0-3.986-3.987L3.842 16.174a2 2 0 0 0-.5.83l-1.321 4.352a.5.5 0 0 0 .623.622l4.353-1.32a2 2 0 0 0 .83-.497z",key:"1a8usu"}]])},97344:(e,t,a)=>{var s=a(58381),n=a(51276),r=a(5689),i=a(33312),l=a(89527),o=a(79661),c=a(86458),d=a(63570),u=Object.prototype.hasOwnProperty;e.exports=function(e){if(null==e)return!0;if(l(e)&&(i(e)||"string"==typeof e||"function"==typeof e.splice||o(e)||d(e)||r(e)))return!e.length;var t=n(e);if("[object Map]"==t||"[object Set]"==t)return!e.size;if(c(e))return!s(e).length;for(var a in e)if(u.call(e,a))return!1;return!0}},99851:e=>{var t=/[a-z][A-Z]|[A-Z]{2}[a-z]|[0-9][a-zA-Z]|[a-zA-Z][0-9]|[^a-zA-Z0-9 ]/;e.exports=function(e){return t.test(e)}}},e=>{var t=t=>e(e.s=t);e.O(0,[6593,89,2313,9441,7494,4280,7598,4915,4560,6797,4674,2360,6110,6712,7795,4968,876,5089,9239,1895,3709,5573,9897,6585,279,7686,8343,2690,6232,597,8119,1533,8742,4958,5133,636,8792],()=>t(35375)),_N_E=e.O()}]);